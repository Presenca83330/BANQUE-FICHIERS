# PLAN DE CODAGE — PHASE 1
---
---
# DIRECTIVE NI. Connaissances Impératives à lire, analyser et appliquer
> Cette directive est non négociable et ces connaissances doivent lues, analysées avant tout codage et appliquées pendant le codage

---
## 1. Connaissances_Impératives_Application_LocalStorage
- src
- src/0.structure-type-page
- src/1.etapes-generation-annonces
- src/1.etapes-restitution-utilisateur
- src/4.home-page-leadgenai
- src/components
- src/services/openai
- src/services/openai/1.GenerateurAnnoncesOutilsSeo
- src/services/openai/1.GenerateurAnnoncesOutilsSeo/7.PromptsOpenAi
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--2.Nomenclature.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--0.StrategiePhase1.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--0.BibleRéférences.md
- public/1. Documents Stratégiques/01. Présentation LeadGenAi.md
- public/1. Documents Stratégiques/02. Présentation Structure LeadGenAi.md
- public/1. Documents Stratégiques/03. Logique Organisations.md
- public/1. Documents Stratégiques/04. Relations Business entre Tables.md
- public/1. Documents Stratégiques/05. Relations Users Utilisateurs.md
- public/1. Documents Stratégiques/06. Référence des Hooks Stratégiques.md
- public/1. Documents Stratégiques/07.1. Stratégie - Gestion des informations partagées entre Réseau et Réseau Direction.md
- public/1. Documents Stratégiques/08. Gestion du Menu Gauche.md
- public/1. Documents Stratégiques/09. Structure - Organisation | Client_id.md
- public/1. Documents Stratégiques/10. Structure des Tables de Connexion & Règles Collaborateurs.md
- src/components/HOOKS-STRATEGIQUE/1.HOOK-useAuth
- src/components/HOOKS-STRATEGIQUE/2.HOOK-useCurrentUser
- src/components/HOOKS-STRATEGIQUE/3.HOOK-useMultiTenant
- src/components/HOOKS-STRATEGIQUE/4.HOOK-useSupabaseOperations
- src/integrations/supabase/client.ts
- src/integrations/supabase/helpers.ts
- src/integrations/supabase/performance.ts
- src/integrations/supabase/queries.ts
- src/integrations/supabase/resilience.ts
- src/integrations/supabase/types.ts
- -> Intégralité des tables actives dans supabase
- public/2. Etats des Tables /1.Tables.Stratégiques
- public/2. Etats des Tables /2.Tables.Clients
- public/2. Etats des Tables /3.Tables.Connexion
- public/2. Etats des Tables /4.Tables.Historique 
- public/3. ReadMe FormPresenca/01.FormReseau/1.FormCreateur
- public/3. ReadMe FormPresenca/01.FormReseau/2.FormGestion
- src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau
- src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/6.AgenceIndependante
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--0.DocsPréparatoireCodagePhase1.md
---
## 2. Audits
- Analyse étapes 1 à 5
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/01.Etape1.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/02.Etape2.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/03.Etape3.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/04.Etape4.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/05.Etape5.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/06.Etape5animation.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/07.BilanEtape1aEtape5.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/08.ProcessEnvoiInfosOpenAI.md
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/09.ProcessPassageEtapeSuivante.md
- Analyse retour openai
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/00.ProcessRecuperationOpenAI.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/02.SiteInternetOutilsSeo.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/03.PortailsImmobiliers.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/04.CréerEmailingCampagneNewsletter.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/05.EnvoyerCampagneSMS.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/06.CréerLandingPage.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/07.DiffuserGoogleMB.md
- public/4. ReadMe EtapesAnnonces/02.Etape6Communication/08.DiffuserReseaux.md. 
---
## 3. Stratégie
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--0.StrategiePhase1.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--2.Nomenclature.md
---
## 4. Table_Préparatoire
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--0.Table_etapes1to5.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--1.GestionStrategieMultiTenant.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--2.FonctionTimer.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--3.ExplicationdesChamps.md
---
## 5. Bibles_de_Référence
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--0.BibleRéférences.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--1.MenuGaucheNavLinks.md
---
## 6. Détails_Stratégie
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--0.DétailStratégiePhase1.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--1.TableauRecapElementsACréer.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--0.Section4-Directives.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--1.Section4-TableOpenAiKeys.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--2.Section4-TableOpenAILogs.md
---
## 7. Dossier -> Sections_Préparatoires_Codage
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--0.DocsPréparatoireCodagePhase1.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--1.DocSection1Validée.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--2.DocSection2Validée.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--3.DocSection3Validée.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--4.DocSection4Validée.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--5.DocSection5Validée.md
---
# DIRECTIVE N2 IMPERATIVE ET NON NEGOCIABLE

- Il est strictement interdit d'apporter des modifications, correctifs, changements aux process qui fonctionnent actuellement dans tous les process des étapes 1 à 5 qui fonctionnent parfaitement
- La mission consiste exclusivement à adapter les codes, fonctions actuels en localstorge pour une migration parfaite en Supabase
- Toute modifications des noms de champs, des fonctions, des graphismes est absolument interdite.
- Il est impératif d'appliquer les directives préparatoires prévues dans
1. Connaissances_Impératives_Application_LocalStorage
2. Audits
3. Stratégie
4. Table_Préparatoire
5. Bibles_de_Référence
6. Détails_Stratégie
7. Dossier -> Sections_Préparatoires_Codage

## DIRECTIVE N3 : PLAN GLOBAL DE CODAGE — PHASE 1

Le plan de codage doit être effectué dans le respect absolu des process qui fonctionnent actuellement dans l'application et en Localstorage.

Le plan de codage doit etre effectué dans le respect des directives préparatoires 
1. Connaissances_Impératives_Application_LocalStorage

### I. Fondations
Objectif : 
Garantir que tout le socle (nomenclature, RLS, tables, conventions, multi-tenant) est actif avant de coder les modules.

### II. Structure Supabase (Sections 1 & 2)
Objectif : coder ou importer toutes les fonctions SQL, triggers, policies et helpers.

### III. Hooks & Logique React (Section 3)
Objectif : construire la couche logique reliant les formulaires d’étapes 1→5 à Supabase.

### IV. Services OpenAI (Section 4)
Objectif : intégrer la couche d’IA en suivant la logique des prompts existants.

### V. UI & Migration (Section 5)
Objectif : relier les hooks et services à l’interface, gérer la transition localStorage → Supabase.

### VI. Validation Globale & Tests
Objectif : tester l’ensemble du flux de bout en bout, valider la cohérence multi-tenant et la conformité des noms.

---

## DIRECTIVE N3. PLAN DE CODAGE — PHASE 1

### A. Organisation du travail

- Codage section par section en appliquant à la lettre les dossiers préparatoires au codage
1. Connaissances_Impératives_Application_LocalStorage


### B. Structure des dossiers à coder

Les fichiers listés pour chaque section (Supabase, Utilitaires, Hooks, Services OpenAI, UI & Migration).
Appliquer impérativement les directives s'y référant dans les dossiers préparatoires
1. Connaissances_Impératives_Application_LocalStorage
2. Audits
3. Stratégie
4. Table_Préparatoire
5. Bibles_de_Référence
6. Détails_Stratégie
7. Dossier -> Sections_Préparatoires_Codage

---

DIRECTIVE N4. Tableau de suivi intégral (statut initial : “À coder”, auteur : Nous-mêmes -> To Do)

| Section | Chemin complet | Type | Statut | Auteur |
|---|---|---|---|---|
| 1 | supabase/functions/annonce-phase1-get-project-data/index.ts | Edge Function | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-get-project-data/types.ts | Module partagé | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-get-active-key/index.ts | Edge Function | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-get-active-key/types.ts | Module partagé | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-update-token-counters/index.ts | Edge Function | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-update-token-counters/types.ts | Module partagé | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-shared/helpers.ts | Module partagé | À coder | To Do |
| 1 | supabase/functions/annonce-phase1-shared/constants.ts | Module partagé | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape1.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape2.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape3.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape4.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/mapSupabaseToPrompt.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/mapPromptOutput.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/formatCurrency.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/sanitizeText.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/formatAddress.ts | Utilitaire | À coder | To Do |
| 2 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/convertLocalToSupabase.ts | Utilitaire | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/00.Technique/useSupabaseEtapesOperations.ts | Hook technique | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/00.Technique/useStepProgress.ts | Hook technique | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/01.Etape1/HookEtape-1.ts | Hook métier | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/01.Etape1/types.ts | Types | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/02.Etape2/HookEtape-2.ts | Hook métier | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/02.Etape2/types.ts | Types | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/03.Etape3/HookEtape-3.ts | Hook métier | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/03.Etape3/types.ts | Types | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/04.Etape4/HookEtape-4.ts | Hook métier | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/04.Etape4/types.ts | Types | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/05.Etape5/HookEtape-5.ts | Hook métier | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/05.Etape5/types.ts | Types | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/types.ts | Types communs | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/01.Hooks/index.ts | Exports | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/02.Components/HelpersEtapes1to5.ts | Composant utilitaire | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/02.Components/NavigationEtapes.tsx | Composant React | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/02.Components/ProgressIndicator.tsx | Composant React | À coder | To Do |
| 3 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/02.Components/LayoutGenerationAnnonce.tsx | Composant React | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/1.AnnonceSiteInternet.ts | Service OpenAI | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/2.AnnonceFichedeSynthese.ts | Service OpenAI | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/3.AnnonceNewsletter.ts | Service OpenAI | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/4.OutilsSEO.ts | Service OpenAI | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/5.SMSAnnonce.ts | Service OpenAI | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/6.GoogleBusinessProfileAnnonce.ts | Service OpenAI | À coder | To Do |
| 4 | src/services/openai/01.SupabaseEtape1to5/1.Services/7.ReseauxSociauxAnnonce.ts | Service OpenAI | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/01.AnnonceContext.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/02.Etape1FormulaireBienCommercial.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/03.Etape2ChoixTypeAnnonce.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/04.Etape3ValidationRecap.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/05.Etape4ReglagesParametrages.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/06.Etape5GenerationAnnonce.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/07.NavigationEtapes.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/08.ProgressIndicator.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/04.React/09.LayoutGenerationAnnonce.tsx | Composant React | À coder | To Do |
| 5 | src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/05.UtilitaireMigration/migrateLocalStorageToSupabase.ts | Script migration | À coder | To Do |





























