# 00. PROCESSUS DE R√âCUP√âRATION DES DONN√âES OPENAI VERS √âTAPE 6 COMMUNICATION

## I. MISSION DU DOCUMENT 

Ce document constitue la **bible technique compl√®te** du flux de donn√©es OpenAI dans l'application LeadGenAI. Il documente exhaustivement :

- **Le d√©clenchement des 7 services OpenAI** lors de l'√âtape 5
- **Le stockage des donn√©es** dans `localStorage` (7 cl√©s `generation_*`)
- **La r√©cup√©ration des donn√©es** par les 8 canaux de communication de l'√âtape 6
- **Le syst√®me d'√©dition et de sauvegarde** des modifications utilisateur (12 cl√©s `key-modifs-*`)
- **Les structures de donn√©es compl√®tes** (JSON, HTML, Markdown)
- **Les hooks de r√©cup√©ration** et leur logique de priorit√©
- **Le bouton "Nouveau Projet"** et son impact sur `localStorage`

**Public cible** : D√©veloppeurs, auditeurs de code, √©quipe de migration Supabase

**P√©rim√®tre** : √âtape 5 ‚Üí `localStorage` ‚Üí √âtape 6 Communication ‚Üí Actions utilisateur

---

## II. SOMMAIRE 

1. [Mission du Document](#i-mission)
2. [Sommaire](#ii-sommaire)
3. [Architecture Globale du Processus](#iii-architecture)
4. [Partie 1 : D√©clenchement des 7 Services OpenAI (√âtape 5)](#iv-partie-1)
5. [Partie 2 : Syst√®me de Nettoyage des Donn√©es OpenAI](#v-partie-2)
6. [Partie 3 : R√©cup√©ration des Donn√©es par les 8 Canaux](#vi-partie-3)
7. [Partie 4 : Liste Exhaustive des Hooks de R√©cup√©ration](#vii-partie-4)
8. [Partie 5 : D√©tail des Structures de Donn√©es par Canal](#viii-partie-5)
9. [Partie 6 : Syst√®me d'√âdition et de Sauvegarde](#ix-partie-6)
10. [Partie 7 : Bouton "G√©n√©rer un Nouveau Projet"](#x-partie-7)
11. [Partie 8 : D√©tail Complet du Service src/services/openai](#xi-partie-8)
12. [Partie 9 : Mapping Complet Services ‚Üí Canaux ‚Üí Actions](#xii-partie-9)
13. [Partie 10 : Tableau R√©capitulatif des Cl√©s localStorage](#xiii-partie-10)
14. [Donn√©es √† Prendre en Consid√©ration](#xiv-donnees)

---

## III. ARCHITECTURE GLOBALE DU PROCESSUS 

### Diagramme de Flux Complet

```mermaid
graph TB
    subgraph ETAPE5["√âTAPE 5 : G√âN√âRATION OPENAI"]
        PD[PropertyData - 14 champs]

        subgraph SERVICES["7 SERVICES OPENAI"]
            S1[1. Annonce Site Internet]
            S2[2. Fiche de Synth√®se]
            S3[3. Newsletter]
            S4[4. Outils SEO]
            S5[5. Annonce SMS]
            S6[6. Google Business Profile]
            S7[7. R√©seaux Sociaux]
        end

        PD --> S1
        PD --> S2
        PD --> S3
        PD --> S4
        PD --> S5
        PD --> S6
        PD --> S7
    end

    subgraph STORAGE["LOCALSTORAGE"]
        subgraph GENERATION["7 CL√âS GENERATION_*"]
            G1[generation_website_ad]
            G2[generation_summary_sheet]
            G3[generation_newsletter]
            G4[generation_seo_tools]
            G5[generation_sms_ad]
            G6[generation_googleprofile_ad]
            G7[generation_reseauxsociaux_ad]
        end
    end

    S1 --> G1
    S2 --> G2
    S3 --> G3
    S4 --> G4
    S5 --> G5
    S6 --> G6
    S7 --> G7

    subgraph ETAPE6["√âTAPE 6 : HUB COMMUNICATION - 8 CANAUX"]
        subgraph HOOKS["8 HOOKS DE R√âCUP√âRATION"]
            H1[Hook 1: Copier Annonce Site]
            H2[Hook 2: Int√©grer Outils SEO]
            H3[Hook 3: Diffuser Portails]
            H4[Hook 4: Campagne Newsletter]
            H5[Hook 5: Campagne SMS]
            H6[Hook 6: Google Business Profile]
            H7[Hook 7: R√©seaux Sociaux]
            H8[Hook 8: Landing Page]
        end

        subgraph PRIORITY["LOGIQUE DE PRIORIT√â"]
            P1{key-modifs-* existe ?}
            P2[Utiliser key-modifs-*]
            P3[Utiliser generation_*]
            P4[Valeurs vides]
        end
    end

    G1 --> H1
    G4 --> H2
    G2 --> H3
    G3 --> H4
    G5 --> H5
    G6 --> H6
    G7 --> H7
    G1 --> H8
    G2 --> H8

    H1 --> P1
    H2 --> P1
    H3 --> P1
    H4 --> P1
    H5 --> P1
    H6 --> P1
    H7 --> P1
    H8 --> P1

    P1 -->|OUI| P2
    P1 -->|NON| P3
    P3 -->|NON| P4

    subgraph MODIFS["12 CL√âS KEY-MODIFS-*"]
        M1[key-modifs-copier-annonce-site-internet]
        M2[key-modifs-integrer-outils-seo]
        M3[key-modifs-diffuser-portails-immobiliers]
        M4[key-modifs-creer-campagne-newsletter]
        M5[key-modifs-creer-campagne-sms]
        M6[key-modifs-diffuser-google-annonce]
        M7[key-modifs-diffuser-reseaux-sociaux-annonce]
        M8[key-modifs-creer-landing-page-annonce]
        M9[key-modifs-creer-landing-page-synthese]
    end

    P2 -.-> M1
    P2 -.-> M2
    P2 -.-> M3
    P2 -.-> M4
    P2 -.-> M5
    P2 -.-> M6
    P2 -.-> M7
    P2 -.-> M8
    P2 -.-> M9

    subgraph ACTIONS["ACTIONS UTILISATEUR"]
        A1[‚úèÔ∏è √âditer]
        A2[üìã Copier]
        A3[üëÅÔ∏è Aper√ßu]
        A4[üíæ Sauvegarder]
        A5[üì§ Publier]
    end

    P2 --> A1
    P3 --> A1
    A1 --> M1

    subgraph RESET["BOUTON NOUVEAU PROJET"]
        R1[localStorage.clear]
        R2[Navigation /etape1]
        R3[window.location.reload]
    end

    R1 -.->|Efface TOUT| STORAGE
```

### Flux de Donn√©es D√©taill√©

1. **PropertyData (14 champs)** ‚Üí Collect√©s dans les √âtapes 1-4
2. **√âtape 5** ‚Üí `handleValidateAndFinish()` d√©clenche 7 appels OpenAI en parall√®le
3. **R√©ponses OpenAI** ‚Üí Stock√©es dans 7 cl√©s `generation_*` dans `localStorage`
4. **√âtape 6** ‚Üí Hub central avec 8 options d'action
5. **Hooks de r√©cup√©ration** ‚Üí Lisent `key-modifs-*` en priorit√©, sinon `generation_*`
6. **√âdition utilisateur** ‚Üí Sauvegarde imm√©diate dans `key-modifs-*`
7. **Actions finales** ‚Üí Copier, Aper√ßu, Sauvegarder, Publier (selon le canal)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                          √âTAPE 5 : D√âCLENCHEMENT                         ‚îÇ
‚îÇ                                                                           ‚îÇ
‚îÇ  Utilisateur clique sur "G√©n√©rer mes Annonces"                          ‚îÇ
‚îÇ            ‚Üì                                                              ‚îÇ
‚îÇ  Fonction handleValidateAndFinish() dans Etape5.tsx                     ‚îÇ
‚îÇ            ‚Üì                                                              ‚îÇ
‚îÇ  7 Services OpenAI appel√©s s√©quentiellement                             ‚îÇ
‚îÇ            ‚Üì                                                              ‚îÇ
‚îÇ  Donn√©es JSON stock√©es dans localStorage avec cl√©s sp√©cifiques          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     √âTAPE 6 : R√âCUP√âRATION & INJECTION                   ‚îÇ
‚îÇ                                                                           ‚îÇ
‚îÇ  8 Canaux de communication r√©cup√®rent les donn√©es via hooks             ‚îÇ
‚îÇ            ‚Üì                                                              ‚îÇ
‚îÇ  Nettoyage des caract√®res √©chapp√©s (cleanOpenAIContent)                 ‚îÇ
‚îÇ            ‚Üì                                                              ‚îÇ
‚îÇ  Affichage et √©dition par l'utilisateur                                 ‚îÇ
‚îÇ            ‚Üì                                                              ‚îÇ
‚îÇ  Sauvegarde des modifications dans de nouvelles cl√©s localStorage       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```
---

## IV. PARTIE 1 : D√âCLENCHEMENT DES 7 SERVICES OPENAI (√âTAPE 5) 

### Fichier Source

**`src/1.etapes-generation-annonces/etape5/Etape5.tsx`** - Fonction `handleValidateAndFinish()`
- **Localisation :** Lignes 44-139 de `Etape5.tsx`

**Description :** 
- Cette fonction asynchrone orchestre l'appel s√©quentiel des 7 services OpenAI. Elle :
1. R√©cup√®re les donn√©es de propri√©t√© depuis `localStorage` (`propertyData`)
2. V√©rifie la pr√©sence de la cl√© API OpenAI
3. Initialise le statut de g√©n√©ration dans `localStorage` (`generation_status`)
4. Appelle les 7 services OpenAI un par un
5. Stocke chaque r√©sultat dans une cl√© `localStorage` d√©di√©e
6. Met √† jour le statut de progression apr√®s chaque g√©n√©ration r√©ussie
7. Navigue vers `/etape6communication` une fois termin√©

### Code Complet de D√©clenchement (Lignes 64-137)

```typescript
const handleValidateAndFinish = async () => {
  try {
    setIsLoading(true);

    const propertyData = getPropertyDataFromStorage();

    if (!propertyData || !propertyData.propertyType) {
      throw new Error("Donn√©es du bien non trouv√©es");
    }

    const openaiService = createOpenAIService(apiKey);
    const smsService = createOpenAISMSService(apiKey);
    const googleService = createOpenAIGoogleBusinessProfileService(apiKey);
    const reseauxService = createOpenAIReseauxSociauxService(apiKey);

    // 1. Annonce Site Internet
    const websiteAd = await openaiService.generateWebsiteAd(propertyData, "gpt-4o");
    localStorage.setItem('generation_website_ad', JSON.stringify(websiteAd));

    // 2. Fiche de Synth√®se
    const summarySheet = await openaiService.generateSummarySheetAd(propertyData, "gpt-4o");
    localStorage.setItem('generation_summary_sheet', JSON.stringify(summarySheet));

    // 3. Newsletter
    const newsletter = await openaiService.generateNewsletterAd(propertyData, "gpt-4o");
    localStorage.setItem('generation_newsletter', JSON.stringify(newsletter));

    // 4. Outils SEO
    const seoTools = await openaiService.generateSEOTools(propertyData, "gpt-4o");
    localStorage.setItem('generation_seo_tools', JSON.stringify(seoTools));

    // 5. Annonce SMS
    const smsAd = await smsService.generateSMSAd(propertyData, "gpt-4o");
    localStorage.setItem('generation_sms_ad', JSON.stringify(smsAd));

    // 6. Google Business Profile
    const googleAd = await googleService.generateGoogleBusinessProfileAd(propertyData, "gpt-4o");
    localStorage.setItem('generation_googleprofile_ad', JSON.stringify(googleAd));

    // 7. R√©seaux Sociaux
    const reseauxAd = await reseauxService.generateReseauxSociauxAd(propertyData, "gpt-4o");
    localStorage.setItem('generation_reseauxsociaux_ad', JSON.stringify(reseauxAd));

    // Mise √† jour du statut de g√©n√©ration
    localStorage.setItem('generation_status', JSON.stringify({
      completed: true,
      timestamp: new Date().toISOString()
    }));

    toast({
      title: "G√©n√©ration termin√©e",
      description: "Toutes les annonces ont √©t√© g√©n√©r√©es avec succ√®s",
    });

    navigate("/etape6communication");
  } catch (error) {
    console.error("Erreur lors de la g√©n√©ration:", error);
    toast({
      title: "Erreur",
      description: error instanceof Error ? error.message : "Une erreur est survenue",
      variant: "destructive",
    });
  } finally {
    setIsLoading(false);
  }
};
```

### D√©tail des 7 Services OpenAI

#### 1. ANNONCE SITE INTERNET

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai.ts` |
| **Classe** | `OpenAIService` |
| **M√©thode** | `generateWebsiteAd(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptAnnonceSiteInternet` (116 lignes) |
| **Cl√© localStorage** | `generation_website_ad` |
| **Structure JSON** | `{ titre: string, accroche: string, descriptif: string, cta: string }` |
| **Champs propertyData utilis√©s** | Tous les 14 champs |
| **Taille estim√©e** | 2-3 KB |
| **Format** | Texte brut (titre, accroche, cta) + HTML (descriptif) |

**Code d'appel :**
```typescript
const websiteAd = await openaiService.generateWebsiteAd(propertyData, "gpt-4o");
localStorage.setItem('generation_website_ad', JSON.stringify(websiteAd));
```

---

#### 2. FICHE DE SYNTH√àSE

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai.ts` |
| **Classe** | `OpenAIService` |
| **M√©thode** | `generateSummarySheetAd(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptAnnonceFichedeSynthese` (125 lignes) |
| **Cl√© localStorage** | `generation_summary_sheet` |
| **Structure JSON** | `{ titre: string, referenceEtPrix: string, detailsCles: string, donneesFinancieres: string, informationsComplementaires: string }` |
| **Champs utilis√©s** | Tous les 14 champs |
| **Taille estim√©e** | 3-4 KB |
| **Format** | HTML avec balises ``, ``, ``, `` |

**Code d'appel :**
```typescript
const summarySheet = await openaiService.generateSummarySheetAd(propertyData, "gpt-4o");
localStorage.setItem('generation_summary_sheet', JSON.stringify(summarySheet));
```

---

#### 3. NEWSLETTER

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai.ts` |
| **Classe** | `OpenAIService` |
| **M√©thode** | `generateNewsletterAd(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptAnnonceNewsletter` (152 lignes) |
| **Cl√© localStorage** | `generation_newsletter` |
| **Structure JSON** | `{ titre: string, accroche: string, pointsForts: string, callToAction: string, prixEtReference: string }` |
| **Champs utilis√©s** | 13 champs (sans `details`) |
| **Taille estim√©e** | 2-3 KB |
| **Format** | HTML avec ``, ``, ``, `` |

**Code d'appel :**
```typescript
const newsletter = await openaiService.generateNewsletterAd(propertyData, "gpt-4o");
localStorage.setItem('generation_newsletter', JSON.stringify(newsletter));
```

---

#### 4. OUTILS SEO

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai.ts` |
| **Classe** | `OpenAIService` |
| **M√©thode** | `generateSEOTools(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptOutilsSEO` (83 lignes) |
| **Cl√© localStorage** | `generation_seo_tools` |
| **Structure JSON** | `{ baliseTitre: string, baliseMetaDescription: string, urlLongueTraine: string }` |
| **Champs utilis√©s** | 13 champs (sans `details`) |
| **Taille estim√©e** | 1-2 KB |
| **Format** | Texte brut (tous les champs) |

**Code d'appel :**
```typescript
const seoTools = await openaiService.generateSEOTools(propertyData, "gpt-4o");
localStorage.setItem('generation_seo_tools', JSON.stringify(seoTools));
```

---

#### 5. ANNONCE SMS

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai/1.GenerateurAnnoncesOutilsSeo/0.APIAutresFonctionsLeadGenAI/1.API-AnnonceSMS.ts` |
| **Classe** | `OpenAISMSService` |
| **M√©thode** | `generateSMSAd(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptSMSAnnonce` (220 lignes) |
| **Assistant ID** | `asst_TdAq1QLpBVlEOwjAm2fLSy4U` |
| **Cl√© localStorage** | `generation_sms_ad` |
| **Structure JSON** | `{ "restitution-annonce-sms": string }` |
| **Champs utilis√©s** | Tous les 14 champs |
| **Taille estim√©e** | 0.5-1 KB (SMS limit√© √† 160 caract√®res) |
| **Nettoyage** | Suppression des backticks markdown |

**Code d'appel :**
```typescript
const smsAd = await smsService.generateSMSAd(propertyData, "gpt-4o");
localStorage.setItem('generation_sms_ad', JSON.stringify(smsAd));
```

**Code de nettoyage des backticks (lignes 168-172) :**
```typescript
let cleanedMessage = message;
if (cleanedMessage.startsWith('```')) {
  cleanedMessage = cleanedMessage.replace(/^```[\s\S]*?\n/, '').replace(/\n```$/, '');
}
return cleanedMessage;
```

---

#### 6. GOOGLE BUSINESS PROFILE

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai/1.GenerateurAnnoncesOutilsSeo/0.APIAutresFonctionsLeadGenAI/2.API-AnnonceGoogleBusinessProfile.ts` |
| **Classe** | `OpenAIGoogleBusinessProfileService` |
| **M√©thode** | `generateGoogleBusinessProfileAd(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptGoogleBusinessProfileAnnonce` |
| **Assistant ID** | `asst_ON4cwe282z5TH89uY8lhvZP5` |
| **Cl√© localStorage** | `generation_googleprofile_ad` |
| **Structure JSON** | `{ TitreAnnonceGoogle: string, AccrocheDescriptiveAnnonceGoogle: string, PointsFortsAnnonceGoogle: string, CtaAnnonceGoogle: string }` |
| **Champs utilis√©s** | 12 champs (sans `details` et `reference`) |
| **Taille estim√©e** | 2-3 KB |
| **Nettoyage** | Suppression des backticks markdown |

**Code d'appel :**
```typescript
const googleAd = await googleService.generateGoogleBusinessProfileAd(propertyData, "gpt-4o");
localStorage.setItem('generation_googleprofile_ad', JSON.stringify(googleAd));
```

**‚ö†Ô∏è Particularit√© - Nommage PascalCase :**
Les cl√©s JSON retourn√©es par OpenAI sont en PascalCase, mais l'interface React utilise camelCase. Un mapping est n√©cessaire dans les hooks de r√©cup√©ration.


---

#### 7. R√âSEAUX SOCIAUX

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier API** | `src/services/openai/1.GenerateurAnnoncesOutilsSeo/0.APIAutresFonctionsLeadGenAI/3.API-AnnonceReseauxSociaux.ts` |
| **Classe** | `OpenAIReseauxSociauxService` |
| **M√©thode** | `generateReseauxSociauxAd(data: PropertyData, model: "gpt-4o")` |
| **Prompt** | `promptReseauxSociauxAnnonce` |
| **Assistant ID** | `asst_XL1EVDiLq6jUzfrvdJUy4bey` |
| **Cl√© localStorage** | `generation_reseauxsociaux_ad` |
| **Structure JSON** | `{ TitreAnnonceReseaux: string, AccrocheImpactanteAnnonceReseaux: string, AtoutsAnnonceReseaux: string, CtaAnnonceReseaux: string }` |
| **Champs utilis√©s** | 13 champs (sans `details`) |
| **Taille estim√©e** | 2-3 KB |
| **Nettoyage** | Parse direct (pas de backticks) |

**Code d'appel :**
```typescript
const reseauxAd = await reseauxService.generateReseauxSociauxAd(propertyData, "gpt-4o");
localStorage.setItem('generation_reseauxsociaux_ad', JSON.stringify(reseauxAd));
```

**‚ö†Ô∏è Particularit√© - Nommage PascalCase :**
M√™me probl√©matique que Google Business Profile - mapping n√©cessaire.

---

### Tableau R√©capitulatif des 7 Services

| # | Service | Classe | M√©thode | Cl√© localStorage | Champs JSON | Taille | Assistant ID |
|---|---------|--------|---------|------------------|-------------|--------|--------------|
| 1 | Annonce Site Internet | `OpenAIService` | `generateWebsiteAd()` | `generation_website_ad` | 4 | 2-3 KB | - |
| 2 | Fiche de Synth√®se | `OpenAIService` | `generateSummarySheetAd()` | `generation_summary_sheet` | 5 | 3-4 KB | - |
| 3 | Newsletter | `OpenAIService` | `generateNewsletterAd()` | `generation_newsletter` | 5 | 2-3 KB | - |
| 4 | Outils SEO | `OpenAIService` | `generateSEOTools()` | `generation_seo_tools` | 3 | 1-2 KB | - |
| 5 | Annonce SMS | `OpenAISMSService` | `generateSMSAd()` | `generation_sms_ad` | 1 | 0.5-1 KB | `asst_TdAq1QLpBVlEOwjAm2fLSy4U` |
| 6 | Google Business Profile | `OpenAIGoogleBusinessProfileService` | `generateGoogleBusinessProfileAd()` | `generation_googleprofile_ad` | 4 | 2-3 KB | `asst_ON4cwe282z5TH89uY8lhvZP5` |
| 7 | R√©seaux Sociaux | `OpenAIReseauxSociauxService` | `generateReseauxSociauxAd()` | `generation_reseauxsociaux_ad` | 4 | 2-3 KB | `asst_XL1EVDiLq6jUzfrvdJUy4bey` |

---

## V. PARTIE 2 : SYST√àME DE NETTOYAGE DES DONN√âES OPENAI 

### Fonction `cleanOpenAIContent()`

**Localisation :**
- `src/components/1-Sources-Restitution-Utilisateur/6.EtapeDiffuserGoogleAnnonce/Hook-1-RecuperationDataGoogle.ts` (lignes 10-18)
- `src/components/1-Sources-Restitution-Utilisateur/7.EtapeDiffuserReseauxAnnonce/Hook-1-RecuperationDataReseaux.ts` (lignes 10-18)

**Code complet :**
```typescript
const cleanOpenAIContent = (text: string): string => {
  if (!text) return "";
  return text
    .replace(/\\n/g, "\n")      // Convertir les \n litt√©raux en vrais retours √† la ligne
    .replace(/\\\\/g, "\\");    // Convertir les \\\\ en \
};
```

### Transformations Appliqu√©es

| Pattern | Remplacement | Description |
|---------|--------------|-------------|
| `\\n` | `\n` | Conversion des retours √† la ligne √©chapp√©s en vrais sauts de ligne |
| `\\\\` | `\`| Conversion des backslashes doublement √©chapp√©s en backslashes simples |

### Exemples de Transformation

**Avant nettoyage :**
```
"‚úì Emplacement exceptionnel\\n‚úì 120 m¬≤ sur 2 niveaux\\n‚úì CA 650 000 ‚Ç¨/an"
```

**Apr√®s nettoyage :**
```
"‚úì Emplacement exceptionnel
‚úì 120 m¬≤ sur 2 niveaux
‚úì CA 650 000 ‚Ç¨/an"
```

### ‚ö†Ô∏è Dette Technique

**Probl√®me** : Cette fonction est **dupliqu√©e** dans 2 fichiers diff√©rents.

**Fichier cible** : `src/utils/openai-helpers.ts`

---

## VI. PARTIE 3 : R√âCUP√âRATION DES DONN√âES PAR LES 8 CANAUX 

### Hub Central

**Fichier** : `src/1.etapes-restitution-utilisateur/0.Etape6Communication/Etape6Communication.tsx`

**R√¥le** : Point d'entr√©e unique de l'√âtape 6 qui affiche 8 options d'action sous forme de cartes cliquables.

### Mapping Services OpenAI ‚Üí Canaux

| ID Option | Titre Canal | Service OpenAI Source | Cl√©s localStorage LUES | Composant Rendu |
|-----------|-------------|----------------------|------------------------|-----------------|
| `copier-annonce-site` | Copier Annonce Site Internet | Annonce Site Internet | `key-modifs-copier-annonce-site-internet` ‚Üí `generation_website_ad` | `AccueilCopierSiteInternet` |
| `integrer-outils-seo` | Int√©grer Outils SEO | Outils SEO | `key-modifs-integrer-outils-seo` ‚Üí `generation_seo_tools` | `AccueilIntegrerOutilsSEO` |
| `diffuser-portails` | Diffuser Portails Immobiliers | Fiche de Synth√®se | `key-modifs-diffuser-portails-immobiliers` ‚Üí `generation_summary_sheet` | `AccueilDiffuserPortails` |
| `creer-campagne-newsletter` | Cr√©er Campagne Newsletter | Newsletter | `key-modifs-creer-campagne-newsletter` ‚Üí `generation_newsletter` | `AccueilCreerCampagneNewsletter` |
| `creer-campagne-sms` | Cr√©er Campagne SMS | Annonce SMS | `key-modifs-creer-campagne-sms` ‚Üí `generation_sms_ad` | `AccueilCreerCampagneSMS` |
| `diffuser-google` | Diffuser Google Business Profile | Google Business Profile | `key-modifs-diffuser-google-annonce` ‚Üí `generation_googleprofile_ad` | `AccueilDiffuserGoogleAnnonce` |
| `diffuser-reseaux` | Diffuser R√©seaux Sociaux | R√©seaux Sociaux | `key-modifs-diffuser-reseaux-sociaux-annonce` ‚Üí `generation_reseauxsociaux_ad` | `AccueilDiffuserReseauxAnnonce` |
| `creer-landing-page` | Cr√©er Landing Page | Annonce Site Internet + Fiche de Synth√®se | `key-modifs-creer-landing-page-annonce` ‚Üí `generation_website_ad``key-modifs-creer-landing-page-synthese` ‚Üí `generation_summary_sheet` | `AccueilCreerLandingPageAnnonce` |

### Code de Mapping dans Etape6Communication.tsx

```typescript
const actionOptions = [
  {
    id: "copier-annonce-site",
    title: "Copier Annonce Site Internet",
    description: "Copiez votre annonce pour la publier sur votre site web",
    icon: ,
    route: "/etape6communication/copier-annonce-site"
  },
  {
    id: "integrer-outils-seo",
    title: "Int√©grer Outils SEO",
    description: "Optimisez votre r√©f√©rencement avec nos outils SEO",
    icon: ,
    route: "/etape6communication/integrer-outils-seo"
  },
  // ... 6 autres options
];
```

---

## VII. PARTIE 4 : LISTE EXHAUSTIVE DES HOOKS DE R√âCUP√âRATION 

### Hook 1 : Copier Annonce Site Internet

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/1.EtapeCopierAnnonceSiteInternet/HookRecuperationAnnonceSiteInternet.ts` |
| **Fonction** | `useRecuperationAnnonceSiteInternet()` |
| **Cl√©s LUES** | 1. `key-modifs-copier-annonce-site-internet` (priorit√© 1)2. `generation_website_ad` (priorit√© 2) |
| **Cl√©s √âCRITES** | `key-modifs-copier-annonce-site-internet` |
| **Interface** | `AnnonceSiteInternetData { titre, accroche, descriptif, appelAction }` |
| **Logique de priorit√©** | Modifs > Original > Vide |

**Code complet du hook :**
```typescript
import { useState, useEffect } from 'react';

interface AnnonceSiteInternetData {
  titre: string;
  accroche: string;
  descriptif: string;
  appelAction: string;
}

export const useRecuperationAnnonceSiteInternet = () => {
  const [annonceSiteInternet, setAnnonceSiteInternet] = useState({
    titre: '',
    accroche: '',
    descriptif: '',
    appelAction: ''
  });
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    try {
      setIsLoading(true);

      // PRIORIT√â 1 : V√©rifier les donn√©es modifi√©es
      const modifiedDataJson = localStorage.getItem('key-modifs-copier-annonce-site-internet');

      if (modifiedDataJson) {
        const modifiedData = JSON.parse(modifiedDataJson);
        setAnnonceSiteInternet({
          titre: modifiedData.titre || '',
          accroche: modifiedData.accroche || '',
          descriptif: modifiedData.descriptif || '',
          appelAction: modifiedData.appelAction || ''
        });
      } else {
        // PRIORIT√â 2 : R√©cup√©ration des donn√©es originales
        const annonceSiteData = localStorage.getItem('generation_website_ad');

        if (annonceSiteData) {
          const parsedData = JSON.parse(annonceSiteData);
          setAnnonceSiteInternet({
            titre: parsedData.titre || '',
            accroche: parsedData.accroche || '',
            descriptif: parsedData.descriptif || '',
            appelAction: parsedData.cta || '' // ‚ö†Ô∏è Mapping: cta ‚Üí appelAction
          });
        } else {
          console.log('Aucune donn√©e trouv√©e dans le localStorage');
        }
      }

      setIsLoading(false);
    } catch (err) {
      console.error('Erreur lors de la r√©cup√©ration:', err);
      setError('Erreur lors de la r√©cup√©ration des donn√©es');
      setIsLoading(false);
    }
  }, []);

  const updateAnnonceSiteInternet = (newData: Partial) => {
    const updatedData = { ...annonceSiteInternet, ...newData };
    setAnnonceSiteInternet(updatedData);

    try {
      // Sauvegarde imm√©diate dans localStorage
      localStorage.setItem('key-modifs-copier-annonce-site-internet', JSON.stringify(updatedData));
    } catch (err) {
      console.error('Erreur lors de la sauvegarde:', err);
      setError('Erreur lors de la sauvegarde des donn√©es');
    }
  };

  return { annonceSiteInternet, updateAnnonceSiteInternet, isLoading, error };
};
```

---

### Hook 2 : Int√©grer Outils SEO

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/2.EtapeIntegrerOutilsSEO/HookRecuperationOutilsSEO.ts` |
| **Fonction** | `useRecuperationOutilsSEO()` |
| **Cl√©s LUES** | 1. `key-modifs-integrer-outils-seo`2. `generation_seo_tools` |
| **Cl√©s √âCRITES** | `key-modifs-integrer-outils-seo` |
| **Interface** | `OutilsSEOData { baliseTitre, baliseMetaDescription, urlLongueTraine }` |

**Structure identique au Hook 1** (logique de priorit√© similaire).

---

### Hook 3 : Cr√©er Campagne Newsletter

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/4.EtapeCreerCampagneNewsletter/Hook-1-RecuperationDataNewsletter.ts` |
| **Fonction** | `useRecuperationDataNewsletter()` |
| **Cl√©s LUES** | 1. `key-modifs-creer-campagne-newsletter`2. `generation_newsletter` |
| **Cl√©s √âCRITES** | `key-modifs-creer-campagne-newsletter` |
| **Interface** | `AnnonceNewsletterData { titre, accroche, pointsForts, callToAction, prixEtReference }` |

---

### Hook 4 : Cr√©er Campagne SMS

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerCampagneSMS/Hook-1-RecuperationDataSMS.ts` |
| **Fonction** | `useRecuperationDataSMS()` |
| **Cl√©s LUES** | 1. `key-modifs-creer-campagne-sms`2. `generation_sms_ad` |
| **Cl√©s √âCRITES** | `key-modifs-creer-campagne-sms` |
| **Interface** | `AnnonceSMSData { "restitution-annonce-sms": string }` |

---

### Hook 5 : Diffuser Google Business Profile

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/6.EtapeDiffuserGoogleAnnonce/Hook-1-RecuperationDataGoogle.ts` |
| **Fonction** | `useRecuperationDataGoogle()` |
| **Cl√©s LUES** | 1. `key-modifs-diffuser-google-annonce`2. `generation_googleprofile_ad` + **nettoyage `cleanOpenAIContent()`** |
| **Cl√©s √âCRITES** | `key-modifs-diffuser-google-annonce` |
| **Interface** | `AnnonceGoogleData { titre, accroche, pointsForts, appelAction }` |

**‚ö†Ô∏è Particularit√© : Mapping PascalCase ‚Üí camelCase**

```typescript
// Code de mapping dans le hook (lignes 35-38)
setAnnonceGoogle({
  titre: cleanOpenAIContent(parsedData.TitreAnnonceGoogle || ''),
  accroche: cleanOpenAIContent(parsedData.AccrocheDescriptiveAnnonceGoogle || ''),
  pointsForts: cleanOpenAIContent(parsedData.PointsFortsAnnonceGoogle || ''),
  appelAction: cleanOpenAIContent(parsedData.CtaAnnonceGoogle || '')
});
```

---

### Hook 6 : Diffuser R√©seaux Sociaux

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/7.EtapeDiffuserReseauxAnnonce/Hook-1-RecuperationDataReseaux.ts` |
| **Fonction** | `useRecuperationDataReseaux()` |
| **Cl√©s LUES** | 1. `key-modifs-diffuser-reseaux-sociaux-annonce`2. `generation_reseauxsociaux_ad` + **nettoyage** |
| **Cl√©s √âCRITES** | `key-modifs-diffuser-reseaux-sociaux-annonce` |
| **Interface** | `AnnonceReseauxData { titre, accroche, pointsForts, appelAction }` |

**‚ö†Ô∏è M√™me mapping PascalCase ‚Üí camelCase que Google**

---

### Hook 7 : Landing Page - Annonce

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/8.EtapeCreerLandingPageAnnonce/HookRecuperationAnnonceVersLandingPage.ts` |
| **Fonction** | `useRecuperationAnnonceVersLandingPage()` |
| **Cl√©s LUES** | 1. `key-modifs-creer-landing-page-annonce`2. `generation_website_ad` |
| **Cl√©s √âCRITES** | `key-modifs-creer-landing-page-annonce` |
| **Interface** | `AnnonceLandingPageData { titre, accroche, descriptif, appelAction }` |

---

### Hook 8 : Landing Page - Fiche de Synth√®se

| Propri√©t√© | Valeur |
|-----------|--------|
| **Fichier** | `src/components/1-Sources-Restitution-Utilisateur/8.EtapeCreerLandingPageAnnonce/HookRecuperationFichedeSyntheseVersLandingPage.ts` |
| **Fonction** | `useRecuperationFichedeSyntheseVersLandingPage()` |
| **Cl√©s LUES** | 1. `key-modifs-creer-landing-page-synthese`2. `generation_summary_sheet` |
| **Cl√©s √âCRITES** | `key-modifs-creer-landing-page-synthese` |
| **Interface** | `FichedeSyntheseLandingPageData { titre, referenceEtPrix, detailsCles, donneesFinancieres, informationsComplementaires }` |

---

### Tableau R√©capitulatif des 8 Hooks

| # | Hook | Fichier | Cl√©s LUES (priorit√©) | Cl√©s √âCRITES | Nettoyage | Mapping |
|---|------|---------|---------------------|--------------|-----------|---------|
| 1 | Copier Annonce Site | `HookRecuperationAnnonceSiteInternet.ts` | `key-modifs-copier-annonce-site-internet` ‚Üí `generation_website_ad` | `key-modifs-copier-annonce-site-internet` | Non | `cta ‚Üí appelAction` |
| 2 | Int√©grer Outils SEO | `HookRecuperationOutilsSEO.ts` | `key-modifs-integrer-outils-seo` ‚Üí `generation_seo_tools` | `key-modifs-integrer-outils-seo` | Non | Non |
| 3 | Cr√©er Campagne Newsletter | `Hook-1-RecuperationDataNewsletter.ts` | `key-modifs-creer-campagne-newsletter` ‚Üí `generation_newsletter` | `key-modifs-creer-campagne-newsletter` | Non | Non |
| 4 | Cr√©er Campagne SMS | `Hook-1-RecuperationDataSMS.ts` | `key-modifs-creer-campagne-sms` ‚Üí `generation_sms_ad` | `key-modifs-creer-campagne-sms` | Non | Non |
| 5 | Diffuser Google | `Hook-1-RecuperationDataGoogle.ts` | `key-modifs-diffuser-google-annonce` ‚Üí `generation_googleprofile_ad` | `key-modifs-diffuser-google-annonce` | **Oui** | **PascalCase ‚Üí camelCase** |
| 6 | Diffuser R√©seaux | `Hook-1-RecuperationDataReseaux.ts` | `key-modifs-diffuser-reseaux-sociaux-annonce` ‚Üí `generation_reseauxsociaux_ad` | `key-modifs-diffuser-reseaux-sociaux-annonce` | **Oui** | **PascalCase ‚Üí camelCase** |
| 7 | Landing Page - Annonce | `HookRecuperationAnnonceVersLandingPage.ts` | `key-modifs-creer-landing-page-annonce` ‚Üí `generation_website_ad` | `key-modifs-creer-landing-page-annonce` | Non | `cta ‚Üí appelAction` |
| 8 | Landing Page - Synth√®se | `HookRecuperationFichedeSyntheseVersLandingPage.ts` | `key-modifs-creer-landing-page-synthese` ‚Üí `generation_summary_sheet` | `key-modifs-creer-landing-page-synthese` | Non | Non |

---

## VIII. PARTIE 5 : D√âTAIL DES STRUCTURES DE DONN√âES PAR CANAL 

### Canal 1 : Copier Annonce Site Internet

**Composants :**
- `AccueilCopierSiteInternet.tsx` (hub)
- `File1.CopierSiteInternetTab.tsx` (onglet √©dition)
- `File2.CopierSiteInternetTab.tsx` (onglet aper√ßu)
- `File3.CopierSiteInternetTab.tsx` (onglet copie)
- `HookRecuperationAnnonceSiteInternet.ts` (r√©cup√©ration donn√©es)
- `MenuOngletCopierSiteInternet.tsx` (navigation onglets)

**Cl√©s localStorage utilis√©es :**
- LECTURE : `generation_website_ad`
- √âCRITURE : `key-modifs-copier-annonce-site-internet`

**Structure JSON compl√®te :**
```json
{
  "titre": "Restaurant Traditionnel - Emplacement Premium Paris 8√®me",
  "accroche": "D√©couvrez cette opportunit√© unique d'acqu√©rir un restaurant traditionnel dans l'un des quartiers les plus prestigieux de Paris",
  "descriptif": "Situ√© au c≈ìur du 8√®me arrondissement de Paris, ce restaurant traditionnel b√©n√©ficie d'un emplacement exceptionnel sur une art√®re tr√®s fr√©quent√©e.L'√©tablissement dispose d'une salle de 80 couverts r√©partie sur deux niveaux, avec une cuisine professionnelle enti√®rement √©quip√©e et aux normes.Client√®le fid√®le et r√©guli√®re, forte notori√©t√© dans le quartier. Bail commercial de 9 ans renouvelable.",
  "appelAction": "Contactez-nous d√®s aujourd'hui pour organiser une visite et d√©couvrir cette opportunit√© exceptionnelle. Exclusivit√©."
}
```

**Format :**
- `titre` : Texte brut
- `accroche` : Texte brut
- `descriptif` : **HTML** (balises ``, ``, ``, ``)
- `appelAction` : Texte brut

**Taille estim√©e :** 2-3 KB

**Actions utilisateur disponibles :**
- ‚úÖ **√âditer** les 4 champs (texte enrichi pour descriptif)
- ‚úÖ **Copier** dans le presse-papier (format texte)
- ‚úÖ **Aper√ßu** visuel avec mise en forme

**Statut impl√©mentation :** ‚úÖ **COMPLET**

---

### Canal 2 : Int√©grer Outils SEO

**Composants :**
- `AccueilIntegrerOutilsSEO.tsx`
- `File1.OutilsSEOTab.tsx`, `File2.OutilsSEOTab.tsx`, `File3.OutilsSEOTab.tsx`
- `HookRecuperationOutilsSEO.ts`

**Cl√©s localStorage :**
- LECTURE : `generation_seo_tools`
- √âCRITURE : `key-modifs-integrer-outils-seo`

**Structure JSON compl√®te :**
```json
{
  "baliseTitre": "Restaurant Traditionnel Paris 8√®me - 80 Couverts - 450 000 ‚Ç¨",
  "baliseMetaDescription": "Restaurant traditionnel √† vendre Paris 8√®me, 120 m¬≤, 80 couverts, cuisine √©quip√©e, emplacement premium Champs-√âlys√©es. CA 650 000 ‚Ç¨. Exclusivit√©.",
  "urlLongueTraine": "restaurant-traditionnel-vente-paris-8eme-champs-elysees-80-couverts-450000-euros"
}
```

**Format :** Texte brut (tous les champs)

**Actions utilisateur :**
- ‚úÖ √âditer les 3 champs
- ‚úÖ Copier (format texte)
- ‚úÖ Aper√ßu avec compteur de caract√®res

**Statut :** ‚úÖ **COMPLET**

---

### Canal 3 : Diffuser Portails Immobiliers

**Composants :**
- `AccueilDiffuserPortails.tsx`
- `File1.DiffuserPortailsTab.tsx` (√©dition)
- `File2.DiffuserPortailsTab.tsx` (aper√ßu)
- `File3.DiffuserPortailsTab.tsx` (actions)
- `HookRecuperationAnnonceFichedeSynthese.ts`

**Cl√©s localStorage :**
- LECTURE : `generation_summary_sheet`
- √âCRITURE : `key-modifs-diffuser-portails-immobiliers`

**Structure JSON compl√®te :**
```json
{
  "titre": "Restaurant Traditionnel - Paris 8√®me - 450 000 ‚Ç¨",
  "referenceEtPrix": "R√©f√©rence : COM-75008-REST-001Prix de vente : 450 000 ‚Ç¨ FAI",
  "detailsCles": "Surface : 120 m¬≤Salle : 80 couverts sur 2 niveauxCuisine professionnelle aux normesEmplacement premium - Avenue des Champs-√âlys√©es",
  "donneesFinancieres": "Chiffre d'affaires annuel : 650 000 ‚Ç¨Loyer mensuel : 4 500 ‚Ç¨ HT/moisBail commercial : 9 ans renouvelable",
  "informationsComplementaires": "Client√®le fid√®le et r√©guli√®re. Forte notori√©t√© dans le quartier. Possibilit√© de d√©velopper une activit√© traiteur.Exclusivit√©"
}
```

**Format :** HTML complet avec balises ``, ``, ``, ``, ``

**Taille estim√©e :** 3-4 KB

**Actions utilisateur :**
- ‚úÖ √âditer les 5 champs (√©diteur HTML)
- ‚úÖ Copier (format HTML)
- ‚úÖ Aper√ßu avec rendu HTML
- ‚ö†Ô∏è **TODO** : Int√©gration API portails immobiliers (SeLoger, LeBonCoin, etc.)

**Statut :** ‚ö†Ô∏è **PARTIEL** (Int√©gration API manquante)

---

### Canal 4 : Cr√©er Campagne Newsletter

**Composants :**
- `AccueilCreerCampagneNewsletter.tsx`
- `Hook-1-RecuperationDataNewsletter.ts`
- `HookSauvegarderCampagneNewsletter.tsx` (action sauvegarde - TODO)

**Cl√©s localStorage :**
- LECTURE : `generation_newsletter`
- √âCRITURE : `key-modifs-creer-campagne-newsletter`

**Structure JSON compl√®te :**
```json
{
  "titre": "Restaurant Traditionnel - Emplacement d'Exception Paris 8√®me",
  "accroche": "Nous sommes ravis de vous pr√©senter cette opportunit√© rare d'acqu√©rir un restaurant traditionnel dans l'un des quartiers les plus pris√©s de la capitale.",
  "pointsForts": "Emplacement premium : Avenue des Champs-√âlys√©es, forte affluenceCapacit√© importante : 80 couverts sur 2 niveaux√âquipement complet : Cuisine professionnelle aux normesRentabilit√© prouv√©e : CA 650 000 ‚Ç¨ annuel",
  "callToAction": "Pour organiser une visite ou obtenir des informations compl√©mentaires, contactez-nous d√®s maintenant.",
  "prixEtReference": "Prix : 450 000 ‚Ç¨ FAI | R√©f : COM-75008-REST-001 | Exclusivit√©"
}
```

**Format :** HTML avec ``, ``, ``, ``

**Taille estim√©e :** 2-3 KB

**Actions utilisateur :**
- ‚úÖ √âditer les 5 champs
- ‚úÖ Copier (format HTML compatible email)
- ‚úÖ Aper√ßu avec rendu email
- ‚ö†Ô∏è **TODO** : Envoyer via Brevo (API d'envoi newsletter)

**Statut :** ‚ö†Ô∏è **PARTIEL** (Int√©gration Brevo manquante)

---

### Canal 5 : Cr√©er Campagne SMS

**Composants :**
- `AccueilCreerCampagneSMS.tsx`
- `Hook-1-RecuperationDataSMS.ts`
- `Hook-2-PersonnaliserChamps.tsx` (personnalisation exp√©diteur, URL, destinataires)
- `Hook-3-UtiliserFonctionEnvoiBrevo.tsx` (envoi via Brevo - TODO)

**Cl√©s localStorage :**
- LECTURE : `generation_sms_ad`
- √âCRITURE : `key-modifs-creer-campagne-sms`

**Structure JSON compl√®te :**
```json
{
  "restitution-annonce-sms": "VENTE Restaurant 120m¬≤ Paris 8√®me - 80 couverts - 450 000‚Ç¨ FAI - Exclusivit√© - Tel: 01 XX XX XX XX"
}
```

**Format :** Texte brut (160 caract√®res maximum)

**Taille estim√©e :** 0.5-1 KB

**Actions utilisateur :**
- ‚úÖ √âditer le texte SMS
- ‚úÖ Compteur de caract√®res en temps r√©el
- ‚úÖ Personnaliser exp√©diteur, URL, destinataires
- ‚úÖ Copier (format texte)
- ‚ö†Ô∏è **TODO** : Envoyer via Brevo SMS API

**Statut :** ‚ö†Ô∏è **PARTIEL** (Int√©gration Brevo SMS manquante)

---

### Canal 6 : Diffuser Google Business Profile

**Composants :**
- `AccueilDiffuserGoogleAnnonce.tsx`
- `Hook-1-RecuperationDataGoogle.ts` (avec `cleanOpenAIContent()`)
- `Hook-2-PersonnaliserUrlGoogle.tsx` (personnalisation URL)

**Cl√©s localStorage :**
- LECTURE : `generation_googleprofile_ad` + **nettoyage**
- √âCRITURE : `key-modifs-diffuser-google-annonce`

**Structure JSON compl√®te (OpenAI retourne PascalCase) :**
```json
{
  "TitreAnnonceGoogle": "Restaurant Traditionnel Paris 8√®me - Emplacement Premium",
  "AccrocheDescriptiveAnnonceGoogle": "D√©couvrez ce restaurant traditionnel situ√© sur les Champs-√âlys√©es. 80 couverts, cuisine √©quip√©e, client√®le fid√®le.",
  "PointsFortsAnnonceGoogle": "‚úì Emplacement exceptionnel\n‚úì 120 m¬≤ sur 2 niveaux\n‚úì CA 650 000 ‚Ç¨/an\n‚úì Bail 9 ans",
  "CtaAnnonceGoogle": "Contactez-nous pour organiser une visite. Exclusivit√©."
}
```

**‚ö†Ô∏è Mapping vers interface React (camelCase) :**
```typescript
{
  titre: "Restaurant Traditionnel Paris 8√®me - Emplacement Premium",
  accroche: "D√©couvrez ce restaurant traditionnel...",
  pointsForts: "‚úì Emplacement exceptionnel\n‚úì 120 m¬≤...",
  appelAction: "Contactez-nous pour organiser une visite..."
}
```

**Format :** Texte brut + Markdown (`\n` pour retours √† la ligne)

**Taille estim√©e :** 2-3 KB

**Actions utilisateur :**
- ‚úÖ √âditer les 4 champs
- ‚úÖ Personnaliser l'URL de l'annonce
- ‚úÖ Copier (format texte)
- ‚ö†Ô∏è **TODO** : Publier via Zoho Social ou Google My Business API

**Statut :** ‚ö†Ô∏è **PARTIEL** (Int√©gration Zoho Social manquante)

---

### Canal 7 : Diffuser R√©seaux Sociaux

**Composants :**
- `AccueilDiffuserReseauxAnnonce.tsx`
- `Hook-1-RecuperationDataReseaux.ts` (avec `cleanOpenAIContent()`)
- `Hook-2-PersonnaliserUrlReseaux.tsx` (personnalisation URL)

**Cl√©s localStorage :**
- LECTURE : `generation_reseauxsociaux_ad` + **nettoyage**
- √âCRITURE : `key-modifs-diffuser-reseaux-sociaux-annonce`

**Structure JSON compl√®te (OpenAI retourne PascalCase) :**
```json
{
  "TitreAnnonceReseaux": "üçΩÔ∏è OPPORTUNIT√â RARE - Restaurant Paris 8√®me",
  "AccrocheImpactanteAnnonceReseaux": "Vous r√™vez d'investir dans la restauration ? Ne manquez pas cette occasion unique sur les Champs-√âlys√©es !",
  "AtoutsAnnonceReseaux": "üèÜ Emplacement d'exception\nüìç 80 couverts - 2 niveaux\nüí∞ CA 650 000 ‚Ç¨\nüîë Exclusivit√©",
  "CtaAnnonceReseaux": "üëâ Cliquez pour d√©couvrir cette p√©pite !"
}
```

**‚ö†Ô∏è Mapping vers interface React (camelCase) :**
```typescript
{
  titre: "üçΩÔ∏è OPPORTUNIT√â RARE - Restaurant Paris 8√®me",
  accroche: "Vous r√™vez d'investir dans la restauration ?...",
  pointsForts: "üèÜ Emplacement d'exception\nüìç 80 couverts...",
  appelAction: "üëâ Cliquez pour d√©couvrir cette p√©pite !"
}
```

**Format :** Texte brut + Emojis + Markdown (`\n`)

**Taille estim√©e :** 2-3 KB

**Actions utilisateur :**
- ‚úÖ √âditer les 4 champs
- ‚úÖ Personnaliser l'URL de l'annonce
- ‚úÖ Copier (format texte optimis√© r√©seaux sociaux)
- ‚ö†Ô∏è **TODO** : Publier via Zoho Social (Facebook, LinkedIn, Instagram, Twitter)

**Statut :** ‚ö†Ô∏è **PARTIEL** (Int√©gration Zoho Social manquante)

---

### Canal 8 : Cr√©er Landing Page

**Composants :**
- `AccueilCreerLandingPageAnnonce.tsx` (hub)
- `File1.AnnonceLandingPage.tsx` (onglet annonce)
- `File2.SyntheseLandingPage.tsx` (onglet synth√®se)
- `File3.ActionSauvegardeCreerLandingPage.tsx` (onglet actions)
- `HookRecuperationAnnonceVersLandingPage.ts` (donn√©es annonce)
- `HookRecuperationFichedeSyntheseVersLandingPage.ts` (donn√©es synth√®se)
- `HookPublierLandingPage.tsx` (publication - **TODO**)

**Cl√©s localStorage utilis√©es (2 sources) :**
- LECTURE 1 : `generation_website_ad`
- √âCRITURE 1 : `key-modifs-creer-landing-page-annonce`
- LECTURE 2 : `generation_summary_sheet`
- √âCRITURE 2 : `key-modifs-creer-landing-page-synthese`

**Structure JSON compl√®te - SOURCE 1 (Annonce) :**
```json
{
  "titre": "Restaurant Traditionnel - Emplacement Premium Paris 8√®me",
  "accroche": "D√©couvrez cette opportunit√© unique...",
  "descriptif": "Situ√© au c≈ìur du 8√®me arrondissement...",
  "appelAction": "Contactez-nous d√®s aujourd'hui..."
}
```

**Structure JSON compl√®te - SOURCE 2 (Synth√®se) :**
```json
{
  "titre": "Restaurant Traditionnel - Paris 8√®me - 450 000 ‚Ç¨",
  "referenceEtPrix": "R√©f√©rence : COM-75008-REST-001...",
  "detailsCles": "Surface : 120 m¬≤...",
  "donneesFinancieres": "CA annuel : 650 000 ‚Ç¨...",
  "informationsComplementaires": "Client√®le fid√®le..."
}
```

**Format :** HTML complet (combinaison des 2 sources)

**Taille estim√©e :** 5-7 KB (combin√©)

**Actions utilisateur :**
- ‚úÖ √âditer les champs de l'annonce (4 champs)
- ‚úÖ √âditer les champs de la synth√®se (5 champs)
- ‚úÖ Aper√ßu visuel de la landing page
- ‚ö†Ô∏è **TODO** : Sauvegarder la landing page en base de donn√©es
- ‚ö†Ô∏è **TODO** : Publier la landing page (g√©n√©rer URL publique)
- ‚ö†Ô∏è **TODO** : Ajouter gestion des images de la landing page

**Statut :** ‚ùå **INCOMPLET** (Actions de sauvegarde et publication manquantes)

---

### Tableau R√©capitulatif des 8 Canaux

| # | Canal | Cl√©s `generation_*` | Champs JSON | Format | Taille | Actions | Statut |
|---|-------|---------------------|-------------|--------|--------|---------|--------|
| 1 | Copier Annonce Site | `generation_website_ad` | 4 | Texte + HTML | 2-3 KB | ‚úÖ √âditer, Copier, Aper√ßu | ‚úÖ COMPLET |
| 2 | Int√©grer Outils SEO | `generation_seo_tools` | 3 | Texte | 1-2 KB | ‚úÖ √âditer, Copier, Aper√ßu | ‚úÖ COMPLET |
| 3 | Diffuser Portails | `generation_summary_sheet` | 5 | HTML | 3-4 KB | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: API Portails | ‚ö†Ô∏è PARTIEL |
| 4 | Campagne Newsletter | `generation_newsletter` | 5 | HTML | 2-3 KB | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: Brevo | ‚ö†Ô∏è PARTIEL |
| 5 | Campagne SMS | `generation_sms_ad` | 1 | Texte (160 car) | 0.5-1 KB | ‚úÖ √âditer, Copier, Compteur‚ö†Ô∏è TODO: Brevo SMS | ‚ö†Ô∏è PARTIEL |
| 6 | Google Business | `generation_googleprofile_ad` | 4 | Texte + Markdown | 2-3 KB | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: Zoho Social | ‚ö†Ô∏è PARTIEL |
| 7 | R√©seaux Sociaux | `generation_reseauxsociaux_ad` | 4 | Texte + Emoji | 2-3 KB | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: Zoho Social | ‚ö†Ô∏è PARTIEL |
| 8 | Landing Page | `generation_website_ad`+`generation_summary_sheet` | 9 (combin√©) | HTML complet | 5-7 KB | ‚úÖ √âditer, Aper√ßu‚ö†Ô∏è TODO: Sauvegarder DB‚ö†Ô∏è TODO: Publier | ‚ùå INCOMPLET |

**R√©sum√© des statuts :**
- ‚úÖ **2 canaux COMPLETS** (Copier Annonce Site, Int√©grer Outils SEO)
- ‚ö†Ô∏è **5 canaux PARTIELS** (Portails, Newsletter, SMS, Google, R√©seaux)
- ‚ùå **1 canal INCOMPLET** (Landing Page)

---

## IX. PARTIE 6 : SYST√àME D'√âDITION ET DE SAUVEGARDE 

### M√©canisme de Sauvegarde

**D√©clenchement :**
```typescript
// Dans tous les composants d'√©dition (exemple: File1.AnnonceLandingPage.tsx)
const handleChange = (field: keyof AnnonceLandingPageData, value: string) => {
  const newData = {
    ...annonceLandingPage,
    [field]: field === 'titre' ? value.replace(/<[^>]*>/g, '') : value
  };

  updateAnnonceLandingPage(newData); // ‚Üê Sauvegarde IMM√âDIATE

  if (onDataChange) {
    onDataChange(newData);
  }
};
```

**Flux de sauvegarde :**
1. Utilisateur modifie un champ ‚Üí `onChange` event
2. Appel √† `handleChange(field, value)`
3. Appel √† `updateData(newData)` du hook
4. **Sauvegarde IMM√âDIATE** dans `localStorage` (cl√© `key-modifs-*`)
5. Mise √† jour du state React local

**Code dans le hook :**
```typescript
const updateAnnonceLandingPage = (newData: Partial) => {
  const updatedData = { ...annonceLandingPage, ...newData };
  setAnnonceLandingPage(updatedData);

  try {
    // Sauvegarde IMM√âDIATE dans localStorage
    localStorage.setItem('key-modifs-creer-landing-page-annonce', JSON.stringify(updatedData));
  } catch (err) {
    console.error('Erreur lors de la sauvegarde:', err);
    setError('Erreur lors de la sauvegarde des donn√©es');
  }
};
```

### Liste des 12 Cl√©s `key-modifs-*`

| # | Cl√© localStorage | Canal associ√© | Interface | Champs |
|---|------------------|---------------|-----------|--------|
| 1 | `key-modifs-copier-annonce-site-internet` | Copier Annonce Site Internet | `AnnonceSiteInternetData` | titre, accroche, descriptif, appelAction |
| 2 | `key-modifs-integrer-outils-seo` | Int√©grer Outils SEO | `OutilsSEOData` | baliseTitre, baliseMetaDescription, urlLongueTraine |
| 3 | `key-modifs-diffuser-portails-immobiliers` | Diffuser Portails Immobiliers | `AnnonceFichedeSyntheseData` | titre, referenceEtPrix, detailsCles, donneesFinancieres, informationsComplementaires |
| 4 | `key-modifs-creer-campagne-newsletter` | Cr√©er Campagne Newsletter | `AnnonceNewsletterData` | titre, accroche, pointsForts, callToAction, prixEtReference |
| 5 | `key-modifs-creer-campagne-sms` | Cr√©er Campagne SMS | `AnnonceSMSData` | restitution-annonce-sms |
| 6 | `key-modifs-diffuser-google-annonce` | Diffuser Google Business Profile | `AnnonceGoogleData` | titre, accroche, pointsForts, appelAction |
| 7 | `key-modifs-diffuser-reseaux-sociaux-annonce` | Diffuser R√©seaux Sociaux | `AnnonceReseauxData` | titre, accroche, pointsForts, appelAction |
| 8 | `key-modifs-creer-landing-page-annonce` | Landing Page - Annonce | `AnnonceLandingPageData` | titre, accroche, descriptif, appelAction |
| 9 | `key-modifs-creer-landing-page-synthese` | Landing Page - Synth√®se | `FichedeSyntheseLandingPageData` | titre, referenceEtPrix, detailsCles, donneesFinancieres, informationsComplementaires |
| 10 | `key-modifs-expediteur-campagne-sms` | Cr√©er Campagne SMS - Exp√©diteur | `PersonnaliserSMSData` | expediteur |
| 11 | `key-modifs-url-annonce-campagne-sms` | Cr√©er Campagne SMS - URL | `PersonnaliserSMSData` | urlAnnonce |
| 12 | `key-modifs-destinataires-campagne-sms` | Cr√©er Campagne SMS - Destinataires | `PersonnaliserSMSData` | destinataires |

**Note :** Les cl√©s 10-12 sont utilis√©es pour les champs de personnalisation de la campagne SMS (exp√©diteur, URL, destinataires), s√©par√©s du contenu de l'annonce SMS elle-m√™me.

### Logique de Priorit√© de Lecture

**Ordre de priorit√© dans tous les hooks :**

```typescript
useEffect(() => {
  try {
    setIsLoading(true);

    // PRIORIT√â 1 : V√©rifier les donn√©es modifi√©es
    const modifiedDataJson = localStorage.getItem('key-modifs-XXX');

    if (modifiedDataJson) {
      // ‚úÖ Utiliser les donn√©es modifi√©es par l'utilisateur
      const modifiedData = JSON.parse(modifiedDataJson);
      setData(modifiedData);
    } else {
      // PRIORIT√â 2 : R√©cup√©ration des donn√©es originales OpenAI
      const generationData = localStorage.getItem('generation_XXX');

      if (generationData) {
        // ‚úÖ Utiliser les donn√©es originales OpenAI
        const parsedData = JSON.parse(generationData);
        setData(parsedData);
      } else {
        // PRIORIT√â 3 : Valeurs par d√©faut (vides)
        console.log('Aucune donn√©e trouv√©e');
      }
    }

    setIsLoading(false);
  } catch (err) {
    console.error('Erreur:', err);
    setError('Erreur lors de la r√©cup√©ration');
    setIsLoading(false);
  }
}, []);
```

**Sch√©ma de d√©cision :**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ key-modifs-* existe ?           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ OUI           ‚îÇ NON
    ‚ñº               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Utiliser  ‚îÇ   ‚îÇ generation_*     ‚îÇ
‚îÇ key-modifs‚îÇ   ‚îÇ existe ?         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ OUI     ‚îÇ NON
                ‚ñº         ‚ñº
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇUtiliser‚îÇ ‚îÇ Valeurs  ‚îÇ
            ‚îÇgener...‚îÇ ‚îÇ vides    ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Persistance des Donn√©es

**Dur√©e de vie :**
- Les donn√©es restent dans `localStorage` **ind√©finiment**
- Seul `localStorage.clear()` (bouton "Nouveau Projet") efface les donn√©es
- Aucune expiration automatique
- Pas de limite de taille (sauf limite navigateur ~5-10 MB)

**Comportement multi-onglets :**
- `localStorage` est **partag√©** entre tous les onglets du m√™me domaine
- Les modifications dans un onglet sont visibles dans les autres (apr√®s rechargement)
- Pas de syst√®me de synchronisation en temps r√©el entre onglets

---

## X. PARTIE 7 : BOUTON "G√âN√âRER UN NOUVEAU PROJET" 

### Fichiers Concern√©s

| Fichier | R√¥le |
|---------|------|
| `src/components/1-Sources-Generation-Annonces/utils/useBoutonGenerationNewProjet.tsx` | Hook principal avec logique de confirmation et de nettoyage |
| `src/components/1-Sources-Restitution-Utilisateur/Utilitaires/GestionComportementBoutonNouveauProjet/1.BoutonNouveauProjetPageEtape6Communication.tsx` | Composant bouton affich√© dans √âtape 6 |

### Code Complet du Hook

```typescript
// useBoutonGenerationNewProjet.tsx
import { useNavigate } from 'react-router-dom';
import { useToast } from '@/hooks/use-toast';

export const useBoutonGenerationNewProjet = () => {
  const navigate = useNavigate();
  const { toast } = useToast();

  const handleConfirmNewProject = () => {
    // ‚ö†Ô∏è EFFACE TOUTES LES CL√âS LOCALSTORAGE
    localStorage.clear();

    // Affichage du toast de confirmation
    toast({
      title: "Nouveau projet cr√©√©",
      description: "Les donn√©es du projet pr√©c√©dent ont √©t√© effac√©es.",
      duration: 3000,
    });

    // Navigation vers l'√âtape 1
    navigate('/etape1');

    // ‚ö†Ô∏è RECHARGEMENT COMPLET DE L'APPLICATION
    // ‚Üí Perte de tout l'√©tat React
    window.location.reload();
  };

  return { handleConfirmNewProject };
};
```

### Fonction `handleConfirmNewProject()` - Analyse D√©taill√©e

**Ligne 12 : `localStorage.clear()`**
- Efface **TOUTES** les cl√©s `localStorage` de l'application
- Pas de suppression s√©lective
- Impact : 
  - ‚úÖ Les 14 champs `propertyData` sont effac√©s
  - ‚úÖ Les 7 cl√©s `generation_*` sont effac√©es
  - ‚úÖ Les 12 cl√©s `key-modifs-*` sont effac√©es
  - ‚úÖ `generation_status` effac√©
  - ‚úÖ Progression des √©tapes effac√©e
  - ‚ö†Ô∏è **AUSSI** : Toutes les autres donn√©es `localStorage` (authentification, pr√©f√©rences utilisateur, etc.)

**Lignes 15-19 : Affichage du toast**
- Toast de confirmation avec dur√©e 3 secondes
- Titre : "Nouveau projet cr√©√©"
- Description : "Les donn√©es du projet pr√©c√©dent ont √©t√© effac√©es."

**Ligne 22 : `navigate('/etape1')`**
- Navigation React Router vers l'√âtape 1
- Changement de route **sans rechargement** (dans un premier temps)

**Ligne 25 : `window.location.reload()`**
- **Rechargement complet de l'application**
- Perte de tout l'√©tat React (tous les `useState`, `useEffect`, etc.)
- Rechargement de tous les fichiers JavaScript, CSS
- **Comportement** : L'utilisateur voit un flash blanc, puis la page √âtape 1 se recharge enti√®rement

### Cl√©s `localStorage` Effac√©es

**Cat√©gorie 1 : Donn√©es utilisateur (propertyData) - 14 cl√©s**
```
propertyType
agencyName
location
commercialAssets
price
rent
surface
details
reference
priceDpe
energyDpe
dateAvailability
isExclusive
```

**Cat√©gorie 2 : Progression**
```
generation_status
current_step
session_start_time
```

**Cat√©gorie 3 : G√©n√©rations OpenAI - 7 cl√©s**
```
generation_website_ad
generation_summary_sheet
generation_newsletter
generation_seo_tools
generation_sms_ad
generation_googleprofile_ad
generation_reseauxsociaux_ad
```

**Cat√©gorie 4 : Modifications utilisateur - 12 cl√©s**
```
key-modifs-copier-annonce-site-internet
key-modifs-integrer-outils-seo
key-modifs-diffuser-portails-immobiliers
key-modifs-creer-campagne-newsletter
key-modifs-creer-campagne-sms
key-modifs-diffuser-google-annonce
key-modifs-diffuser-reseaux-sociaux-annonce
key-modifs-creer-landing-page-annonce
key-modifs-creer-landing-page-synthese
key-modifs-expediteur-campagne-sms
key-modifs-url-annonce-campagne-sms
key-modifs-destinataires-campagne-sms
```

**Total : ~32-35 cl√©s effac√©es**

### Bo√Æte de Dialogue de Confirmation

**Code du composant `1.BoutonNouveauProjetPageEtape6Communication.tsx` :**

```typescript

      Nouveau Projet

        √ätes-vous s√ªr de vouloir g√©n√©rer un nouveau projet ?

        Cette action supprimera toutes les donn√©es saisies du projet en cours. 
        Cette action est irr√©versible.

      Annuler

        Continuer

```

**Textes affich√©s :**
- **Titre** : "√ätes-vous s√ªr de vouloir g√©n√©rer un nouveau projet ?"
- **Description** : "Cette action supprimera toutes les donn√©es saisies du projet en cours. Cette action est irr√©versible."
- **Boutons** :
  - "Annuler" ‚Üí Ferme la bo√Æte de dialogue
  - "Continuer" ‚Üí D√©clenche `handleConfirmNewProject()`

### Comportement de Redirection

**Flux complet :**
```
1. Utilisateur clique "Nouveau Projet"
   ‚Üì
2. Bo√Æte de dialogue de confirmation s'affiche
   ‚Üì
3. Utilisateur clique "Continuer"
   ‚Üì
4. localStorage.clear() ‚Üí Efface TOUT
   ‚Üì
5. Toast de confirmation affich√© (3 secondes)
   ‚Üì
6. navigate('/etape1') ‚Üí Changement de route React
   ‚Üì
7. window.location.reload() ‚Üí Rechargement complet
   ‚Üì
8. Application red√©marre sur √âtape 1
   ‚Üì
9. Tous les hooks r√©cup√®rent des valeurs vides
   ‚Üì
10. Utilisateur voit un formulaire vierge
```

**‚ö†Ô∏è Remarque importante :**
Le `window.location.reload()` annule le `navigate('/etape1')` en cours, car le rechargement complet prend le dessus. L'utilisateur arrive bien sur `/etape1`, mais c'est le r√©sultat du rechargement de la page, pas de la navigation React Router.

---

## XI. PARTIE 8 : D√âTAIL COMPLET DU SERVICE `src/services/openai` 

### A. Fichier Principal : `src/services/openai.ts`

#### Interfaces OpenAI (lignes 40-64)

```typescript
interface OpenAIMessage {
  role: 'system' | 'user' | 'assistant';
  content: string;
}

interface OpenAICompletionRequest {
  model: string;
  messages: OpenAIMessage[];
  temperature?: number;
  max_tokens?: number;
}

interface OpenAICompletionResponse {
  choices: Array<{
    message: {
      content: string;
    };
  }>;
}
```

#### Interface PropertyData (lignes 70-92)

**14 champs d√©taill√©s :**

```typescript
export interface PropertyData {
  propertyType: string;          // Type de bien (ex: "Restaurant")
  agencyName: string;             // Nom de l'agence
  location: string;               // Localisation (ex: "Paris 8√®me")
  commercialAssets: string;       // Actifs commerciaux
  price?: string;                 // Prix de vente (optionnel)
  rent?: string;                  // Loyer (optionnel)
  surface?: string;               // Surface (ex: "120 m¬≤")
  details?: string;               // D√©tails suppl√©mentaires
  reference?: string;             // R√©f√©rence du bien
  priceDpe?: string;              // DPE prix
  energyDpe?: string;             // DPE √©nergie
  dateAvailability?: string;      // Date de disponibilit√©
  isExclusive?: boolean;          // Exclusivit√© (true/false)
}
```

**Utilisation dans les prompts :**
- Les champs sont inject√©s dans les prompts OpenAI via des placeholders
- Format d'injection : `${data.propertyType}`, `${data.agencyName}`, etc.
- Exemple de prompt final : 
  ```
  "Type de bien : Restaurant
   Nom de l'agence : Presenca Immo
   Localisation : Paris 8√®me
   ..."
  ```

#### Classe OpenAIService (lignes 97-333)

**1. Constructeur**
```typescript
constructor(private apiKey: string) {
  if (!apiKey) {
    throw new Error('OpenAI API key is required');
  }
}
```

**2. M√©thode `createChatCompletion()`**
```typescript
private async createChatCompletion(params: OpenAICompletionRequest): Promise {
  const response = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${this.apiKey}`
    },
    body: JSON.stringify(params)
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(`OpenAI API error: ${JSON.stringify(error)}`);
  }

  return response.json();
}
```

**3. M√©thode g√©n√©rique `generateResponse()`**
```typescript
private async generateResponse(
  prompt: string,
  model: string = "gpt-4o",
  systemPrompt?: string
): Promise {
  const messages: OpenAIMessage[] = [];

  if (systemPrompt) {
    messages.push({ role: 'system', content: systemPrompt });
  }

  messages.push({ role: 'user', content: prompt });

  const response = await this.createChatCompletion({
    model,
    messages,
    temperature: 0.7,
    max_tokens: 2000
  });

  return response.choices[0].message.content;
}
```

**4. M√©thode `generateWebsiteAd()` - Annonce Site Internet**
```typescript
async generateWebsiteAd(data: PropertyData, model: string = "gpt-4o"): Promise<{
  titre: string;
  accroche: string;
  descriptif: string;
  cta: string;
}> {
  const userPrompt = `
    Type de bien : ${data.propertyType}
    Nom de l'agence : ${data.agencyName}
    Localisation : ${data.location}
    Actifs commerciaux : ${data.commercialAssets}
    ${data.price ? `Prix : ${data.price}` : ''}
    ${data.rent ? `Loyer : ${data.rent}` : ''}
    ${data.surface ? `Surface : ${data.surface}` : ''}
    ${data.details ? `D√©tails : ${data.details}` : ''}
    ${data.reference ? `R√©f√©rence : ${data.reference}` : ''}
    ${data.isExclusive ? 'Exclusivit√©' : ''}
  `;

  const response = await this.generateResponse(userPrompt, model, promptAnnonceSiteInternet);

  try {
    return JSON.parse(response);
  } catch (error) {
    console.error('Error parsing OpenAI response:', error);
    throw new Error('Failed to parse OpenAI response');
  }
}
```

**5. M√©thode `generateSummarySheetAd()` - Fiche de Synth√®se**
```typescript
async generateSummarySheetAd(data: PropertyData, model: string = "gpt-4o"): Promise<{
  titre: string;
  referenceEtPrix: string;
  detailsCles: string;
  donneesFinancieres: string;
  informationsComplementaires: string;
}> {
  // Structure identique √† generateWebsiteAd()
  // Prompt : promptAnnonceFichedeSynthese
}
```

**6. M√©thode `generateNewsletterAd()` - Newsletter**
```typescript
async generateNewsletterAd(data: PropertyData, model: string = "gpt-4o"): Promise<{
  titre: string;
  accroche: string;
  pointsForts: string;
  callToAction: string;
  prixEtReference: string;
}> {
  // Structure identique
  // Prompt : promptAnnonceNewsletter
}
```

**7. M√©thode `generateSEOTools()` - Outils SEO**
```typescript
async generateSEOTools(data: PropertyData, model: string = "gpt-4o"): Promise<{
  baliseTitre: string;
  baliseMetaDescription: string;
  urlLongueTraine: string;
}> {
  // Structure identique
  // Prompt : promptOutilsSEO
}
```

#### Fonctions Utilitaires (lignes 338-372)

**1. `getPropertyDataFromStorage()`**
```typescript
export const getPropertyDataFromStorage = (): PropertyData | null => {
  try {
    const data = localStorage.getItem('propertyData');
    return data ? JSON.parse(data) : null;
  } catch (error) {
    console.error('Error reading property data:', error);
    return null;
  }
};
```

**2. `updatePropertyData()`**
```typescript
export const updatePropertyData = (newData: Partial): void => {
  try {
    const currentData = getPropertyDataFromStorage() || {};
    const updatedData = { ...currentData, ...newData };
    localStorage.setItem('propertyData', JSON.stringify(updatedData));
  } catch (error) {
    console.error('Error updating property data:', error);
  }
};
```

**3. `clearPropertyData()`**
```typescript
export const clearPropertyData = (): void => {
  try {
    localStorage.removeItem('propertyData');
  } catch (error) {
    console.error('Error clearing property data:', error);
  }
};
```

**4. `createOpenAIService()` - Factory**
```typescript
export const createOpenAIService = (apiKey: string): OpenAIService => {
  return new OpenAIService(apiKey);
};
```

---

### B. Services Additionnels

#### 1. Service SMS

**Fichier :** `src/services/openai/1.GenerateurAnnoncesOutilsSeo/0.APIAutresFonctionsLeadGenAI/1.API-AnnonceSMS.ts`

**Classe :** `OpenAISMSService`

**Assistant ID :** `asst_TdAq1QLpBVlEOwjAm2fLSy4U`

**M√©thode principale :**
```typescript
async generateSMSAd(data: PropertyData, model: string = "gpt-4o"): Promise<{
  "restitution-annonce-sms": string;
}> {
  // 1. Cr√©er un thread
  const thread = await this.createThread();

  // 2. Ajouter le message utilisateur
  await this.addMessage(thread.id, userPrompt);

  // 3. Ex√©cuter l'assistant
  const run = await this.runAssistant(thread.id);

  // 4. Attendre la compl√©tion
  await this.waitForCompletion(thread.id, run.id);

  // 5. R√©cup√©rer les messages
  const messages = await this.getMessages(thread.id);

  // 6. Nettoyer les backticks markdown
  let cleanedMessage = message;
  if (cleanedMessage.startsWith('```')) {
    cleanedMessage = cleanedMessage.replace(/^```[\s\S]*?\n/, '').replace(/\n```$/, '');
  }

  return JSON.parse(cleanedMessage);
}
```

**Factory :**
```typescript
export const createOpenAISMSService = (apiKey: string): OpenAISMSService => {
  return new OpenAISMSService(apiKey);
};
```

---

#### 2. Service Google Business Profile

**Fichier :** `2.API-AnnonceGoogleBusinessProfile.ts`

**Classe :** `OpenAIGoogleBusinessProfileService`

**Assistant ID :** `asst_ON4cwe282z5TH89uY8lhvZP5`

**M√©thode principale :**
```typescript
async generateGoogleBusinessProfileAd(data: PropertyData, model: string = "gpt-4o"): Promise<{
  TitreAnnonceGoogle: string;
  AccrocheDescriptiveAnnonceGoogle: string;
  PointsFortsAnnonceGoogle: string;
  CtaAnnonceGoogle: string;
}> {
  // Structure identique au Service SMS
  // Utilise l'API OpenAI Assistants
  // Nettoyage des backticks markdown appliqu√©
}
```

**Factory :**
```typescript
export const createOpenAIGoogleBusinessProfileService = (apiKey: string) => {
  return new OpenAIGoogleBusinessProfileService(apiKey);
};
```

---

#### 3. Service R√©seaux Sociaux

**Fichier :** `3.API-AnnonceReseauxSociaux.ts`

**Classe :** `OpenAIReseauxSociauxService`

**Assistant ID :** `asst_XL1EVDiLq6jUzfrvdJUy4bey`

**M√©thode principale :**
```typescript
async generateReseauxSociauxAd(data: PropertyData, model: string = "gpt-4o"): Promise<{
  TitreAnnonceReseaux: string;
  AccrocheImpactanteAnnonceReseaux: string;
  AtoutsAnnonceReseaux: string;
  CtaAnnonceReseaux: string;
}> {
  // Structure identique aux autres services Assistants
  // MAIS : Pas de nettoyage des backticks (parse direct du JSON)
}
```

**Factory :**
```typescript
export const createOpenAIReseauxSociauxService = (apiKey: string) => {
  return new OpenAIReseauxSociauxService(apiKey);
};
```

---

### C. D√©tail des 7 Prompts OpenAI

#### Prompt 1 : Annonce Site Internet

**Fichier :** `1.PromptAnnonceSiteInternet.ts`

**Longueur :** 116 lignes

**Structure du prompt :**

```typescript
export const promptAnnonceSiteInternet = `
Tu es LeadGenAI AdBuilder, une IA sp√©cialis√©e en marketing pour l'immobilier commercial.

MISSION :
√âcrire une "Annonce Site Internet" professionnelle pour un bien immobilier commercial.

R√àGLES STRICTES :
1. Utiliser UNIQUEMENT les donn√©es fournies
2. Ne JAMAIS inventer d'informations
3. √âviter les termes interdits : "id√©al", "parfait", "exceptionnel" (sauf si dans les donn√©es)
4. Phrases courtes (max 20 mots)
5. Si exclusivit√© ‚Üí mentionner √† la fin

STRUCTURE OBLIGATOIRE :
1. TITRE (H2) :
   - SEO optimis√©
   - Max 60 caract√®res
   - Format : [Type de bien] - [Localisation] - [Caract√©ristique principale]

2. ACCROCHE :
   - 2-3 phrases impactantes
   - Mettre en avant l'opportunit√©

3. DESCRIPTIF :
   - 3-4 paragraphes
   - D√©tails cl√©s : surface, √©quipement, emplacement
   - Format HTML avec balises 

4. APPEL √Ä L'ACTION (CTA) :
   - Phrase incitant √† l'action
   - Mentionner exclusivit√© si applicable

FORMAT DE SORTIE JSON OBLIGATOIRE :
{
  "titre": "...",
  "accroche": "...",
  "descriptif": "......",
  "cta": "..."
}
`;
```

**Contraintes SEO :**
- Titre : max 60 caract√®res
- Inclure mots-cl√©s principaux (type de bien + localisation)
- Meta description : max 160 caract√®res (si applicable)

---

#### Prompt 2 : Fiche de Synth√®se

**Fichier :** `2.PromptAnnonceFichedeSynthese.ts`

**Longueur :** 125 lignes

**Structure du prompt :**

```typescript
export const promptAnnonceFichedeSynthese = `
Tu es LeadGenAI AdBuilder, sp√©cialis√© en immobilier commercial.

MISSION :
√âcrire une "Fiche de Synth√®se" structur√©e et professionnelle.

R√àGLES STRICTES :
1. Analyser et organiser les informations
2. Utiliser UNIQUEMENT les donn√©es fournies
3. Format : PARAGRAPHES uniquement (PAS de bullet points)
4. √âviter les superlatifs non justifi√©s

STRUCTURE OBLIGATOIRE :
1. TITRE (H2) :
   - Format : [Type de bien] - [Localisation] - [Prix/Loyer]
   - SEO optimis√©

2. R√âF√âRENCE ET PRIX :
   - R√©f√©rence du bien
   - Prix de vente OU loyer (avec p√©riodicit√©)
   - Format HTML : R√©f√©rence : ...

3. PR√âSENTATION DU BIEN :
   a) D√âTAILS CL√âS :
      - Surface
      - Caract√©ristiques principales
      - Emplacement
      - Format HTML avec 

   b) DONN√âES FINANCI√àRES :
      - CA annuel (si fourni)
      - Loyer (si location)
      - Bail
      - Format HTML : ...

   c) INFORMATIONS COMPL√âMENTAIRES :
      - Autres d√©tails pertinents
      - Exclusivit√© (si applicable)

FORMAT DE SORTIE JSON :
{
  "titre": "...",
  "referenceEtPrix": "...",
  "detailsCles": "...",
  "donneesFinancieres": "...",
  "informationsComplementaires": "..."
}
`;
```

**Particularit√© :**
- Format HTML plus structur√© que l'annonce site internet
- Utilisation de ``, ``, ``, ``

---

#### Prompt 3 : Newsletter

**Fichier :** `3.PromptAnnonceNewsletter.ts`

**Longueur :** 152 lignes

**Structure du prompt :**

```typescript
export const promptAnnonceNewsletter = `
Tu es LeadGenAI AdBuilder, expert en communication par email.

MISSION :
√âcrire une "Annonce Newsletter" engageante pour un email marketing.

R√àGLES STRICTES :
1. Ton professionnel mais chaleureux
2. Structurer l'information de mani√®re claire
3. Utiliser des balises HTML compatibles email
4. Bullet points obligatoires pour les points forts

STRUCTURE OBLIGATOIRE :
1. TITRE :
   - Accrocheur et clair
   - Max 70 caract√®res

2. ACCROCHE :
   - Introduction engageante
   - 2-3 phrases
   - Format HTML : ...

3. POINTS FORTS :
   - Liste √† puces (3-5 points)
   - Format HTML : Titre : Description

4. CALL TO ACTION :
   - Phrase incitant √† l'action
   - Format HTML : ...

5. PRIX ET R√âF√âRENCE :
   - R√©capitulatif en fin d'email
   - Format HTML : Prix : ... | R√©f : ...

FORMAT DE SORTIE JSON :
{
  "titre": "...",
  "accroche": "...",
  "pointsForts": "...",
  "callToAction": "...",
  "prixEtReference": "..."
}
`;
```

**Contraintes HTML :**
- Utiliser uniquement des balises compatibles email : ``, ``, ``, ``
- √âviter les ``, ``, CSS inline complexe

---

#### Prompt 4 : Outils SEO

**Fichier :** `4.PromptOutilsSEO.ts`

**Longueur :** 83 lignes

**Structure du prompt :**

```typescript
export const promptOutilsSEO = `
Tu es LeadGenAI AdBuilder, expert en r√©f√©rencement SEO.

MISSION :
G√©n√©rer 3 outils SEO optimis√©s :
1. Balise Titre (Title Tag)
2. Balise Meta Description
3. URL Longue Tra√Æne

R√àGLES STRICTES :
1. BALISE TITRE :
   - Max 60 caract√®res
   - Inclure : Type de bien + Localisation + Caract√©ristique principale
   - Format : [Type] - [Lieu] - [Caract√©ristique] - [Prix]

2. BALISE META DESCRIPTION :
   - Max 160 caract√®res
   - R√©sum√© engageant avec mots-cl√©s
   - Inclure prix/loyer et exclusivit√© si applicable

3. URL LONGUE TRA√éNE :
   - Format : mots-cl√©s s√©par√©s par des tirets
   - Minuscules uniquement
   - Pas d'accents, pas d'espaces
   - Format : type-bien-action-localisation-caracteristiques-prix
   - Exemple : restaurant-vente-paris-8eme-80-couverts-450000-euros

FORMAT DE SORTIE JSON :
{
  "baliseTitre": "...",
  "baliseMetaDescription": "...",
  "urlLongueTraine": "..."
}
`;
```

**Contraintes SEO :**
- Balise Titre : 50-60 caract√®res (optimal)
- Meta Description : 150-160 caract√®res (optimal)
- URL : kebab-case, sans caract√®res sp√©ciaux

---

#### Prompt 5 : SMS

**Fichier :** `5.PromptSMSAnnonce.ts`

**Longueur :** 220 lignes

**Structure du prompt :**

```typescript
export const promptSMSAnnonce = `
Tu es LeadGenAI AdBuilder, expert en marketing SMS.

MISSION :
√âcrire une "Annonce SMS" ultra-concise et impactante.

R√àGLES STRICTES :
1. MAX 160 CARACT√àRES (espaces inclus)
2. Format : [ACTION] [Type] [Surface] [Lieu] - [Caract√©ristique] - [Prix] - [Contact]
3. Utiliser des abr√©viations intelligentes :
   - m¬≤ au lieu de m√®tres carr√©s
   - Tel: au lieu de T√©l√©phone
   - Ref: au lieu de R√©f√©rence
4. Si exclusivit√© ‚Üí "Exclusivit√©" en fin de message
5. Si vente ‚Üí Prix en ‚Ç¨ FAI
6. Si location ‚Üí Loyer en ‚Ç¨/mois HT ou ‚Ç¨/mois CC

STRUCTURE SMS :
[ACTION] [Type de bien] [Surface] [Localisation] - [Points cl√©s] - [Prix/Loyer] - [Exclusivit√©] - [Contact]

EXEMPLES :
- VENTE Restaurant 120m¬≤ Paris 8√®me - 80 couverts - 450 000‚Ç¨ FAI - Exclusivit√© - Tel: 01 XX XX XX XX
- LOCATION Local commercial 200m¬≤ Lyon 2√®me - 1 500‚Ç¨/mois HT - Tel: 04 XX XX XX XX

FORMAT DE SORTIE JSON :
{
  "restitution-annonce-sms": "..."
}
`;
```

**Contraintes SMS :**
- Limite stricte : 160 caract√®res
- Abr√©viations obligatoires pour gagner de l'espace
- Ordre d'importance : Action > Type > Surface > Lieu > Prix > Contact

---

#### Prompt 6 : Google Business Profile

**Fichier :** `6.PromptGoogleBusinessProfileAnnonce.ts`

**Longueur :** ~180 lignes (estim√©)

**Structure du prompt :**

```typescript
export const promptGoogleBusinessProfileAnnonce = `
Tu es LeadGenAI AdBuilder, expert en marketing Google My Business.

MISSION :
√âcrire une "Annonce Google Business Profile" optimis√©e pour les r√©sultats locaux.

R√àGLES STRICTES :
1. Titre : Max 58 caract√®res (troncature Google)
2. Accroche : 2-3 phrases engageantes
3. Points forts : Format liste √† puces avec emojis/symboles
4. CTA : Phrase d'action claire

STRUCTURE OBLIGATOIRE :
1. TITRE :
   - Format : [Type de bien] [Localisation] - [Caract√©ristique principale]
   - SEO local optimis√©

2. ACCROCHE DESCRIPTIVE :
   - 2-3 phrases
   - Mettre en avant l'emplacement et les atouts

3. POINTS FORTS :
   - 3-5 points cl√©s
   - Format : ‚úì Point 1\n‚úì Point 2\n...
   - Utiliser symboles (‚úì, ‚óè, ‚Üí)

4. CALL TO ACTION :
   - Phrase incitant √† contacter
   - Mentionner exclusivit√© si applicable

FORMAT DE SORTIE JSON :
{
  "TitreAnnonceGoogle": "...",
  "AccrocheDescriptiveAnnonceGoogle": "...",
  "PointsFortsAnnonceGoogle": "...",
  "CtaAnnonceGoogle": "..."
}
`;
```

**‚ö†Ô∏è Nommage PascalCase :**
Les cl√©s JSON sont en PascalCase (impos√© par le prompt OpenAI).

---

#### Prompt 7 : R√©seaux Sociaux

**Fichier :** `7.PromptReseauxSociauxAnnonce.ts`

**Longueur :** ~200 lignes (estim√©)

**Structure du prompt :**

```typescript
export const promptReseauxSociauxAnnonce = `
Tu es LeadGenAI AdBuilder, expert en marketing sur les r√©seaux sociaux.

MISSION :
√âcrire une "Annonce R√©seaux Sociaux" engageante et virale.

R√àGLES STRICTES :
1. Utiliser des emojis pertinents
2. Ton dynamique et impactant
3. Hashtags √† la fin (optionnel)
4. Format adapt√© √† Facebook, LinkedIn, Instagram

STRUCTURE OBLIGATOIRE :
1. TITRE :
   - Accrocheur avec emoji
   - Format : [Emoji] [Accroche] - [Type de bien] [Lieu]
   - Exemple : üçΩÔ∏è OPPORTUNIT√â RARE - Restaurant Paris 8√®me

2. ACCROCHE IMPACTANTE :
   - Question ou affirmation forte
   - Susciter l'engagement

3. ATOUTS :
   - 3-5 points cl√©s avec emojis
   - Format : üèÜ Atout 1\nüìç Atout 2\n...

4. CALL TO ACTION :
   - Phrase incitant √† cliquer/contacter
   - Utiliser emoji üëâ ou üìû

FORMAT DE SORTIE JSON :
{
  "TitreAnnonceReseaux": "...",
  "AccrocheImpactanteAnnonceReseaux": "...",
  "AtoutsAnnonceReseaux": "...",
  "CtaAnnonceReseaux": "..."
}
`;
```

**Particularit√©s :**
- Emojis obligatoires pour l'engagement
- Hashtags optionnels (non inclus dans la structure actuelle)
- Nommage PascalCase

---

### Tableau R√©capitulatif des Prompts

| # | Prompt | Fichier | Lignes | Structure JSON | Contraintes principales |
|---|--------|---------|--------|----------------|------------------------|
| 1 | Annonce Site Internet | `1.PromptAnnonceSiteInternet.ts` | 116 | 4 champs | Titre 60 car, HTML `` |
| 2 | Fiche de Synth√®se | `2.PromptAnnonceFichedeSynthese.ts` | 125 | 5 champs | HTML structur√© `` |
| 3 | Newsletter | `3.PromptAnnonceNewsletter.ts` | 152 | 5 champs | HTML email, bullet points |
| 4 | Outils SEO | `4.PromptOutilsSEO.ts` | 83 | 3 champs | Titre 60 car, Meta 160 car, URL kebab-case |
| 5 | SMS | `5.PromptSMSAnnonce.ts` | 220 | 1 champ | Max 160 caract√®res, abr√©viations |
| 6 | Google Business Profile | `6.PromptGoogleBusinessProfileAnnonce.ts` | ~180 | 4 champs (PascalCase) | Titre 58 car, symboles ‚úì |
| 7 | R√©seaux Sociaux | `7.PromptReseauxSociauxAnnonce.ts` | ~200 | 4 champs (PascalCase) | Emojis obligatoires |

---

## XII. PARTIE 9 : MAPPING COMPLET SERVICES ‚Üí CANAUX ‚Üí ACTIONS 

### Tableau 1 : Services OpenAI ‚Üí Cl√©s localStorage ‚Üí Canaux

| Service OpenAI | Cl√© `generation_*` | Canal(s) utilisateur | Actions disponibles | Statut |
|----------------|-------------------|----------------------|---------------------|--------|
| Annonce Site Internet | `generation_website_ad` | 1. Copier Annonce Site Internet8. Cr√©er Landing Page | ‚úÖ √âditer, Copier, Aper√ßu | ‚úÖ COMPLET |
| Fiche de Synth√®se | `generation_summary_sheet` | 3. Diffuser Portails Immobiliers8. Cr√©er Landing Page | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: API Portails | ‚ö†Ô∏è PARTIEL |
| Newsletter | `generation_newsletter` | 4. Cr√©er Campagne Newsletter | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: Brevo | ‚ö†Ô∏è PARTIEL |
| Outils SEO | `generation_seo_tools` | 2. Int√©grer Outils SEO | ‚úÖ √âditer, Copier, Aper√ßu | ‚úÖ COMPLET |
| Annonce SMS | `generation_sms_ad` | 5. Cr√©er Campagne SMS | ‚úÖ √âditer, Copier, Compteur‚ö†Ô∏è TODO: Brevo SMS | ‚ö†Ô∏è PARTIEL |
| Google Business Profile | `generation_googleprofile_ad` | 6. Diffuser Google Business Profile | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: Zoho Social | ‚ö†Ô∏è PARTIEL |
| R√©seaux Sociaux | `generation_reseauxsociaux_ad` | 7. Diffuser R√©seaux Sociaux | ‚úÖ √âditer, Copier, Aper√ßu‚ö†Ô∏è TODO: Zoho Social | ‚ö†Ô∏è PARTIEL |

---

### Tableau 2 : Matrice Canaux √ó localStorage (Lecture/√âcriture)

| Canal | Cl√©s LUES | Cl√©s √âCRITES | Nettoyage | Mapping |
|-------|-----------|--------------|-----------|---------|
| **1. Copier Annonce Site** | `key-modifs-copier-annonce-site-internet` ‚Üí `generation_website_ad` | `key-modifs-copier-annonce-site-internet` | Non | `cta ‚Üí appelAction` |
| **2. Int√©grer Outils SEO** | `key-modifs-integrer-outils-seo` ‚Üí `generation_seo_tools` | `key-modifs-integrer-outils-seo` | Non | Non |
| **3. Diffuser Portails** | `key-modifs-diffuser-portails-immobiliers` ‚Üí `generation_summary_sheet` | `key-modifs-diffuser-portails-immobiliers` | Non | Non |
| **4. Campagne Newsletter** | `key-modifs-creer-campagne-newsletter` ‚Üí `generation_newsletter` | `key-modifs-creer-campagne-newsletter` | Non | Non |
| **5. Campagne SMS** | `key-modifs-creer-campagne-sms` ‚Üí `generation_sms_ad` | `key-modifs-creer-campagne-sms` | Non | Non |
| **6. Google Business** | `key-modifs-diffuser-google-annonce` ‚Üí `generation_googleprofile_ad` | `key-modifs-diffuser-google-annonce` | **Oui** (`cleanOpenAIContent()`) | **Oui** (PascalCase ‚Üí camelCase) |
| **7. R√©seaux Sociaux** | `key-modifs-diffuser-reseaux-sociaux-annonce` ‚Üí `generation_reseauxsociaux_ad` | `key-modifs-diffuser-reseaux-sociaux-annonce` | **Oui** (`cleanOpenAIContent()`) | **Oui** (PascalCase ‚Üí camelCase) |
| **8. Landing Page - Annonce** | `key-modifs-creer-landing-page-annonce` ‚Üí `generation_website_ad` | `key-modifs-creer-landing-page-annonce` | Non | `cta ‚Üí appelAction` |
| **8. Landing Page - Synth√®se** | `key-modifs-creer-landing-page-synthese` ‚Üí `generation_summary_sheet` | `key-modifs-creer-landing-page-synthese` | Non | Non |

---

## XIII. PARTIE 10 : TABLEAU R√âCAPITULATIF DES CL√âS LOCALSTORAGE 

### Cat√©gorie 1 : Donn√©es Utilisateur (propertyData) - 14 Cl√©s

| Cl√© | Description | Type | Taille estim√©e | Exemple |
|-----|-------------|------|----------------|---------|
| `propertyType` | Type de bien immobilier | `string` | 10-50 B | `"Restaurant"` |
| `agencyName` | Nom de l'agence immobili√®re | `string` | 10-100 B | `"Presenca Immo"` |
| `location` | Localisation du bien | `string` | 10-100 B | `"Paris 8√®me"` |
| `commercialAssets` | Actifs commerciaux du bien | `string` | 50-500 B | `"Client√®le fid√®le, cuisine √©quip√©e..."` |
| `price` | Prix de vente (optionnel) | `string \| undefined` | 5-20 B | `"450 000 ‚Ç¨"` |
| `rent` | Loyer mensuel (optionnel) | `string \| undefined` | 5-20 B | `"4 500 ‚Ç¨ HT/mois"` |
| `surface` | Surface du bien | `string \| undefined` | 5-20 B | `"120 m¬≤"` |
| `details` | D√©tails suppl√©mentaires | `string \| undefined` | 50-1000 B | `"Bail commercial 9 ans..."` |
| `reference` | R√©f√©rence du bien | `string \| undefined` | 10-50 B | `"COM-75008-REST-001"` |
| `priceDpe` | Prix DPE | `string \| undefined` | 5-20 B | `"C"` |
| `energyDpe` | √ânergie DPE | `string \| undefined` | 5-20 B | `"D"` |
| `dateAvailability` | Date de disponibilit√© | `string \| undefined` | 10-20 B | `"2024-06-01"` |
| `isExclusive` | Exclusivit√© (bool√©en) | `boolean \| undefined` | 5 B | `true` |

**Taille totale estim√©e : 300-2000 B (0.3-2 KB)**

---

### Cat√©gorie 2 : Progression - 3 Cl√©s

| Cl√© | Description | Type | Structure | Taille |
|-----|-------------|------|-----------|--------|
| `generation_status` | Statut de g√©n√©ration OpenAI | `JSON` | `{ completed: boolean, timestamp: string }` | 50-100 B |
| `current_step` | √âtape actuelle de l'utilisateur | `string` | `"etape6"` | 10-20 B |
| `session_start_time` | Heure de d√©but de session | `string` | `"2024-01-15T10:30:00Z"` | 20-30 B |

**Taille totale estim√©e : 80-150 B**

---

### Cat√©gorie 3 : G√©n√©rations OpenAI - 7 Cl√©s

| Cl√© | Service | Structure JSON | Taille estim√©e | Format |
|-----|---------|----------------|----------------|--------|
| `generation_website_ad` | Annonce Site Internet | `{ titre, accroche, descriptif, cta }` | 2-3 KB | Texte + HTML |
| `generation_summary_sheet` | Fiche de Synth√®se | `{ titre, referenceEtPrix, detailsCles, donneesFinancieres, informationsComplementaires }` | 3-4 KB | HTML |
| `generation_newsletter` | Newsletter | `{ titre, accroche, pointsForts, callToAction, prixEtReference }` | 2-3 KB | HTML |
| `generation_seo_tools` | Outils SEO | `{ baliseTitre, baliseMetaDescription, urlLongueTraine }` | 1-2 KB | Texte |
| `generation_sms_ad` | Annonce SMS | `{ "restitution-annonce-sms": string }` | 0.5-1 KB | Texte (160 car max) |
| `generation_googleprofile_ad` | Google Business Profile | `{ TitreAnnonceGoogle, AccrocheDescriptiveAnnonceGoogle, PointsFortsAnnonceGoogle, CtaAnnonceGoogle }` | 2-3 KB | Texte + Markdown |
| `generation_reseauxsociaux_ad` | R√©seaux Sociaux | `{ TitreAnnonceReseaux, AccrocheImpactanteAnnonceReseaux, AtoutsAnnonceReseaux, CtaAnnonceReseaux }` | 2-3 KB | Texte + Emoji |

**Taille totale estim√©e : 13-20 KB**

---

### Cat√©gorie 4 : Modifications Utilisateur - 12 Cl√©s

| # | Cl√© | Canal | Structure JSON | Taille |
|---|-----|-------|----------------|--------|
| 1 | `key-modifs-copier-annonce-site-internet` | Copier Annonce Site | `{ titre, accroche, descriptif, appelAction }` | 2-3 KB |
| 2 | `key-modifs-integrer-outils-seo` | Int√©grer Outils SEO | `{ baliseTitre, baliseMetaDescription, urlLongueTraine }` | 1-2 KB |
| 3 | `key-modifs-diffuser-portails-immobiliers` | Diffuser Portails | `{ titre, referenceEtPrix, detailsCles, donneesFinancieres, informationsComplementaires }` | 3-4 KB |
| 4 | `key-modifs-creer-campagne-newsletter` | Campagne Newsletter | `{ titre, accroche, pointsForts, callToAction, prixEtReference }` | 2-3 KB |
| 5 | `key-modifs-creer-campagne-sms` | Campagne SMS | `{ "restitution-annonce-sms": string }` | 0.5-1 KB |
| 6 | `key-modifs-diffuser-google-annonce` | Google Business | `{ titre, accroche, pointsForts, appelAction }` | 2-3 KB |
| 7 | `key-modifs-diffuser-reseaux-sociaux-annonce` | R√©seaux Sociaux | `{ titre, accroche, pointsForts, appelAction }` | 2-3 KB |
| 8 | `key-modifs-creer-landing-page-annonce` | Landing Page - Annonce | `{ titre, accroche, descriptif, appelAction }` | 2-3 KB |
| 9 | `key-modifs-creer-landing-page-synthese` | Landing Page - Synth√®se | `{ titre, referenceEtPrix, detailsCles, donneesFinancieres, informationsComplementaires }` | 3-4 KB |
| 10 | `key-modifs-expediteur-campagne-sms` | SMS - Exp√©diteur | `string` | 10-50 B |
| 11 | `key-modifs-url-annonce-campagne-sms` | SMS - URL | `string` | 20-200 B |
| 12 | `key-modifs-destinataires-campagne-sms` | SMS - Destinataires | `string` | 50-500 B |

**Taille totale estim√©e : 17-27 KB**

---

### R√©capitulatif Global

| Cat√©gorie | Nombre de cl√©s | Taille estim√©e |
|-----------|----------------|----------------|
| **Donn√©es utilisateur (propertyData)** | 13 (sans `propertyData` wrapp√©e) | 0.3-2 KB |
| **Progression** | 3 | 80-150 B |
| **G√©n√©rations OpenAI** | 7 | 13-20 KB |
| **Modifications utilisateur** | 12 | 17-27 KB |
| **TOTAL** | **35 cl√©s** | **30-50 KB** |

**‚ö†Ô∏è Note importante :**
- La limite `localStorage` dans les navigateurs est g√©n√©ralement de **5-10 MB**
- L'application utilise actuellement **0.5-1% de la capacit√© totale** (tr√®s s√ªr)
- Aucun risque de d√©passement de quota

---

## XIV. DONN√âES √Ä PRENDRE EN CONSID√âRATION 

### A. Points d'Attention Techniques

#### 1. Cl√© API OpenAI Hard-cod√©e

**Probl√®me :**
- La cl√© API OpenAI est actuellement stock√©e dans l'√©tat React (probablement via `OpenAIContext` ou `localStorage`)
- Risque de s√©curit√© si la cl√© est expos√©e c√¥t√© client (visible dans le code source ou les outils de d√©veloppement)

**Donn√©es critiques :**
- Cl√© API : `sk-...` (format OpenAI)
- Stockage actuel : Context React ou `localStorage` (√† v√©rifier)

**Recommandation pour migration Supabase :**
- Stocker la cl√© en tant que **secret Supabase** (c√¥t√© serveur)
- Cr√©er une edge function Supabase pour appeler OpenAI
- Ne jamais exposer la cl√© c√¥t√© client

---

#### 2. Fonction `cleanOpenAIContent()` Dupliqu√©e

**Probl√®me :**
- La fonction est pr√©sente dans **2 fichiers diff√©rents** :
  - `Hook-1-RecuperationDataGoogle.ts` (lignes 10-18)
  - `Hook-1-RecuperationDataReseaux.ts` (lignes 10-18)
- Dette technique : Duplication de code = risque d'incoh√©rence

**Code actuel :**
```typescript
const cleanOpenAIContent = (text: string): string => {
  if (!text) return "";
  return text
    .replace(/\\n/g, "\n")
    .replace(/\\\\/g, "\\");
};
```

**Recommandation :**
- Centraliser 
- Importer partout o√π n√©cessaire
- Ajouter des tests unitaires pour garantir le comportement

---

#### 3. Nommage Incoh√©rent

**Probl√®me :**
- OpenAI retourne des cl√©s en **PascalCase** : `TitreAnnonceGoogle`, `AccrocheDescriptiveAnnonceGoogle`
- L'interface React utilise **camelCase** : `titre`, `accroche`
- Mapping manuel n√©cessaire dans chaque hook :
  ```typescript
  titre: cleanOpenAIContent(parsedData.TitreAnnonceGoogle || '')
  ```

**Impact :**
- Code verbeux et r√©p√©titif
- Risque d'erreur de typage (nom de cl√© incorrect)
- Difficult√© de maintenance

**Recommandation :**
- Standardiser le nommage c√¥t√© OpenAI (modifier les prompts pour retourner du camelCase)
- OU cr√©er une fonction utilitaire de mapping automatique :

---

#### 4. √âcrasement des Donn√©es de G√©n√©ration

**Probl√®me :**
- Chaque nouvelle g√©n√©ration (√âtape 5) **√©crase** les cl√©s `generation_*` pr√©c√©dentes
- Pas d'historique des g√©n√©rations
- Impossibilit√© de comparer plusieurs versions

**Impact :**
- Si l'utilisateur g√©n√®re 2 fois pour le m√™me bien, la premi√®re g√©n√©ration est perdue
- Pas de possibilit√© de "rollback" vers une g√©n√©ration pr√©c√©dente

---


#### 6. Validation Uniquement C√¥t√© Client

**Probl√®me :**
- Toutes les donn√©es (PropertyData, g√©n√©rations OpenAI, modifications utilisateur) sont valid√©es **uniquement c√¥t√© client**
- Pas de validation serveur

**Risques :**
- Injection de donn√©es malform√©es (si l'utilisateur contourne le frontend)
- Donn√©es corrompues dans `localStorage` (si manipulation manuelle)

**Recommandation :**
- Ajouter une validation serveur (edge functions Supabase) pour :
  - PropertyData avant g√©n√©ration OpenAI
  - G√©n√©rations OpenAI avant stockage en DB
  - Modifications utilisateur avant publication
- Utiliser un sch√©ma de validation (Zod, Yup, etc.)

---

#### 7. Timer de Session Non Uniforme

**Probl√®me :**
- Le timer de session (compte √† rebours) est pr√©sent dans certaines √©tapes (√âtape 1-4)
- **Mais** : Absent dans l'√âtape 6 Communication
- Comportement incoh√©rent pour l'utilisateur

**Impact :**
- Confusion utilisateur (le timer dispara√Æt soudainement)
- Pas de tracking du temps pass√© sur l'√âtape 6

**Recommandation :**
- Unifier le timer de session sur toutes les pages
- Stocker le temps pass√© par √©tape en DB pour analytics

---

### B. Donn√©es Critiques √† Pr√©server lors de la Migration

#### 1. 7 Structures JSON Compl√®tes des G√©n√©rations OpenAI

**Donn√©es √† pr√©server :**

```typescript
// 1. Annonce Site Internet
interface WebsiteAdGeneration {
  titre: string;          // Max 60 caract√®res
  accroche: string;       // Texte brut
  descriptif: string;     // HTML avec , , 
  cta: string;            // Texte brut
}

// 2. Fiche de Synth√®se
interface SummarySheetGeneration {
  titre: string;                         // HTML 
  referenceEtPrix: string;               // HTML 
  detailsCles: string;                   // HTML 
  donneesFinancieres: string;            // HTML 
  informationsComplementaires: string;   // HTML 
}

// 3. Newsletter
interface NewsletterGeneration {
  titre: string;            // Max 70 caract√®res
  accroche: string;         // HTML 
  pointsForts: string;      // HTML 
  callToAction: string;     // HTML 
  prixEtReference: string;  // HTML 
}

// 4. Outils SEO
interface SEOToolsGeneration {
  baliseTitre: string;            // Max 60 caract√®res
  baliseMetaDescription: string;  // Max 160 caract√®res
  urlLongueTraine: string;        // kebab-case
}

// 5. Annonce SMS
interface SMSAdGeneration {
  "restitution-annonce-sms": string;  // Max 160 caract√®res
}

// 6. Google Business Profile
interface GoogleProfileAdGeneration {
  TitreAnnonceGoogle: string;                   // Max 58 caract√®res
  AccrocheDescriptiveAnnonceGoogle: string;     // Texte brut
  PointsFortsAnnonceGoogle: string;             // Markdown avec \n
  CtaAnnonceGoogle: string;                     // Texte brut
}

// 7. R√©seaux Sociaux
interface ReseauxSociauxAdGeneration {
  TitreAnnonceReseaux: string;                   // Avec emojis
  AccrocheImpactanteAnnonceReseaux: string;      // Texte brut
  AtoutsAnnonceReseaux: string;                  // Markdown avec \n et emojis
  CtaAnnonceReseaux: string;                     // Texte brut
}
```

**Sch√©ma de validation JSON (Zod) :**
```typescript
import { z } from 'zod';

const WebsiteAdSchema = z.object({
  titre: z.string().max(60),
  accroche: z.string(),
  descriptif: z.string(),
  cta: z.string()
});

// ... 6 autres sch√©mas pour chaque service
```

---

#### 2. 12 Cl√©s de Modifications Utilisateur

**Donn√©es √† pr√©server :**

| # | Cl√© | Structure | Taille | Priorit√© |
|---|-----|-----------|--------|----------|
| 1 | `key-modifs-copier-annonce-site-internet` | `AnnonceSiteInternetData` | 2-3 KB | 1 (sur `generation_website_ad`) |
| 2 | `key-modifs-integrer-outils-seo` | `OutilsSEOData` | 1-2 KB | 1 (sur `generation_seo_tools`) |
| 3 | `key-modifs-diffuser-portails-immobiliers` | `AnnonceFichedeSyntheseData` | 3-4 KB | 1 (sur `generation_summary_sheet`) |
| 4 | `key-modifs-creer-campagne-newsletter` | `AnnonceNewsletterData` | 2-3 KB | 1 (sur `generation_newsletter`) |
| 5 | `key-modifs-creer-campagne-sms` | `AnnonceSMSData` | 0.5-1 KB | 1 (sur `generation_sms_ad`) |
| 6 | `key-modifs-diffuser-google-annonce` | `AnnonceGoogleData` | 2-3 KB | 1 (sur `generation_googleprofile_ad`) |
| 7 | `key-modifs-diffuser-reseaux-sociaux-annonce` | `AnnonceReseauxData` | 2-3 KB | 1 (sur `generation_reseauxsociaux_ad`) |
| 8 | `key-modifs-creer-landing-page-annonce` | `AnnonceLandingPageData` | 2-3 KB | 1 (sur `generation_website_ad`) |
| 9 | `key-modifs-creer-landing-page-synthese` | `FichedeSyntheseLandingPageData` | 3-4 KB | 1 (sur `generation_summary_sheet`) |
| 10 | `key-modifs-expediteur-campagne-sms` | `string` | 50 B | 1 |
| 11 | `key-modifs-url-annonce-campagne-sms` | `string` | 200 B | 1 |
| 12 | `key-modifs-destinataires-campagne-sms` | `string` | 500 B | 1 |







---
