# üìÑ **AUDIT TECHNIQUE EXHAUSTIF - CANAL "COPIER / ENVOYER UNE CAMPAGNE SMS"**

## **I. MISSION DU DOCUMENT**

Ce document constitue l'audit technique **complet et exhaustif** du canal **"Copier / Envoyer une Campagne SMS"** dans l'application LeadGenAI. Il documente l'int√©gralit√© des fichiers, hooks, fonctions, structures de donn√©es, processus et contraintes techniques actuellement impl√©ment√©s en **localStorage**, en vue d'une future **migration vers Supabase** avec architecture **multi-tenant**.

**Objectifs du document** :
- ‚úÖ **Cartographier** tous les fichiers, composants, hooks et utilitaires utilis√©s
- ‚úÖ **Tracer** le flux de donn√©es complet depuis OpenAI jusqu'√† la copie/envoi
- ‚úÖ **Identifier** toutes les cl√©s localStorage (lecture/√©criture)
- ‚úÖ **Documenter** les contraintes de validation (compteur de caract√®res GSM-7, limites)
- ‚úÖ **Analyser** les fonctions de copie texte et d'envoi vers Brevo
- ‚úÖ **Fournir** les bases techniques pour la migration Supabase

---

## **II. SOMMAIRE CLIQUABLE**

1. [Mission du Document](#i-mission-du-document)
2. [Sommaire Cliquable](#ii-sommaire-cliquable)
3. [Architecture Globale - Canal](#iii-architecture-globale---canal)
4. [Liste Exhaustive des Fichiers Utilis√©s](#iv-liste-exhaustive-des-fichiers-utilis√©s)
5. [Syst√®me d'Onglets](#v-syst√®me-donglets)
6. [Processus de R√©cup√©ration des Donn√©es OpenAI](#vi-processus-de-r√©cup√©ration-des-donn√©es-openai)
7. [Structure des Donn√©es localStorage](#vii-structure-des-donn√©es-localstorage)
8. [Processus Complet √âtape par √âtape](#viii-processus-complet-√©tape-par-√©tape)
9. [Syst√®me d'√âdition - Bouton "Modifier"](#ix-syst√®me-d√©dition---bouton-modifier)
10. [Options de Copie et Envoi](#x-options-de-copie-et-envoi)
11. [Syst√®me d'Aper√ßu](#xi-syst√®me-daper√ßu)
12. [Contraintes et Validation](#xii-contraintes-et-validation)
13. [Composants Graphiques R√©utilisables](#xiii-composants-graphiques-r√©utilisables)
14. [Tableaux R√©capitulatifs](#xiv-tableaux-r√©capitulatifs)
15. [Donn√©es √† Prendre en Consid√©ration](#xv-donn√©es-√†-prendre-en-consid√©ration)

---

## **III. ARCHITECTURE GLOBALE - CANAL**

### **3.1. Vue d'ensemble du canal**

Le canal **"Copier / Envoyer une Campagne SMS"** permet aux utilisateurs de :
1. **Visualiser et √©diter** une annonce SMS g√©n√©r√©e par OpenAI (122 caract√®res maximum)
2. **Personnaliser** l'annonce avec 3 champs compl√©mentaires (Exp√©diteur 10 car., URL 25 car., Destinataires)
3. **Copier** l'annonce SMS compl√®te au format texte
4. **Envoyer** (fonctionnalit√© inactive) la campagne SMS vers la plateforme Brevo

**Localisation dans l'application** :  
üìç Accessible via `/etape6communication` lorsque `setSelectedOption("creer-campagne-sms")` est actif, ce qui affiche le composant ``.

---

### **3.2. Position dans √âtape 6 Communication**

```
√âTAPE 6 COMMUNICATION
‚îú‚îÄ‚îÄ Site Internet Annonces
‚îú‚îÄ‚îÄ Site Internet Outils SEO
‚îú‚îÄ‚îÄ Copier / Publier sur Portails Immobiliers
‚îú‚îÄ‚îÄ Cr√©er un Emailing / Newsletter
‚îî‚îÄ‚îÄ üìç **Copier / Envoyer une Campagne SMS** ‚óÄ ACTUEL
```

---

### **3.3. Sch√©ma Mermaid complet (flux de donn√©es)**

```mermaid
graph TD
    A[OpenAI g√©n√®re annonce SMS] --> B[Stockage localStoragegeneration_sms_ad]
    B --> C{Modifications utilisateur ?}
    C -->|Oui| D[Stockage modifskey-modifs-creer-campagne-sms]
    C -->|Non| E[Lecture directe generation_sms_ad]
    D --> F[Hook useRecuperationDataSMSPriorit√© modifs > originales]
    E --> F

    F --> G[ONGLET 1: Annonce SMSFile1.AnnonceSMS.tsx]
    G --> H{Mode √©dition activ√© ?}
    H -->|Oui| I[GraphismeCompteurCaracteresAnnonceSMS122 caract√®res max, filtrage GSM-7]
    H -->|Non| J[ReadOnlyField]
    I --> K[Sauvegarde auto localStorage]

    L[Champs personnalisationlocalStorage] --> M[ONGLET 2: PersonnaliserFile2.PersonnaliserSMS.tsx]
    M --> N[GraphismeCompteurPersoExpediteur10 car. max]
    M --> O[GraphismeCompteurPersoURL25 car. max]
    M --> P[GraphismeDestinatairesinactif, futur Brevo]

    K --> Q[ONGLET 3: Utiliser l'AnnonceFile3.ActionUtilisateurSMS]
    L --> Q
    Q --> R[HookUtiliserApercuAnnonceSMS4 aper√ßus]
    Q --> S[HookUtiliserCopierTexteCopier format SMS]
    Q --> T[HookUtiliserFonctionEnvoiBrevoEnvoi Brevo - INACTIF]

    S --> U[Construction SMS completExpediteur + Annonce + URL]
    U --> V[navigator.clipboard.writeText]

    T --> W[Pr√©paration donn√©es BrevodonneesBrevo object]
    W --> X[Toast: Fonction en pr√©paration]

    style D fill:#e3f2fd
    style K fill:#e3f2fd
    style V fill:#c8e6c9
    style X fill:#fff9c4
```

---

## **IV. LISTE EXHAUSTIVE DES FICHIERS UTILIS√âS**

### **4.1. Fichiers de composition**

| **Fichier** | **Chemin** | **R√¥le** |
|-------------|------------|----------|
| `AccueilCreerCampagneSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Composant racine** du canal SMS. G√®re le state `editMode` et orchestre les 3 onglets via `MenuOngletCampagneSMS`. |
| `MenuOngletCampagneSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Syst√®me d'onglets** avec 3 tabs : "Annonce SMS", "Personnaliser l'Annonce", "Utiliser l'Annonce". G√®re le bouton **Modifier/Sauvegarder** pour onglets 1 et 2. |
| `File1.AnnonceSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Onglet 1** : Affiche et √©dite l'annonce SMS (122 caract√®res max). |
| `File2.PersonnaliserSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Onglet 2** : Affiche et √©dite les 3 champs de personnalisation (Exp√©diteur, URL, Destinataires). |
| `File3.ActionUtilisateurSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Onglet 3** : Affiche les options de copie/envoi et les 4 aper√ßus. |

---

### **4.2. Hooks de r√©cup√©ration**

| **Hook** | **Chemin** | **Fonction** |
|----------|------------|--------------|
| `useRecuperationDataSMS` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/Hook-1-RecuperationDataSMS.ts` | R√©cup√®re l'annonce SMS depuis **localStorage** avec **logique de priorit√©** : `key-modifs-creer-campagne-sms` > `generation_sms_ad`. Expose `annonceSMS`, `updateAnnonceSMS`, `isLoading`, `error`. |
| `usePersonnaliserChampsSMS` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/Hook-2-PersonnaliserChamps.tsx` | G√®re les 3 champs de personnalisation (Exp√©diteur, URL, Destinataires) avec **sauvegarde auto** dans localStorage (`key-modifs-sms-expediteur`, `key-modifs-sms-url`, `key-modifs-sms-destinataires`). |

---

### **4.3. Hooks d'aper√ßu**

| **Hook** | **Chemin** | **Fonction** |
|----------|------------|--------------|
| `HookUtiliserApercuAnnonceSMS` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/Hook-3-UtiliserApercuAnnonceSMS.tsx` | Affiche **4 aper√ßus** : Annonce SMS, Exp√©diteur, URL, Destinataires. R√©cup√®re les donn√©es depuis localStorage avec **mise √† jour en temps r√©el** (event listener + interval 1s). |

---

### **4.4. Hooks de copie et envoi**

| **Hook** | **Chemin** | **Fonction** |
|----------|------------|--------------|
| `HookUtiliserCopierTexte` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/Hook-3-UtiliserCopierTexte.tsx` | **Copie au format texte** : Construit le SMS complet (`Expediteur + Annonce + URL`) et copie vers clipboard via `navigator.clipboard.writeText`. |
| `HookUtiliserFonctionEnvoiBrevo` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/Hook-3-UtiliserFonctionEnvoiBrevo.tsx` | **Envoi vers Brevo** : Affiche un toast "Fonction en pr√©paration". Futur appel API Brevo. |
| `HookUtiliserBrevo` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/Hook-3-UtiliserBrevo.tsx` | Version d√©taill√©e de l'envoi Brevo avec **pr√©paration des donn√©es** au format Brevo (`sender`, `recipient`, `content`, `type`, `tag`). Fonction `preparerDonneesBrevo()` + `envoyerVersBrevo()`. **Non utilis√© actuellement**. |

---

### **4.5. Composants graphiques**

| **Composant** | **Chemin** | **Fonction** |
|---------------|------------|--------------|
| `GraphismeInterieurCampagneSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | Contient **tous les composants UI r√©utilisables** : `LabelField`, `ReadOnlyField`, `EditableField`, `EditButton`, `CopyOption`, `CopyOption3`, `CopyOptionsContainer`, `AnnoncePreview`. |
| `GraphismeCompteurCaracteresAnnonceSMS.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Compteur SMS 122 caract√®res** avec filtrage GSM-7, comptage sp√©cial pour `‚Ç¨` (2 car.), blocage d√©passement, `CircularProgress` color√©. |
| `GraphismeCompteurCaracteresPersoSMSExpediteur.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Compteur Exp√©diteur 10 caract√®res** avec filtrage GSM-7, sauvegarde auto localStorage. |
| `GraphismeCompteurCaracteresPersoSMSURL.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Compteur URL 25 caract√®res** avec filtrage GSM-7, sauvegarde auto localStorage. |
| `GraphismeOngletPersonnaliserDestinataires.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **Champ Destinataires** (disabled, readOnly). Futur menu dropdown pour s√©lectionner des listes Brevo. |
| `EditeurWYSIWYG.tsx` | `src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/` | **√âditeur WYSIWYG** utilisant ReactQuill. **Non utilis√© dans ce canal** (SMS = texte brut uniquement). |

---

### **4.6. Arborescence compl√®te avec descriptions**

```
src/components/1-Sources-Restitution-Utilisateur/5.EtapeCreerSMSCampagne/
‚îÇ
‚îú‚îÄ‚îÄ AccueilCreerCampagneSMS.tsx          # Racine du canal, g√®re editMode
‚îú‚îÄ‚îÄ MenuOngletCampagneSMS.tsx            # Syst√®me d'onglets (3 tabs)
‚îÇ
‚îú‚îÄ‚îÄ File1.AnnonceSMS.tsx                 # Onglet 1: Annonce SMS (122 car.)
‚îú‚îÄ‚îÄ File2.PersonnaliserSMS.tsx           # Onglet 2: 3 champs personnalisation
‚îú‚îÄ‚îÄ File3.ActionUtilisateurSMS.tsx       # Onglet 3: Copie/Envoi + Aper√ßus
‚îÇ
‚îú‚îÄ‚îÄ Hook-1-RecuperationDataSMS.ts        # R√©cup√©ration annonce SMS (priorit√© modifs)
‚îú‚îÄ‚îÄ Hook-2-PersonnaliserChamps.tsx       # Gestion 3 champs perso (localStorage)
‚îú‚îÄ‚îÄ Hook-3-UtiliserApercuAnnonceSMS.tsx  # 4 aper√ßus (temps r√©el)
‚îú‚îÄ‚îÄ Hook-3-UtiliserCopierTexte.tsx       # Copie format texte (clipboard)
‚îú‚îÄ‚îÄ Hook-3-UtiliserFonctionEnvoiBrevo.tsx # Envoi Brevo (toast inactif)
‚îú‚îÄ‚îÄ Hook-3-UtiliserBrevo.tsx             # Version d√©taill√©e envoi Brevo (non utilis√©)
‚îÇ
‚îú‚îÄ‚îÄ GraphismeInterieurCampagneSMS.tsx    # Composants UI r√©utilisables
‚îú‚îÄ‚îÄ GraphismeCompteurCaracteresAnnonceSMS.tsx      # Compteur 122 car. GSM-7
‚îú‚îÄ‚îÄ GraphismeCompteurCaracteresPersoSMSExpediteur.tsx # Compteur 10 car.
‚îú‚îÄ‚îÄ GraphismeCompteurCaracteresPersoSMSURL.tsx     # Compteur 25 car.
‚îú‚îÄ‚îÄ GraphismeOngletPersonnaliserDestinataires.tsx  # Champ Destinataires (futur Brevo)
‚îî‚îÄ‚îÄ EditeurWYSIWYG.tsx                   # √âditeur WYSIWYG (non utilis√© SMS)
```

**Fichier OpenAI utilis√©** :  
üìÑ `src/services/openai/1.GenerateurAnnoncesOutilsSeo/7.PromptsOpenAi/5.PromptSMSAnnonce.ts` ‚Üí Contient le **prompt OpenAI** pour g√©n√©rer l'annonce SMS (122 car. max, structure impos√©e, r√®gles GSM-7).

---

## **V. SYST√àME D'ONGLETS**

### **5.1. MenuOnglet**

**Fichier** : `MenuOngletCampagneSMS.tsx`

**Props** :
```typescript
interface MenuOngletCampagneSMSProps {
  tabTitles?: string[];                    // Titres des 3 onglets
  tabContent1?: ReactNode;                 // Contenu Onglet 1
  tabContent2?: ReactNode;                 // Contenu Onglet 2
  tabContent3?: ReactNode;                 // Contenu Onglet 3
  enableEditMode?: boolean;                // Activer bouton Modifier
  onTabChange?: (tabValue: string) => void; // Callback changement onglet
  onEditModeChange?: (isEditMode: boolean) => void; // Callback mode √©dition
  className?: string;
}
```

**Valeurs par d√©faut** :
```typescript
tabTitles = ["Annonce SMS", "Personnaliser l'Annonce", "Utiliser l'Annonce"]
```

**Bouton Modifier/Sauvegarder** :
- ‚úÖ Pr√©sent sur **Onglet 1** (Annonce SMS)
- ‚úÖ Pr√©sent sur **Onglet 2** (Personnaliser l'Annonce)
- ‚ùå **Absent** sur **Onglet 3** (Utiliser l'Annonce) ‚Üí Lecture seule uniquement

**Comportement toggle** :
```typescript
const toggleEditMode = () => {
  const newEditMode = !editMode;
  setEditMode(newEditMode);

  if (!newEditMode) {
    toast({
      title: "Modifications sauvegard√©es",
      description: "Les changements ont √©t√© enregistr√©s avec succ√®s."
    });
  }

  if (onEditModeChange) {
    onEditModeChange(newEditMode);
  }
};
```

**R√®gle importante** : Si l'utilisateur change d'onglet en mode √©dition, le mode √©dition est **automatiquement d√©sactiv√©** :
```typescript
const handleTabChange = (value: string) => {
  setActiveTab(value);
  if (editMode) {
    toggleEditMode();
  }
  if (onTabChange) {
    onTabChange(value);
  }
};
```

---

### **5.2. Onglet 1 : Annonce SMS**

**Fichier** : `File1.AnnonceSMS.tsx`

**Contenu** :
- **1 champ unique** : `restitution-annonce-sms` (Annonce SMS 122 caract√®res max)

**Affichage conditionnel** :
- **Mode lecture** (`editMode = false`) : `` affiche l'annonce en texte brut
- **Mode √©dition** (`editMode = true`) : `` avec compteur, filtrage GSM-7, blocage √† 122 car.

**Logique de mise √† jour** :
```typescript
const handleChange = (name: string, value: string) => {
  let cleanedValue = value;
  if (name === "restitution-annonce-sms") {
    cleanedValue = value.replace(/<\/?[^>]+(>|$)/g, ""); // Suppression balises HTML
  }

  const updatedData = { [name]: cleanedValue };
  updateAnnonceSMS(updatedData); // Sauvegarde localStorage

  if (onDataChange) {
    onDataChange({ ...annonceSMS, ...updatedData });
  }
};
```

**Nettoyage HTML** : Suppression de toutes les balises HTML via regex `/< \/?[^>]+(>|$)/g`.

---

### **5.3. Onglet 2 : Personnaliser l'Annonce**

**Fichier** : `File2.PersonnaliserSMS.tsx`

**Contenu** : **3 champs de personnalisation**

| **Champ** | **Composant √©dition** | **Limite** | **Composant lecture** | **localStorage** |
|-----------|----------------------|------------|----------------------|------------------|
| **Exp√©diteur** | `GraphismeCompteurCaracteresPersoSMSExpediteur` | 10 car. | `ReadOnlyField` | `key-modifs-sms-expediteur` |
| **URL de l'Annonce** | `GraphismeCompteurCaracteresPersoSMSURL` | 25 car. | `ReadOnlyField` | `key-modifs-sms-url` |
| **Liste des Destinataires** | `GraphismeOngletPersonnaliserDestinataires` | N/A | **Toujours disabled** | `key-modifs-sms-destinataires` |

**Particularit√© Destinataires** :
- Champ **toujours non modifiable** (`disabled={true}`, `readOnly={true}`)
- Placeholder : `"Fonction associ√©e avec la plateforme Brevo"`
- **Futur** : Menu dropdown pour s√©lectionner des listes Brevo via API

**Hook utilis√©** : `usePersonnaliserChampsSMS`
- Charge les donn√©es depuis localStorage au montage
- Sauvegarde automatique √† chaque modification
- Expose `personnaliserData`, `updateExpediteur()`, `updateUrlAnnonce()`, `updateDestinataires()`

---

### **5.4. Onglet 3 : Utiliser l'Annonce**

**Fichier** : `File3.ActionUtilisateurSMS.tsx`

**Contenu** :
1. **Titre "Options"**
2. **Deux cadres c√¥te √† c√¥te** (grid 2 colonnes) :
   - `` ‚Üí Copier au Format Texte
   - `` ‚Üí Envoyer la Campagne SMS
3. **4 aper√ßus** :
   - `` ‚Üí Affiche les 4 aper√ßus

**Aucun bouton Modifier** : Cet onglet est **en lecture seule uniquement**.

---

### **5.5. Logique de navigation et √©tat**

**State global** (dans `AccueilCreerCampagneSMS.tsx`) :
```typescript
const [editMode, setEditMode] = useState(false);
const [annonceSMSData, setAnnonceSMSData] = useState({});
const [personnaliserSMSData, setPersonnaliserSMSData] = useState({});
```

**Propagation du mode √©dition** :
- `MenuOngletCampagneSMS` g√®re l'√©tat `editMode` local et le propage via `onEditModeChange`
- `AccueilCreerCampagneSMS` re√ßoit le changement et met √† jour son propre `editMode`
- Les composants `File1.AnnonceSMS` et `File2.PersonnaliserSMS` re√ßoivent `editMode` en props

**Callbacks de donn√©es** :
- `File1.AnnonceSMS` ‚Üí `onDataChange(data)` ‚Üí `handleAnnonceSMSDataChange(data)` ‚Üí `setAnnonceSMSData(data)`
- `File2.PersonnaliserSMS` ‚Üí `onDataChange(data)` ‚Üí `handlePersonnaliserSMSDataChange(data)` ‚Üí `setPersonnaliserSMSData(data)`

---

## **VI. PROCESSUS DE R√âCUP√âRATION DES DONN√âES OPENAI**

### **6.1. Sources de donn√©es (cl√©s localStorage)**

**Donn√©es originales OpenAI** :
```typescript
localStorage.getItem('generation_sms_ad')
```
**Structure JSON** :
```json
{
  "restitution-annonce-sms": "AV Bar Restaurant. Paris Nord. Licence 4. Emplacement en angle. Fort Potentiel. 331.527‚Ç¨ FAI. Infos-> "
}
```

**Donn√©es modifi√©es utilisateur** :
```typescript
localStorage.getItem('key-modifs-creer-campagne-sms')
```
**Structure JSON identique** :
```json
{
  "restitution-annonce-sms": "AV Brasserie. Toulouse. Licence 4. Emplacement N1. 420.000‚Ç¨ FAI. Infos-> "
}
```

---

### **6.2. Logique de priorit√© (modifs > originales)**

**Hook** : `useRecuperationDataSMS` (`Hook-1-RecuperationDataSMS.ts`)

**Logique de r√©cup√©ration** :
```typescript
useEffect(() => {
  try {
    setIsLoading(true);

    // PRIORIT√â 1 : Donn√©es modifi√©es
    const modifiedDataJson = localStorage.getItem('key-modifs-creer-campagne-sms');

    if (modifiedDataJson) {
      const modifiedData = JSON.parse(modifiedDataJson);
      setAnnonceSMS({
        "restitution-annonce-sms": modifiedData["restitution-annonce-sms"] || ''
      });
    } else {
      // PRIORIT√â 2 : Donn√©es originales OpenAI
      const annonceSMSData = localStorage.getItem('generation_sms_ad');

      if (annonceSMSData) {
        const parsedData = JSON.parse(annonceSMSData);
        setAnnonceSMS({
          "restitution-annonce-sms": parsedData["restitution-annonce-sms"] || ''
        });
      } else {
        console.log('Aucune donn√©e d\'annonce SMS trouv√©e');
      }
    }

    setIsLoading(false);
  } catch (err) {
    console.error('Erreur r√©cup√©ration:', err);
    setError('Erreur lors de la r√©cup√©ration des donn√©es');
    setIsLoading(false);
  }
}, []);
```

---

### **6.3. Hooks de r√©cup√©ration d√©taill√©s**

#### **A. useRecuperationDataSMS**

**Fichier** : `Hook-1-RecuperationDataSMS.ts`

**Interface** :
```typescript
interface AnnonceSMSData {
  "restitution-annonce-sms": string;
}
```

**√âtat expos√©** :
```typescript
const [annonceSMS, setAnnonceSMS] = useState({
  "restitution-annonce-sms": ''
});
const [isLoading, setIsLoading] = useState(true);
const [error, setError] = useState(null);
```

**Fonction de mise √† jour** :
```typescript
const updateAnnonceSMS = (newData: Partial) => {
  const updatedData = { ...annonceSMS, ...newData };
  setAnnonceSMS(updatedData);

  try {
    localStorage.setItem('key-modifs-creer-campagne-sms', JSON.stringify(updatedData));
  } catch (err) {
    console.error('Erreur sauvegarde:', err);
    setError('Erreur lors de la sauvegarde');
  }
};
```

**Return** :
```typescript
return { annonceSMS, updateAnnonceSMS, isLoading, error };
```

---

#### **B. usePersonnaliserChampsSMS**

**Fichier** : `Hook-2-PersonnaliserChamps.tsx`

**Interface** :
```typescript
interface PersonnaliserSMSData {
  expediteur: string;
  urlAnnonce: string;
  destinataires: string;
}
```

**Chargement initial** :
```typescript
useEffect(() => {
  const expediteurSaved = localStorage.getItem('key-modifs-sms-expediteur') || '';
  const urlSaved = localStorage.getItem('key-modifs-sms-url') || '';
  const destinatairesSaved = localStorage.getItem('key-modifs-sms-destinataires') || '';

  setPersonnaliserData({
    expediteur: expediteurSaved,
    urlAnnonce: urlSaved,
    destinataires: destinatairesSaved
  });
}, []);
```

**Fonctions de mise √† jour** :
```typescript
const updateExpediteur = (value: string) => {
  setPersonnaliserData(prev => ({ ...prev, expediteur: value }));
  localStorage.setItem('key-modifs-sms-expediteur', value);
};

const updateUrlAnnonce = (value: string) => {
  setPersonnaliserData(prev => ({ ...prev, urlAnnonce: value }));
  localStorage.setItem('key-modifs-sms-url', value);
};

const updateDestinataires = (value: string) => {
  setPersonnaliserData(prev => ({ ...prev, destinataires: value }));
  localStorage.setItem('key-modifs-sms-destinataires', value);
};
```

---

### **6.4. Mapping des champs OpenAI ‚Üí Interface**

| **Champ OpenAI (prompt)** | **Cl√© JSON OpenAI** | **Cl√© localStorage Originale** | **Cl√© localStorage Modifs** | **Champ Interface** | **Limite** |
|---------------------------|---------------------|--------------------------------|-----------------------------|---------------------|------------|
| Annonce SMS compl√®te | `restitution-annonce-sms` | `generation_sms_ad` | `key-modifs-creer-campagne-sms` | `restitution-annonce-sms` | 122 car. |
| Exp√©diteur (non OpenAI) | N/A | N/A | `key-modifs-sms-expediteur` | `expediteur` | 10 car. |
| URL (non OpenAI) | N/A | N/A | `key-modifs-sms-url` | `urlAnnonce` | 25 car. |
| Destinataires (non OpenAI) | N/A | N/A | `key-modifs-sms-destinataires` | `destinataires` | N/A |

**Note importante** : Les champs **Exp√©diteur**, **URL** et **Destinataires** ne sont **pas g√©n√©r√©s par OpenAI**. Ils sont ajout√©s manuellement par l'utilisateur dans l'Onglet 2.

---

## **VII. STRUCTURE DES DONN√âES localStorage**

### **7.1. Cl√©s LUES**

| **Cl√© localStorage** | **Type** | **Contenu** | **Utilis√© par** | **Format** |
|----------------------|----------|-------------|-----------------|------------|
| `generation_sms_ad` | JSON | Annonce SMS originale OpenAI | `useRecuperationDataSMS` | `{ "restitution-annonce-sms": "..." }` |
| `key-modifs-creer-campagne-sms` | JSON | Annonce SMS modifi√©e utilisateur | `useRecuperationDataSMS` | `{ "restitution-annonce-sms": "..." }` |
| `key-modifs-sms-expediteur` | String | Exp√©diteur (10 car. max) | `usePersonnaliserChampsSMS`, hooks aper√ßu/copie | `"LeadGenAI"` |
| `key-modifs-sms-url` | String | URL annonce (25 car. max) | `usePersonnaliserChampsSMS`, hooks aper√ßu/copie | `"https://bit.ly/xyz123"` |
| `key-modifs-sms-destinataires` | String | Liste destinataires (futur Brevo) | `usePersonnaliserChampsSMS`, hooks aper√ßu/copie | `"Liste Brevo: Clients Premium"` |

---

### **7.2. Cl√©s √âCRITES**

| **Cl√© localStorage** | **Type** | **√âcrite par** | **Timing sauvegarde** |
|----------------------|----------|----------------|----------------------|
| `key-modifs-creer-campagne-sms` | JSON | `useRecuperationDataSMS.updateAnnonceSMS()` | **Automatique imm√©diate** √† chaque modification du champ annonce SMS |
| `key-modifs-sms-expediteur` | String | `usePersonnaliserChampsSMS.updateExpediteur()` + `GraphismeCompteurCaracteresPersoSMSExpediteur` (useEffect) | **Automatique imm√©diate** √† chaque modification |
| `key-modifs-sms-url` | String | `usePersonnaliserChampsSMS.updateUrlAnnonce()` + `GraphismeCompteurCaracteresPersoSMSURL` (useEffect) | **Automatique imm√©diate** √† chaque modification |
| `key-modifs-sms-destinataires` | String | `usePersonnaliserChampsSMS.updateDestinataires()` + `GraphismeOngletPersonnaliserDestinataires` (useEffect) | **Automatique imm√©diate** √† chaque modification |

---

### **7.3. Interfaces TypeScript compl√®tes**

#### **A. Interface Annonce SMS**
```typescript
interface AnnonceSMSData {
  "restitution-annonce-sms": string; // 122 caract√®res max
}
```

#### **B. Interface Personnalisation**
```typescript
interface PersonnaliserSMSData {
  expediteur: string;       // 10 caract√®res max
  urlAnnonce: string;       // 25 caract√®res max
  destinataires: string;    // Texte libre (futur liste Brevo)
}
```

---

### **7.4. Tableaux r√©capitulatifs**

#### **Tableau 1 : Cl√©s localStorage (lecture/√©criture)**

| **Cl√©** | **Type** | **Lecture** | **√âcriture** | **Priorit√©** |
|---------|----------|-------------|--------------|--------------|
| `generation_sms_ad` | JSON | ‚úÖ | ‚ùå | 2 (originale) |
| `key-modifs-creer-campagne-sms` | JSON | ‚úÖ | ‚úÖ | 1 (modifi√©e) |
| `key-modifs-sms-expediteur` | String | ‚úÖ | ‚úÖ | N/A |
| `key-modifs-sms-url` | String | ‚úÖ | ‚úÖ | N/A |
| `key-modifs-sms-destinataires` | String | ‚úÖ | ‚úÖ | N/A |

---

## **VIII. PROCESSUS COMPLET √âTAPE PAR √âTAPE**

### **8.1. Chargement initial**

1. **Utilisateur acc√®de √† `/etape6communication`** ‚Üí S√©lectionne "Cr√©er une Campagne SMS"
2. **Rendu ``** avec `editMode = false`
3. **Hook `useRecuperationDataSMS`** s'ex√©cute :
   - V√©rifie `key-modifs-creer-campagne-sms`
   - Sinon, lit `generation_sms_ad`
   - Charge l'annonce SMS dans `annonceSMS.restitution-annonce-sms`
4. **Hook `usePersonnaliserChampsSMS`** s'ex√©cute :
   - Lit `key-modifs-sms-expediteur`
   - Lit `key-modifs-sms-url`
   - Lit `key-modifs-sms-destinataires`
   - Charge les 3 champs dans `personnaliserData`
5. **Hook `HookUtiliserApercuAnnonceSMS`** s'ex√©cute :
   - R√©cup√®re toutes les donn√©es depuis localStorage
   - Affiche les 4 aper√ßus en temps r√©el

---

### **8.2. Affichage en mode lecture seule**

**Onglet 1** : Annonce SMS affich√©e via `` (texte brut, non √©ditable)  
**Onglet 2** : 3 champs affich√©s via `` (Exp√©diteur, URL) + `` (Destinataires)  
**Onglet 3** : Aper√ßus affich√©s en lecture seule + boutons Copier/Envoyer

---

### **8.3. Activation du mode √©dition**

1. **Utilisateur clique sur bouton "Modifier"** (Onglet 1 ou 2)
2. **`MenuOngletCampagneSMS.toggleEditMode()`** s'ex√©cute :
   - `setEditMode(true)`
   - Appelle `onEditModeChange(true)`
3. **`AccueilCreerCampagneSMS`** re√ßoit le callback :
   - `setEditMode(true)`
4. **Propagation vers composants enfants** :
   - `File1.AnnonceSMS` re√ßoit `editMode = true` ‚Üí Affiche `GraphismeCompteurCaracteresAnnonceSMS`
   - `File2.PersonnaliserSMS` re√ßoit `editMode = true` ‚Üí Affiche les compteurs de caract√®res

---

### **8.4. Modification des champs**

#### **Annonce SMS (Onglet 1)** :
1. Utilisateur tape dans ``
2. `handleChange(newValue)` s'ex√©cute :
   - Filtrage GSM-7 via `filterValidCharacters()`
   - Comptage caract√®res via `countSMSCharacters()` (‚Ç¨ = 2 car.)
   - Si ‚â§ 122 car. ‚Üí `onChange(filteredValue)`
   - Sinon ‚Üí Blocage (pas de mise √† jour)
3. `File1.AnnonceSMS.handleChange()` s'ex√©cute :
   - Suppression balises HTML via `value.replace(/<\/?[^>]+(>|$)/g, "")`
   - Appel `updateAnnonceSMS({ "restitution-annonce-sms": cleanedValue })`
   - Sauvegarde imm√©diate dans `key-modifs-creer-campagne-sms`

#### **Exp√©diteur (Onglet 2)** :
1. Utilisateur tape dans ``
2. Logique identique avec limite **10 caract√®res**
3. `updateExpediteur(value)` s'ex√©cute ‚Üí Sauvegarde `key-modifs-sms-expediteur`
4. **Double sauvegarde** :
   - Hook `usePersonnaliserChampsSMS.updateExpediteur()`
   - useEffect dans `GraphismeCompteurCaracteresPersoSMSExpediteur`

#### **URL (Onglet 2)** :
1. Utilisateur tape dans ``
2. Logique identique avec limite **25 caract√®res**
3. `updateUrlAnnonce(value)` s'ex√©cute ‚Üí Sauvegarde `key-modifs-sms-url`

---

### **8.5. Sauvegarde automatique**

**Principe fondamental** : **Sauvegarde automatique et imm√©diate** √† chaque modification de champ.

**Aucun bouton "Enregistrer" n√©cessaire** :
- Les donn√©es sont sauvegard√©es dans localStorage d√®s la modification
- Le bouton "Sauvegarder" dans le menu ne fait que :
  1. D√©sactiver le mode √©dition (`setEditMode(false)`)
  2. Afficher un toast de confirmation

**Code du bouton "Sauvegarder"** :
```typescript
const toggleEditMode = () => {
  const newEditMode = !editMode;
  setEditMode(newEditMode);

  if (!newEditMode) { // Si on d√©sactive le mode √©dition
    toast({
      title: "Modifications sauvegard√©es",
      description: "Les changements ont √©t√© enregistr√©s avec succ√®s."
    });
  }
};
```

---

### **8.6. Copie au format Texte**

**Fichier** : `Hook-3-UtiliserCopierTexte.tsx`

**Processus complet** :

1. **Fonction `recupererAnnonceSMS()`** :
   ```typescript
   const donneesModifiees = localStorage.getItem('key-modifs-creer-campagne-sms');
   if (donneesModifiees) {
     return JSON.parse(donneesModifiees)["restitution-annonce-sms"];
   }
   const donneesOriginales = localStorage.getItem('generation_sms_ad');
   if (donneesOriginales) {
     return JSON.parse(donneesOriginales)["restitution-annonce-sms"];
   }
   return '';
   ```

2. **Fonction `recupererExpediteur()`** :
   ```typescript
   return localStorage.getItem('key-modifs-sms-expediteur') || '';
   ```

3. **Fonction `recupererUrlAnnonce()`** :
   ```typescript
   return localStorage.getItem('key-modifs-sms-url') || '';
   ```

4. **Fonction `construireTexteSMS()`** :
   ```typescript
   const expediteur = recupererExpediteur().trim();
   const annonceSMS = recupererAnnonceSMS().trim();
   const urlAnnonce = recupererUrlAnnonce().trim();

   let texteFinal = '';
   if (expediteur) texteFinal += expediteur;
   if (annonceSMS) {
     if (texteFinal) texteFinal += ' ';
     texteFinal += annonceSMS;
   }
   if (urlAnnonce) {
     if (texteFinal) texteFinal += ' ';
     texteFinal += urlAnnonce;
   }
   return texteFinal;
   ```

5. **Fonction `copierTexteSMS()`** :
   ```typescript
   const texteSMS = construireTexteSMS();

   if (texteSMS) {
     navigator.clipboard.writeText(texteSMS).then(() => {
       console.log('SMS copi√©:', texteSMS);
       toast({
         title: "Succ√®s",
         description: "Votre Annonce SMS a √©t√© copi√©e dans le presse-papier",
       });
     }).catch((error) => {
       console.error('Erreur copie:', error);
       toast({
         title: "Erreur",
         description: "Impossible de copier l'annonce SMS",
         variant: "destructive",
       });
     });
   } else {
     toast({
       title: "Attention",
       description: "Aucun contenu SMS disponible",
       variant: "destructive",
     });
   }
   ```

**Exemple de SMS copi√©** :
```
LeadGenAI AV Bar Restaurant. Paris Nord. Licence 4. Emplacement en angle. Fort Potentiel. 331.527‚Ç¨ FAI. Infos->  https://bit.ly/xyz123
```

---

## **IX. SYST√àME D'√âDITION - BOUTON "MODIFIER"**

### **9.1. Localisation**

**Bouton pr√©sent** :
- ‚úÖ **Onglet 1** : Annonce SMS (`MenuOngletCampagneSMS` ‚Üí `TabsContent value="tab1"`)
- ‚úÖ **Onglet 2** : Personnaliser l'Annonce (`MenuOngletCampagneSMS` ‚Üí `TabsContent value="tab2"`)

**Bouton absent** :
- ‚ùå **Onglet 3** : Utiliser l'Annonce (lecture seule uniquement)

---

### **9.2. Comportement toggle (Modifier ‚Üî Sauvegarder)**

**Code du bouton** :
```tsx

  {editMode ? (
    <>

      Sauvegarder

  ) : (
    <>

      Modifier

  )}

```

**Affichage visuel** :
- `editMode = false` ‚Üí Ic√¥ne `` + Texte "Modifier"
- `editMode = true` ‚Üí Ic√¥ne `` + Texte "Sauvegarder"

---

### **9.3. Propagation de l'√©tat**

**Sch√©ma de propagation** :
```
MenuOngletCampagneSMS (editMode local)
  ‚Üì onEditModeChange(newEditMode)
AccueilCreerCampagneSMS (editMode state)
  ‚Üì editMode prop
File1.AnnonceSMS (editMode prop)
  ‚Üì Affichage conditionnel
GraphismeCompteurCaracteresAnnonceSMS OU ReadOnlyField
```

---

### **9.4. Affichage conditionnel**

#### **Onglet 1 : Annonce SMS**
```tsx
{editMode ? (
   handleChange("restitution-annonce-sms", value)}
  />
) : (

)}
```

#### **Onglet 2 : Exp√©diteur**
```tsx
{editMode ? (

) : (

)}
```

---

### **9.5. Nettoyage HTML**

**Annonce SMS (Onglet 1)** :
```typescript
const handleChange = (name: string, value: string) => {
  let cleanedValue = value;
  if (name === "restitution-annonce-sms") {
    cleanedValue = value.replace(/<\/?[^>]+(>|$)/g, ""); // Suppression balises HTML
  }
  updateAnnonceSMS({ [name]: cleanedValue });
};
```

**Champs personnalisation (Onglet 2)** :
- **Pas de nettoyage HTML** : Les champs Exp√©diteur et URL utilisent des `` qui ne g√©n√®rent pas de HTML
- Filtrage uniquement via **caract√®res GSM-7** dans les composants de compteur

---

### **9.6. √âditeur WYSIWYG (EditeurWYSIWYG.tsx)**

**Statut** : **Non utilis√© dans le canal SMS**

**Raison** : Les SMS sont **uniquement en texte brut**. L'√©diteur WYSIWYG (ReactQuill) n'est pas n√©cessaire pour ce canal.

---

## **X. OPTIONS DE COPIE ET ENVOI**

### **10.1. FORMAT TEXTE**

#### **A. Composant `HookUtiliserCopierTexte`**

**Fichier** : `Hook-3-UtiliserCopierTexte.tsx`

**Affichage** :
```tsx
}
  buttonText="Copier l'Annonce SMS"
  buttonIcon={}
  onClick={copierTexteSMS}
/>
```

#### **B. Fonction `copierTexteSMS()`**

**Processus** :
1. R√©cup√®re **Exp√©diteur** (`key-modifs-sms-expediteur`)
2. R√©cup√®re **Annonce SMS** (`key-modifs-creer-campagne-sms` prioritaire, sinon `generation_sms_ad`)
3. R√©cup√®re **URL** (`key-modifs-sms-url`)
4. Construit le **SMS final** : `Expediteur Annonce URL`
5. Copie vers clipboard via `navigator.clipboard.writeText()`
6. Affiche toast de confirmation

**Code complet** :
```typescript
const copierTexteSMS = () => {
  const texteSMS = construireTexteSMS();

  if (texteSMS) {
    navigator.clipboard.writeText(texteSMS).then(() => {
      console.log('SMS copi√©:', texteSMS);
      toast({
        title: "Succ√®s",
        description: "Votre Annonce SMS a √©t√© copi√©e dans le presse-papier",
      });
    }).catch((error) => {
      console.error('Erreur copie:', error);
      toast({
        title: "Erreur",
        description: "Impossible de copier l'annonce SMS",
        variant: "destructive",
      });
    });
  } else {
    toast({
      title: "Attention",
      description: "Aucun contenu SMS disponible",
      variant: "destructive",
    });
  }
};
```

#### **C. Exemple de SMS copi√©**

**Donn√©es source** :
- Exp√©diteur : `"LeadGenAI"`
- Annonce : `"AV Bar Restaurant. Paris Nord. Licence 4. Emplacement en angle. Fort Potentiel. 331.527‚Ç¨ FAI. Infos-> "`
- URL : `"https://bit.ly/xyz123"`

**SMS final copi√©** :
```
LeadGenAI AV Bar Restaurant. Paris Nord. Licence 4. Emplacement en angle. Fort Potentiel. 331.527‚Ç¨ FAI. Infos->  https://bit.ly/xyz123
```

---

### **10.2. ENVOI VERS BREVO**

#### **A. Composant `HookUtiliserFonctionEnvoiBrevo`**

**Fichier** : `Hook-3-UtiliserFonctionEnvoiBrevo.tsx`

**Affichage** :
```tsx
}
  buttonText="Envoyer la campagne"
  buttonIcon={}
  onClick={envoyerCampagneBrevo}
/>
```

#### **B. Fonction `envoyerCampagneBrevo()`**

**Statut actuel** : **INACTIF**

**Code** :
```typescript
const envoyerCampagneBrevo = () => {
  // TODO: Int√©grer la fonction du fichier Hook-3-UtiliserBrevo.tsx
  toast({
    title: "Fonction en pr√©paration",
    description: "L'envoi vers Brevo sera int√©gr√© prochainement",
    variant: "default",
  });
};
```

---

#### **C. Version d√©taill√©e : `HookUtiliserBrevo`**

**Fichier** : `Hook-3-UtiliserBrevo.tsx` (**Non utilis√© actuellement**)

**Contenu** : Pr√©pare les donn√©es au format Brevo

**Fonction `preparerDonneesBrevo()`** :
```typescript
const preparerDonneesBrevo = () => {
  const expediteur = recupererExpediteur().trim();
  const annonceSMS = recupererAnnonceSMS().trim();
  const urlAnnonce = recupererUrlAnnonce().trim();
  const destinataires = recupererDestinataires().trim();

  // Construction du contenu SMS final
  let contenuSMS = '';
  if (expediteur) contenuSMS += expediteur + ' ';
  if (annonceSMS) contenuSMS += annonceSMS + ' ';
  if (urlAnnonce) contenuSMS += urlAnnonce;

  // Format Brevo SMS
  const donneesBrevo = {
    sender: expediteur || 'LeadGenAI',
    recipient: destinataires,
    content: contenuSMS.trim(),
    type: 'transactional', // ou 'marketing'
    tag: 'campagne-sms-leadgenai'
  };

  return donneesBrevo;
};
```

**Fonction `envoyerVersBrevo()`** :
```typescript
const envoyerVersBrevo = () => {
  const donneesBrevo = preparerDonneesBrevo();

  // Validation
  if (!donneesBrevo.content || !donneesBrevo.recipient) {
    toast({
      title: "Donn√©es incompl√®tes",
      description: "Veuillez v√©rifier que le contenu SMS et les destinataires sont renseign√©s",
      variant: "destructive",
    });
    return;
  }

  console.log('Donn√©es pr√©par√©es pour Brevo:', donneesBrevo);

  // TODO: Int√©gration API Brevo
  toast({
    title: "En pr√©paration",
    description: "L'envoi via Brevo sera bient√¥t disponible. Donn√©es pr√©par√©es et enregistr√©es.",
  });
};
```

**Exemple de donn√©es Brevo** :
```json
{
  "sender": "LeadGenAI",
  "recipient": "Liste Brevo: Clients Premium",
  "content": "LeadGenAI AV Bar Restaurant. Paris Nord. Licence 4. Emplacement en angle. Fort Potentiel. 331.527‚Ç¨ FAI. Infos->  https://bit.ly/xyz123",
  "type": "transactional",
  "tag": "campagne-sms-leadgenai"
}
```

---

### **10.3. Logique de formatage d√©taill√©e**

**Construction du SMS final** :
```typescript
const construireTexteSMS = (): string => {
  const expediteur = recupererExpediteur().trim();
  const annonceSMS = recupererAnnonceSMS().trim();
  const urlAnnonce = recupererUrlAnnonce().trim();

  let texteFinal = '';

  // Ajouter l'exp√©diteur s'il existe
  if (expediteur) {
    texteFinal += expediteur;
  }

  // Ajouter l'annonce SMS s'elle existe
  if (annonceSMS) {
    if (texteFinal) {
      texteFinal += ' '; // Ajouter un espace si on a d√©j√† du texte
    }
    texteFinal += annonceSMS;
  }

  // Ajouter l'URL s'elle existe
  if (urlAnnonce) {
    if (texteFinal) {
      texteFinal += ' '; // Ajouter un espace si on a d√©j√† du texte
    }
    texteFinal += urlAnnonce;
  }

  return texteFinal;
};
```

**R√®gles de formatage** :
1. Chaque √©l√©ment est **trim()** pour supprimer les espaces inutiles
2. Les √©l√©ments sont **s√©par√©s par un espace unique**
3. Si un √©l√©ment est vide, il est **ignor√©** (pas d'espace ajout√©)
4. L'ordre est **toujours** : `Expediteur ‚Üí Annonce ‚Üí URL`

---

## **XI. SYST√àME D'APER√áU**

### **11.1. Hook Aper√ßu `HookUtiliserApercuAnnonceSMS`**

**Fichier** : `Hook-3-UtiliserApercuAnnonceSMS.tsx`

**R√¥le** : Affiche **4 aper√ßus en temps r√©el** des donn√©es SMS :
1. **Aper√ßu de l'Annonce SMS**
2. **Rappel de l'Exp√©diteur**
3. **Rappel de l'URL de l'Annonce**
4. **Rappel des Destinataires**

---

### **11.2. Fonctions de r√©cup√©ration**

**Fonction `recupererAnnonceSMS()`** :
```typescript
const recupererAnnonceSMS = () => {
  // Priorit√© 1 : Donn√©es modifi√©es
  const donneesModifiees = localStorage.getItem('key-modifs-creer-campagne-sms');
  if (donneesModifiees) {
    try {
      const parsedData = JSON.parse(donneesModifiees);
      return parsedData["restitution-annonce-sms"] || '';
    } catch (error) {
      console.error('Erreur parsing key-modifs-creer-campagne-sms:', error);
    }
  }

  // Priorit√© 2 : Donn√©es originales
  const donneesOriginales = localStorage.getItem('generation_sms_ad');
  if (donneesOriginales) {
    try {
      const parsedData = JSON.parse(donneesOriginales);
      return parsedData["restitution-annonce-sms"] || '';
    } catch (error) {
      console.error('Erreur parsing generation_sms_ad:', error);
    }
  }

  return '';
};
```

**Fonctions compl√©mentaires** :
```typescript
const recupererExpediteur = () => {
  return localStorage.getItem('key-modifs-sms-expediteur') || '';
};

const recupererUrlAnnonce = () => {
  return localStorage.getItem('key-modifs-sms-url') || '';
};

const recupererDestinataires = () => {
  return localStorage.getItem('key-modifs-sms-destinataires') || '';
};
```

---

### **11.3. Mise √† jour en temps r√©el**

**Chargement initial** :
```typescript
useEffect(() => {
  setAnnonceSMS(recupererAnnonceSMS());
  setExpediteur(recupererExpediteur());
  setUrlAnnonce(recupererUrlAnnonce());
  setDestinataires(recupererDestinataires());
}, []);
```

**√âcoute des changements** :
```typescript
useEffect(() => {
  const handleStorageChange = () => {
    setAnnonceSMS(recupererAnnonceSMS());
    setExpediteur(recupererExpediteur());
    setUrlAnnonce(recupererUrlAnnonce());
    setDestinataires(recupererDestinataires());
  };

  // √âcouter les changements de localStorage (multi-onglets)
  window.addEventListener('storage', handleStorageChange);

  // V√©rifier p√©riodiquement les changements (m√™me page)
  const interval = setInterval(handleStorageChange, 1000);

  return () => {
    window.removeEventListener('storage', handleStorageChange);
    clearInterval(interval);
  };
}, []);
```

**M√©canisme double** :
1. **Event listener `storage`** : D√©tecte les changements dans **d'autres onglets** du navigateur
2. **Interval 1000ms** : V√©rifie les changements dans **le m√™me onglet** (car l'event `storage` ne se d√©clenche pas sur la page qui fait le changement)

---

### **11.4. Affichage des aper√ßus**

**Code de rendu** :
```tsx
return (

    {/* Aper√ßu de l'Annonce SMS */}

      {annonceSMS ? (

          {annonceSMS}

      ) : (

          Aucune annonce SMS disponible

      )}

    {/* Rappel de l'Exp√©diteur */}

      {expediteur ? (

           {expediteur}

      ) : (

          Aucun exp√©diteur d√©fini

      )}

    {/* Rappel de l'URL */}

      {urlAnnonce ? (

           {urlAnnonce}

      ) : (

          Aucune URL d√©finie

      )}

    {/* Rappel des Destinataires */}

      {destinataires ? (

          Destinataires : {destinataires}

      ) : (

          {/* Vide */}

      )}

);
```

---

## **XII. CONTRAINTES ET VALIDATION**

### **12.1. Validation des champs**

#### **A. Annonce SMS (122 caract√®res max)**

**Composant** : `GraphismeCompteurCaracteresAnnonceSMS.tsx`

**Contraintes** :
- ‚úÖ **Maximum 122 caract√®res** (comptage sp√©cial GSM-7)
- ‚úÖ **Caract√®res GSM-7 uniquement** (filtrage automatique)
- ‚úÖ **Symbole ‚Ç¨ = 2 caract√®res**
- ‚úÖ **Blocage au d√©passement** (pas d'ajout au-del√† de 122)
- ‚ùå **Emojis interdits**
- ‚ùå **Caract√®res sp√©ciaux interdits** : `\ [ ] { } ~ ^ |`

**Regex GSM-7** :
```typescript
const GSM7_CHARS = /^[A-Za-z0-9\s\.,@√®√©√π√á√â!"%&'()*+\-\/:;<=>?¬°√Ñ√ñ√ú√§√∂√º√†‚Ç¨]*$/;
```

**Fonction de comptage** :
```typescript
const countSMSCharacters = (text: string): number => {
  let count = 0;
  for (const char of text) {
    if (char === '‚Ç¨') {
      count += 2; // Euro = 2 caract√®res
    } else {
      count += 1;
    }
  }
  return count;
};
```

**Fonction de filtrage** :
```typescript
const filterValidCharacters = (text: string): string => {
  return text.split('').filter(char => {
    return GSM7_CHARS.test(char);
  }).join('');
};
```

**Gestion du changement** :
```typescript
const handleChange = (newValue: string) => {
  const filteredValue = filterValidCharacters(newValue);
  const characterCount = countSMSCharacters(filteredValue);

  if (characterCount <= MAX_CHARACTERS) {
    onChange(filteredValue);
  }
  // Si > 122, blocage (pas de mise √† jour)
};
```

**Indicateur visuel** : `CircularProgress` avec couleurs :
- ‚â§ 100 car. ‚Üí Violet (`#6358DE`)
- 101-115 car. ‚Üí Orange (`#f59e0b`)
- 116-122 car. ‚Üí Rouge (`#ef4444`)

---

#### **B. Exp√©diteur (10 caract√®res max)**

**Composant** : `GraphismeCompteurCaracteresPersoSMSExpediteur.tsx`

**Contraintes** :
- ‚úÖ **Maximum 10 caract√®res**
- ‚úÖ **Caract√®res GSM-7 uniquement**
- ‚úÖ **Symbole ‚Ç¨ = 2 caract√®res**
- ‚úÖ **Blocage au d√©passement**

**Indicateur visuel** :
- ‚â§ 8 car. ‚Üí Violet
- 9 car. ‚Üí Orange
- 10 car. ‚Üí Rouge

---

#### **C. URL (25 caract√®res max)**

**Composant** : `GraphismeCompteurCaracteresPersoSMSURL.tsx`

**Contraintes** :
- ‚úÖ **Maximum 25 caract√®res**
- ‚úÖ **Caract√®res GSM-7 uniquement**
- ‚úÖ **Symbole ‚Ç¨ = 2 caract√®res**
- ‚úÖ **Blocage au d√©passement**

**Placeholder** : `"25 caract√®res maximum. Utiliser un r√©ducteur d'url si le nombre de caract√®res est sup√©rieur"`

**Indicateur visuel** :
- ‚â§ 20 car. ‚Üí Violet
- 21-23 car. ‚Üí Orange
- 24-25 car. ‚Üí Rouge

---

### **12.2. Gestion des erreurs (loading, error)**

**Hook `useRecuperationDataSMS`** :
```typescript
const [isLoading, setIsLoading] = useState(true);
const [error, setError] = useState(null);
```

**Affichage conditionnel** (dans `File1.AnnonceSMS.tsx`) :
```tsx
if (isLoading) {
  return Chargement des donn√©es...;
}

if (error) {
  return {error};
}
```

---

### **12.3. Toasts de notification**

**Succ√®s (copie SMS)** :
```typescript
toast({
  title: "Succ√®s",
  description: "Votre Annonce SMS a √©t√© copi√©e dans le presse-papier",
});
```

**Erreur (copie √©chou√©e)** :
```typescript
toast({
  title: "Erreur",
  description: "Impossible de copier l'annonce SMS",
  variant: "destructive",
});
```

**Attention (aucun contenu)** :
```typescript
toast({
  title: "Attention",
  description: "Aucun contenu SMS disponible √† copier",
  variant: "destructive",
});
```

**Fonction inactive** :
```typescript
toast({
  title: "Fonction en pr√©paration",
  description: "L'envoi vers Brevo sera int√©gr√© prochainement",
  variant: "default",
});
```

**Sauvegarde confirm√©e** :
```typescript
toast({
  title: "Modifications sauvegard√©es",
  description: "Les changements ont √©t√© enregistr√©s avec succ√®s."
});
```

---

### **12.4. S√©curit√©**

**Risques identifi√©s** :

1. **Injection HTML** : 
   - ‚úÖ **Mitig√©** par le nettoyage via `value.replace(/<\/?[^>]+(>|$)/g, "")`
   - ‚ö†Ô∏è Le SMS ne supporte pas le HTML, donc risque limit√©

2. **Caract√®res sp√©ciaux** :
   - ‚úÖ **Prot√©g√©** par le filtrage GSM-7 strict
   - ‚úÖ Les caract√®res non autoris√©s sont **automatiquement supprim√©s**

3. **localStorage** :
   - ‚ö†Ô∏è Accessible en lecture/√©criture par tout script de la page
   - ‚ö†Ô∏è Donn√©es non chiffr√©es
   - üìå **Migration Supabase recommand√©e** pour s√©curiser les donn√©es

---

## **XIII. COMPOSANTS GRAPHIQUES R√âUTILISABLES**

### **13.1. LabelField**

**Fichier** : `GraphismeInterieurCampagneSMS.tsx`

**Utilisation** :
```tsx
Annonce SMS
```

**Props** :
```typescript
interface LabelFieldProps {
  htmlFor: string;
  children: ReactNode;
  className?: string;
}
```

**Rendu** :
```tsx

  {children}

```

---

### **13.2. ReadOnlyField**

**Utilisation** :
```tsx

```

**Props** :
```typescript
interface ReadOnlyFieldProps {
  id: string;
  content: string;
  isDescriptif?: boolean;
  className?: string;
}
```

**Rendu** :
```tsx

  {isDescriptif ? (

  ) : (
    {content}
  )}

```

**Gestion HTML** :
- `isDescriptif = false` (par d√©faut) ‚Üí Texte brut avec `whitespace-pre-line`
- `isDescriptif = true` ‚Üí HTML rendu via `dangerouslySetInnerHTML`

---

### **13.3. EditableField**

**Utilisation** :
```tsx
 handleChange("restitution-annonce-sms", value)}
  rows={3}
/>
```

**Props** :
```typescript
interface EditableFieldProps {
  id: string;
  value: string;
  onChange: (value: string) => void;
  rows?: number;
  className?: string;
  useWysiwyg?: boolean;
}
```

**Rendu** :
```tsx
{useWysiwyg ? (

) : (
   onChange(e.target.value)} 
    className={cn("w-full rounded-md border border-gray-200 p-3", className)}
    rows={rows}
  />
)}
```

**Note** : Dans le canal SMS, `useWysiwyg` n'est **jamais utilis√©** (texte brut uniquement).

---

### **13.4. CopyOption**

**Utilisation** :
```tsx
<CopyOption
  title="Copier au Format Texte"
  description="Format pour √™tre copi√© dans votre logiciel d'envoi de sms"
  icon={<FileText className="h-5 w-5" />}
  buttonText="Copier l'Annonce SMS"
  buttonIcon={<FileText className="mr-2 h-4 w-4" />}
  onClick={copierTexteSMS}
/>
```

**Props** :
```typescript
interface CopyOptionProps {
  title: string;
  description: string;
  icon: React.ReactNode;
  buttonText: string;
  buttonIcon: React.ReactNode;
  onClick: () => void;
  className?: string;
}
```

**Rendu** :
```tsx
<div className={cn("border-l-4 border-l-realestate-mauve bg-white p-4 rounded-r-lg shadow-sm hover:shadow-md transition-all", className)}>
  <div className="flex items-start mb-3">
    <div className="p-2 rounded-lg bg-realestate-purple-light text-realestate-purple-dark mr-3">
      {icon}
    </div>
    <div>
      <h4 className="font-semibold">{title}</h4>
      <p className="text-sm text-gray-600">{description}</p>
    </div>
  </div>
  <Button onClick={onClick} className="w-full bg-realestate-mauve hover:bg-realestate-mauve-dark text-white">
    {buttonIcon}
    {buttonText}
  </Button>
</div>
```

---

### **13.5. AnnoncePreview**

**Utilisation** :
```tsx
<AnnoncePreview title="Aper√ßu de l'Annonce SMS" className="max-h-40">
  {annonceSMS ? (
    <div className="text-sm whitespace-pre-line">{annonceSMS}</div>
  ) : (
    <div className="text-gray-500 text-sm italic">
      Aucune annonce SMS disponible
    </div>
  )}
</AnnoncePreview>
```

**Props** :
```typescript
interface AnnoncePreviewProps {
  title: string;
  className?: string;
  children?: ReactNode;
}
```

**Rendu** :
```tsx
<div className={cn("mt-6 p-4 bg-realestate-purple-light/10 border border-realestate-purple-light rounded-lg", className)}>
  <h4 className="font-semibold mb-2">{title}</h4>
  <div className="bg-white p-4 rounded border border-gray-200 overflow-y-auto">
    {children}
  </div>
</div>
```

**Caract√©ristique** : **Hauteur automatique** (`overflow-y-auto`), contrairement √† d'autres composants qui ont des hauteurs fixes.

---

## **XIV. TABLEAUX R√âCAPITULATIFS**

### **14.1. Tableau des champs - Annonce SMS**

| **Champ** | **Cl√© JSON** | **Type** | **Limite** | **Source OpenAI** | **localStorage Originale** | **localStorage Modifs** | **Nettoyage HTML** | **Filtrage GSM-7** |
|-----------|--------------|----------|------------|-------------------|----------------------------|-------------------------|--------------------|-------------------|
| Annonce SMS | `restitution-annonce-sms` | String | 122 car. | ‚úÖ | `generation_sms_ad` | `key-modifs-creer-campagne-sms` | ‚úÖ | ‚úÖ |

---

### **14.2. Tableau des champs - Personnalisation**

| **Champ** | **Type** | **Limite** | **Source OpenAI** | **localStorage** | **Composant √©dition** | **Filtrage GSM-7** | **Sauvegarde auto** |
|-----------|----------|------------|-------------------|--------------------|----------------------|-------------------|---------------------|
| Exp√©diteur | String | 10 car. | ‚ùå | `key-modifs-sms-expediteur` | `GraphismeCompteurCaracteresPersoSMSExpediteur` | ‚úÖ | ‚úÖ |
| URL de l'Annonce | String | 25 car. | ‚ùå | `key-modifs-sms-url` | `GraphismeCompteurCaracteresPersoSMSURL` | ‚úÖ | ‚úÖ |
| Liste des Destinataires | String | N/A | ‚ùå | `key-modifs-sms-destinataires` | `GraphismeOngletPersonnaliserDestinataires` (disabled) | ‚ùå | ‚úÖ |

---

### **14.3. Tableau des hooks**

| **Hook** | **Fichier** | **R√¥le principal** | **Donn√©es retourn√©es** | **Lecture localStorage** | **√âcriture localStorage** |
|----------|-------------|-------------------|------------------------|-------------------------|--------------------------|
| `useRecuperationDataSMS` | `Hook-1-RecuperationDataSMS.ts` | R√©cup√®re annonce SMS (priorit√© modifs > originales) | `annonceSMS`, `updateAnnonceSMS`, `isLoading`, `error` | ‚úÖ `generation_sms_ad`, `key-modifs-creer-campagne-sms` | ‚úÖ `key-modifs-creer-campagne-sms` |
| `usePersonnaliserChampsSMS` | `Hook-2-PersonnaliserChamps.tsx` | G√®re les 3 champs de personnalisation | `personnaliserData`, `updateExpediteur`, `updateUrlAnnonce`, `updateDestinataires`, `getAllData` | ‚úÖ `key-modifs-sms-expediteur`, `key-modifs-sms-url`, `key-modifs-sms-destinataires` | ‚úÖ (idem) |

---

### **14.4. Tableau des fonctions de copie/envoi**

| **Fonction** | **Fichier** | **Type** | **Donn√©es r√©cup√©r√©es** | **Action finale** | **Statut** |
|--------------|-------------|----------|------------------------|-------------------|-----------|
| `copierTexteSMS()` | `Hook-3-UtiliserCopierTexte.tsx` | Copie texte | Exp√©diteur + Annonce + URL | `navigator.clipboard.writeText()` | ‚úÖ Actif |
| `envoyerCampagneBrevo()` | `Hook-3-UtiliserFonctionEnvoiBrevo.tsx` | Envoi Brevo | N/A | Toast "Fonction en pr√©paration" | ‚ùå Inactif |
| `envoyerVersBrevo()` | `Hook-3-UtiliserBrevo.tsx` | Envoi Brevo d√©taill√© | Exp√©diteur + Annonce + URL + Destinataires | `preparerDonneesBrevo()` + Toast | ‚ùå Inactif (non utilis√©) |

---

### **14.5. Matrice Onglets √ó Actions √ó Fichiers**

| **Onglet** | **Action disponible** | **Fichier principal** | **Composant √©dition** | **Bouton Modifier** | **Sauvegarde auto** |
|------------|----------------------|----------------------|----------------------|--------------------|--------------------|
| **1. Annonce SMS** | √âditer annonce SMS (122 car.) | `File1.AnnonceSMS.tsx` | `GraphismeCompteurCaracteresAnnonceSMS` | ‚úÖ | ‚úÖ |
| **2. Personnaliser l'Annonce** | √âditer Exp√©diteur (10 car.) | `File2.PersonnaliserSMS.tsx` | `GraphismeCompteurCaracteresPersoSMSExpediteur` | ‚úÖ | ‚úÖ |
| | √âditer URL (25 car.) | `File2.PersonnaliserSMS.tsx` | `GraphismeCompteurCaracteresPersoSMSURL` | ‚úÖ | ‚úÖ |
| | Visualiser Destinataires | `File2.PersonnaliserSMS.tsx` | `GraphismeOngletPersonnaliserDestinataires` (disabled) | ‚úÖ | ‚úÖ |
| **3. Utiliser l'Annonce** | Voir 4 aper√ßus | `File3.ActionUtilisateurSMS.tsx` | `HookUtiliserApercuAnnonceSMS` | ‚ùå | N/A |
| | Copier SMS texte | `File3.ActionUtilisateurSMS.tsx` | `HookUtiliserCopierTexte` | ‚ùå | N/A |
| | Envoyer vers Brevo | `File3.ActionUtilisateurSMS.tsx` | `HookUtiliserFonctionEnvoiBrevo` | ‚ùå | N/A |

---

## **XV. DONN√âES √Ä PRENDRE EN CONSID√âRATION**

### **15.1. Points d'attention techniques**

#### **A. Comptage sp√©cial GSM-7**
- **Symbole ‚Ç¨** compte pour **2 caract√®res**
- **Espace** compte pour **1 caract√®re**
- **Tous les autres caract√®res GSM-7** comptent pour **1 caract√®re**

**Exemple pratique** :
```
"AV Bar. Lyon. 125.000‚Ç¨ FAI"
= 27 caract√®res (dont ‚Ç¨ = 2 car.)
```

#### **B. Double sauvegarde localStorage**

Les champs de personnalisation (Exp√©diteur, URL, Destinataires) sont sauvegard√©s **deux fois** :
1. Via le hook `usePersonnaliserChampsSMS` (dans les fonctions `updateXXX()`)
2. Via les `useEffect` dans les composants `GraphismeCompteurCaracteresPersoSMSXXX`

**Raison** : Garantir la persistance m√™me si le hook n'est pas mont√©.

#### **C. Mise √† jour en temps r√©el des aper√ßus**

Le composant `HookUtiliserApercuAnnonceSMS` utilise **deux m√©canismes** pour d√©tecter les changements :
1. **Event listener `storage`** : Pour les changements dans d'autres onglets
2. **Interval 1000ms** : Pour les changements dans le m√™me onglet

**Probl√®me potentiel** : L'interval peut causer une l√©g√®re latence de 1 seconde maximum.

---

### **15.2. D√©pendances critiques**

#### **A. localStorage**

**Totale d√©pendance** √† localStorage pour :
- Stockage des donn√©es OpenAI (`generation_sms_ad`)
- Stockage des modifications (`key-modifs-creer-campagne-sms`)
- Stockage des champs de personnalisation (3 cl√©s)

**Risques** :
- ‚ö†Ô∏è Donn√©es perdues si localStorage est vid√©
- ‚ö†Ô∏è Limite de 5-10 MB par domaine
- ‚ö†Ô∏è Pas de synchronisation multi-utilisateur
- ‚ö†Ô∏è Pas de s√©curit√©/chiffrement

#### **B. Prompt OpenAI**

**Fichier** : `src/services/openai/1.GenerateurAnnoncesOutilsSeo/7.PromptsOpenAi/5.PromptSMSAnnonce.ts`

**Contraintes impos√©es par le prompt** :
- Structure SMS obligatoire : `(TYPE TRANSACTION) (TYPE BIEN). (EMPLACEMENT). (ATOUTS) (MONTANT ‚Ç¨) Infos-> `
- Limite stricte de **122 caract√®res**
- Utilisation du jeu de caract√®res GSM-7
- Formatage sp√©cifique des montants (FAI pour vente, /ms pour location)
- CTA obligatoire : `Infos-> ` (8 caract√®res)

**Importance** : Le prompt doit √™tre **strictement respect√©** pour garantir la compatibilit√© avec le syst√®me de validation GSM-7.

---

### **15.3. Fonctions cl√©s √† pr√©server**

#### **A. Logique de priorit√© (modifs > originales)**

**Code √† conserver absolument** :
```typescript
// PRIORIT√â 1 : Donn√©es modifi√©es
const modifiedDataJson = localStorage.getItem('key-modifs-creer-campagne-sms');

if (modifiedDataJson) {
  const modifiedData = JSON.parse(modifiedDataJson);
  setAnnonceSMS({ "restitution-annonce-sms": modifiedData["restitution-annonce-sms"] || '' });
} else {
  // PRIORIT√â 2 : Donn√©es originales
  const annonceSMSData = localStorage.getItem('generation_sms_ad');
  // ...
}
```

**Migration Supabase** : Cette logique doit √™tre recr√©√©e avec `COALESCE()` en SQL.

#### **B. Fonction `countSMSCharacters()`**

**Code essentiel** :
```typescript
const countSMSCharacters = (text: string): number => {
  let count = 0;
  for (const char of text) {
    if (char === '‚Ç¨') {
      count += 2; // Euro = 2 caract√®res
    } else {
      count += 1;
    }
  }
  return count;
};
```

**Importance** : Cette fonction garantit le **comptage conforme aux r√®gles SMS GSM-7**.

#### **C. Fonction `filterValidCharacters()`**

**Code essentiel** :
```typescript
const GSM7_CHARS = /^[A-Za-z0-9\s\.,@√®√©√π√á√â!"%&'()*+\-\/:;<=>?¬°√Ñ√ñ√ú√§√∂√º√†‚Ç¨]*$/;

const filterValidCharacters = (text: string): string => {
  return text.split('').filter(char => {
    return GSM7_CHARS.test(char);
  }).join('');
};
```

**Importance** : Garantit que **seuls les caract√®res GSM-7 autoris√©s** sont accept√©s.

#### **D. Fonction `construireTexteSMS()`**

**Code essentiel** :
```typescript
const construireTexteSMS = (): string => {
  const expediteur = recupererExpediteur().trim();
  const annonceSMS = recupererAnnonceSMS().trim();
  const urlAnnonce = recupererUrlAnnonce().trim();

  let texteFinal = '';
  if (expediteur) texteFinal += expediteur;
  if (annonceSMS) {
    if (texteFinal) texteFinal += ' ';
    texteFinal += annonceSMS;
  }
  if (urlAnnonce) {
    if (texteFinal) texteFinal += ' ';
    texteFinal += urlAnnonce;
  }
  return texteFinal;
};
```

**Importance** : Construit le SMS final dans le **bon ordre** avec **gestion correcte des espaces**.

---

### 15.4. Mapping OpenAI ‚Üí Interface
**‚ö†Ô∏è PARTICULARIT√â :** Le canal SMS n'a **qu'un seul champ** pour l'annonce.
**Raison :** Contrainte de format SMS (122 caract√®res maximum)

**Mapping (simplifi√©) :**

| Champ OpenAI (`generation_sms_ad`) | Champ Interface (`AnnonceSMSData`) | Fichier | Ligne |
|-------------------------------------|-------------------------------------|---------|-------|
| `annonceSMS` | `annonceSMS` | `Hook-1-RecuperationDataSMS.ts` | 41 |

**Champs de personnalisation (non g√©n√©r√©s par OpenAI) :**

| Champ localStorage | Champ Interface | Fichier | Ligne |
|--------------------|-----------------|---------|-------|
| `key-modifs-sms-expediteur` | `expediteur` | `Hook-2-PersonnaliserChampsSMS.ts` | 38 |
| `key-modifs-sms-url` | `url` | `Hook-2-PersonnaliserChampsSMS.ts` | 39 |
| `key-modifs-sms-destinataires` | `destinataires` | `Hook-2-PersonnaliserChampsSMS.ts` | 40 |

**Diff√©rence avec les autres canaux :**
- **Site Internet / Portails** : 4-5 champs avec mapping `cta` ‚Üí `appelAction`
- **Newsletter** : 5 champs sans mapping
- **SMS** : **1 seul champ g√©n√©r√©** + 3 champs de personnalisation

**Prompt OpenAI (r√©f√©rence) :**
```typescript
// src/services/openai/1.GenerateurAnnoncesOutilsSeo/7.PromptsOpenAi/5.PromptSMSAnnonce.ts

export const promptSMSAnnonce = `
...
RESTITUTION
R√©ponds uniquement avec un objet JSON au format suivant (sans backticks, ni code fence):
{
  "annonceSMS": "Texte de l'annonce SMS (max 122 caract√®res GSM-7)"
}
...
`;
```

**‚ö†Ô∏è Points d'attention critiques :**
- Le champ `annonceSMS` respecte la contrainte de **122 caract√®res** (encodage GSM-7)
- Les champs de personnalisation (`expediteur`, `url`, `destinataires`) sont **ind√©pendants** d'OpenAI
- Le champ `destinataires` est actuellement **d√©sactiv√©** (en attente de l'int√©gration Brevo)
---


**Points cl√©s du canal SMS** :
1. **Annonce SMS** : 122 caract√®res max, filtrage GSM-7 strict, comptage sp√©cial (‚Ç¨ = 2 car.)
2. **3 champs personnalisation** : Exp√©diteur (10 car.), URL (25 car.), Destinataires (futur Brevo)
3. **Sauvegarde automatique** : Imm√©diate √† chaque modification (pas de bouton "Enregistrer" n√©cessaire)
4. **Copie format texte** : Construction `Expediteur + Annonce + URL` ‚Üí `navigator.clipboard`
5. **Envoi Brevo** : Fonction pr√©par√©e mais **inactive** (toast "En pr√©paration")

