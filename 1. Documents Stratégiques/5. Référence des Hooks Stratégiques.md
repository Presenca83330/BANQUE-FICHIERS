# ğŸ“Œ RÃ©fÃ©rence des Hooks StratÃ©giques â€“ LeadGenAi

## ğŸ” N1 â€“ useAuth
**RÃ´le :** GÃ¨re uniquement lâ€™authentification Supabase.
- Connexion email/password.
- Connexion Google (sans signup).
- DÃ©connexion.
- Gestion centralisÃ©e des erreurs.
- Ã‰tat session (user, loading, error).

**Fichiers :**
- `authMessages.ts` â†’ mappe les erreurs dâ€™authentification en messages clairs.
- `authTypes.ts` â†’ contient `AuthUser`, `AuthSession`, `AuthResponse`, `AuthResult`.
- `useAuth.ts` â†’ hook principal (login/logout/Google Auth, session).

**DÃ©pendances :** `@/integrations/supabase/client`

---

## ğŸ‘¤ N2 â€“ useCurrentUser
**RÃ´le :** Source de vÃ©ritÃ© sur le profil utilisateur enrichi.
- Charge dâ€™abord `utilisateurs` (profil mÃ©tier).
- Enrichit avec `users` (profil systÃ¨me).
- VÃ©rifie statut actif (bloque inactifs/suspendus).
- Retourne un `CurrentUser` complet.

**Fichiers :**
- `helpers.ts` â†’ utilitaires (normalizeEmail, isAdminPresenca, etc.).
- `types.ts` â†’ contient `CurrentUser` (alignÃ© DB).
- `useCurrentUser.ts` â†’ hook principal (profil enrichi, reload, erreurs).

**DÃ©pendances :** `@/integrations/supabase/client`

---

## ğŸ¢ N3 â€“ useMultiTenant
**RÃ´le :** DÃ©cide des redirections post-login.
- VÃ©rifie statut utilisateur et organisation.
- Routes dÃ©finies :
  - `admin_presenca` / `superadmin` â†’ `/admin-presenca`
  - `reseau` / `reseau_direction` â†’ `/espace-reseau`
  - autres â†’ `/accueil-leadgenai`
- Fallback â†’ `/login`.

**Fichiers :**
- `useMultiTenant.ts` â†’ hook principal (getPostLoginRoute).

**DÃ©pendances :** `useCurrentUser`

---

## âš™ï¸ N4 â€“ useSupabaseOperations
**RÃ´le :** Fournit une API CRUD gÃ©nÃ©rique sÃ©curisÃ©e.
- `select` â†’ lecture multi-tenant.
- `insert` â†’ ajoute automatiquement organisation_id.
- `update` â†’ sÃ©curisÃ©, vÃ©rifie statut actif.
- `remove` â†’ suppression sÃ©curisÃ©e.
- Gestion centralisÃ©e des erreurs.

**Fichiers :**
- `errors.ts` â†’ mappe erreurs DB (RLS, permissions, org).
- `helpers.ts` â†’ utilitaires (isEmpty, isSuspended, etc.).
- `tableMapping.ts` â†’ mapping front â†’ tables Supabase (toutes les tables de la base doivent Ãªtre listÃ©es).
- `types.ts` â†’ contient `OperationResult<T>`.
- `useSupabaseOperations.ts` â†’ hook principal (CRUD gÃ©nÃ©rique).

**DÃ©pendances :** `useCurrentUser`, `@/integrations/supabase/client`

---

# âœ… Vue dâ€™ensemble
- **useAuth** â†’ gÃ¨re la connexion/dÃ©connexion uniquement.
- **useCurrentUser** â†’ construit lâ€™utilisateur enrichi (pivot mÃ©tier).
- **useMultiTenant** â†’ dÃ©cide de la route post-login.
- **useSupabaseOperations** â†’ centralise toutes les opÃ©rations DB multi-tenant.

Chaque hook est simple, spÃ©cialisÃ©, et validÃ© âœ… pour une architecture **production-ready**.

