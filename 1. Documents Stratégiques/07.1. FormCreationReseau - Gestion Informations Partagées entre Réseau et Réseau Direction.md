# 7.1.1. Stratégie – Gestion des informations partagées entre Réseau et Réseau Direction dans le Formulaire de Création 
- src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/2.FormReseauCreation.tsx
  

## 🎯 Contexte
Dans ton modèle actuel, deux entités sont intimement liées :
- **Table `reseau`** : représente l’entité juridique / organisationnelle du réseau (raison sociale, SIRET, adresse, etc.).
- **Table `reseau_direction`** : représente la **personne responsable** du réseau (nom, prénom, email, téléphone).

Lors de la création d’un réseau, il est obligatoire de créer **simultanément** :
1. L’organisation (dans `organisations`).
2. Le réseau (`reseau`).
3. Le responsable du réseau (`reseau_direction` + entrée `users` + entrée `utilisateurs`).

## 📌 Infos partagées
Certains champs apparaissent comme « doublons » si on ne fait pas attention :

| Champ                | Où il doit être stocké | Pourquoi |
|-----------------------|------------------------|----------|
| **Nom du réseau**     | `reseau.reseau_nom` + `organisations.organisation_nom` | Identité de l’entité juridique. |
| **SIRET**             | `reseau.reseau_siret` | Spécifique au réseau. |
| **Adresse, CP, Ville**| `reseau.reseau_adresse`, `reseau.reseau_code_postal`, `reseau.reseau_ville` | Données de localisation de l’entité. |
| **Nom responsable**   | `users_nom`, `reseau_direction.nom` | Identité du directeur. |
| **Prénom responsable**| `users_prenom`, `reseau_direction.prenom` | Idem. |
| **Email responsable** | `users_email`, `utilisateur_email` | Sert aussi d’auth Supabase. |
| **Téléphone responsable** | `users_telephone` | Contact direct du directeur. |

👉 **Conclusion** :  
- Les infos **organisationnelles** (nom réseau, adresse, SIRET) restent dans `reseau`.  
- Les infos **personnelles** (nom, prénom, email, téléphone) restent dans `reseau_direction` + `users` + `utilisateurs`.  

## 🚨 Risque identifié
Si le formulaire demande séparément **email réseau** et **email responsable**, l’admin peut saisir deux valeurs différentes → incohérence.  
Idem pour téléphone.

## ✅ Solution retenue
- **Formulaire de création unique** (FormReseauCreation) :
  - Nom réseau + SIRET + adresse → `reseau`.
  - Nom/prénom/email/téléphone responsable → `reseau_direction` (et automatiquement `users` + `utilisateurs`).
- Pas de champ **email réseau** ou **téléphone réseau** séparé au moment de la création : on considère que le contact principal = directeur du réseau.
- Si plus tard on veut ajouter un **email générique du réseau** (ex. contact@reseau.com), ce sera un champ optionnel dans `reseau`, géré via la page de gestion, pas à la création.

## 🛠️ Implémentation
1. **Mapping des champs dans le hook `useCreationCompte`** :
   - `nomReseau`, `siret`, `adresse`, `codePostal`, `ville` → table `reseau`.
   - `nomResponsable`, `prenomResponsable`, `emailResponsable`, `telephoneResponsable` → table `reseau_direction` + `users` + `utilisateurs`.
2. **Formulaire** :
   - Champs présentés dans l’ordre logique pour l’admin.
   - Préheaders pour clarifier : (Raison sociale), (Nom Direction Réseau), etc.
3. **Hooks** :
   - Lors de la soumission → création en cascade :
     1. Organisation → 2. Réseau → 3. User/Utilisateur → 4. Reseau_Direction.
   - Reliés par `organisation_id` et `reseau_id`.

## 📊 Avantages
- Évite les doublons.
- Cohérence multi-tenant respectée (chaque user lié à son réseau et organisation).
- Clarifie pour l’admin la distinction entre **identité juridique du réseau** et **identité personnelle du directeur**.
- Évolutif : possibilité d’ajouter un **email générique réseau** plus tard.

---
## 📌 Gestion des coordonnées (email & téléphone) lors de la création d’un réseau
Lors de la **création initiale d’un réseau**, il est obligatoire d’associer immédiatement un utilisateur humain qui incarne ce réseau → c’est le **Directeur de Réseau (reseau_direction)**.  
Ce directeur doit exister dès le départ car **Supabase Auth** exige qu’au moins un compte utilisateur actif soit créé pour rattacher l’organisation. 
Sans cela, on aurait une organisation sans utilisateur connecté, ce qui est bloquant.

👉 Par conséquent :  
- Les champs **email** et **téléphone** saisis dans le formulaire de création réseau sont utilisés à la fois comme :  
  - **coordonnées contractuelles du réseau** (stockées dans la table `reseau`),  
  - **coordonnées personnelles du directeur** (stockées dans `reseau_direction` + `users` + `utilisateurs`).  
- Lors de la création, ces deux ensembles de données sont initialisés avec **la même valeur**, afin d’assurer la cohérence.

### Vision simplifiée
- **Réseau** = entité contractuelle  
- **Réseau Direction** = l’utilisateur humain qui incarne ce réseau et qui a signé avec Présença 
- Les deux sont liés et partagent le même espace applicatif (**RESEAU-ESPACE**).  
👉 Donc :  
- Email / Téléphone = coordonnées contractuelles du réseau, incarnées par son directeur.  
- Un seul formulaire suffit à la création → pas besoin d’entretenir deux flux distincts.  

### Modèle opérationnel
- **Création Réseau**  
  - L’admin saisit un email et un téléphone.  
  - Ces valeurs sont stockées dans `reseau`.  
  - Elles sont automatiquement répliquées dans `reseau_direction` pour créer le compte utilisateur Auth.  

- **Gestion Réseau (formulaire commun)**  
  - Si l’email ou le téléphone du réseau est modifié, la mise à jour est automatiquement propagée vers `reseau_direction`.  
  - Le formulaire Réseau devient le **point de vérité unique**.  

- **Gestion Réseau Direction**  
  - Pas de modification possible sur email et téléphone → les champs sont en lecture seule côté Direction.  
  - Le directeur peut les consulter mais ne peut pas les changer indépendamment.  


---
# 7.1.2. Stratégie – Gestion des informations partagées entre Réseau et Réseau Direction dans le Formulaire de Gestion 
- src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/3.FormReseauGestion.tsx
