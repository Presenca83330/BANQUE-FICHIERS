# 6. Stratégie – Gestion des informations partagées entre Réseau et Réseau Direction

## 🎯 Contexte
Dans ton modèle actuel, deux entités sont intimement liées :
- **Table `reseau`** : représente l’entité juridique / organisationnelle du réseau (raison sociale, SIRET, adresse, etc.).
- **Table `reseau_direction`** : représente la **personne responsable** du réseau (nom, prénom, email, téléphone).

Lors de la création d’un réseau, il est obligatoire de créer **simultanément** :
1. L’organisation (dans `organisations`).
2. Le réseau (`reseau`).
3. Le responsable du réseau (`reseau_direction` + entrée `users` + entrée `utilisateurs`).

## 📌 Infos partagées
Certains champs apparaissent comme « doublons » si on ne fait pas attention :

| Champ                | Où il doit être stocké | Pourquoi |
|-----------------------|------------------------|----------|
| **Nom du réseau**     | `reseau.reseau_nom` + `organisations.organisation_nom` | Identité de l’entité juridique. |
| **SIRET**             | `reseau.reseau_siret` | Spécifique au réseau. |
| **Adresse, CP, Ville**| `reseau.reseau_adresse`, `reseau.reseau_code_postal`, `reseau.reseau_ville` | Données de localisation de l’entité. |
| **Nom responsable**   | `users_nom`, `reseau_direction.nom` | Identité du directeur. |
| **Prénom responsable**| `users_prenom`, `reseau_direction.prenom` | Idem. |
| **Email responsable** | `users_email`, `utilisateur_email` | Sert aussi d’auth Supabase. |
| **Téléphone responsable** | `users_telephone` | Contact direct du directeur. |

👉 **Conclusion** :  
- Les infos **organisationnelles** (nom réseau, adresse, SIRET) restent dans `reseau`.  
- Les infos **personnelles** (nom, prénom, email, téléphone) restent dans `reseau_direction` + `users` + `utilisateurs`.  

## 🚨 Risque identifié
Si le formulaire demande séparément **email réseau** et **email responsable**, l’admin peut saisir deux valeurs différentes → incohérence.  
Idem pour téléphone.

## ✅ Solution retenue
- **Formulaire de création unique** (FormReseauCreation) :
  - Nom réseau + SIRET + adresse → `reseau`.
  - Nom/prénom/email/téléphone responsable → `reseau_direction` (et automatiquement `users` + `utilisateurs`).
- Pas de champ **email réseau** ou **téléphone réseau** séparé au moment de la création : on considère que le contact principal = directeur du réseau.
- Si plus tard on veut ajouter un **email générique du réseau** (ex. contact@reseau.com), ce sera un champ optionnel dans `reseau`, géré via la page de gestion, pas à la création.

## 🛠️ Implémentation
1. **Mapping des champs dans le hook `useCreationCompte`** :
   - `nomReseau`, `siret`, `adresse`, `codePostal`, `ville` → table `reseau`.
   - `nomResponsable`, `prenomResponsable`, `emailResponsable`, `telephoneResponsable` → table `reseau_direction` + `users` + `utilisateurs`.
2. **Formulaire** :
   - Champs présentés dans l’ordre logique pour l’admin.
   - Préheaders pour clarifier : (Raison sociale), (Nom Direction Réseau), etc.
3. **Hooks** :
   - Lors de la soumission → création en cascade :
     1. Organisation → 2. Réseau → 3. User/Utilisateur → 4. Reseau_Direction.
   - Reliés par `organisation_id` et `reseau_id`.

## 📊 Avantages
- Évite les doublons.
- Cohérence multi-tenant respectée (chaque user lié à son réseau et organisation).
- Clarifie pour l’admin la distinction entre **identité juridique du réseau** et **identité personnelle du directeur**.
- Évolutif : possibilité d’ajouter un **email générique réseau** plus tard.

