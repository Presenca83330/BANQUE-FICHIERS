<mark># ATTENTION </mark> 
<mark># TOUJOURS METTRE EN MODE CHAT LIGHT</mark> 
---
---
<mark>## **1/ Présentation**</mark>

Bonjour 
- Tu es un expert en Ia no code et intégration supabese.
- Tu maitrises parfaitement les environnement Saas, les meilleures logiciels
- Tu es un expert qui applique les directives avec rigueur, précision, tu es méticuleux
- Tu ne modifies pas ce qu on ne t a pas demandé
- Tu es un vrai expert professionnel
  - Je vais t'expliquer dans le chat suivant ce que nous allons faire ensemble.
  - DIRECTIVE ABSOLUE NON NEGOCIABLE 
  - Interdiction totale et absolue de commencer à lire les documents en ressources et de relire les messages précédents
  - Tu dois être concentrés sur la mission et les ressources que je vais te donner 
  - Attends mon message suivant
---
<mark>## **Directive 2/  Lire, Analyser, Appliquer les Docs Stratégiques**</mark>


J'aimerais que tu aies une vision complète de mon application commence par lire les documents suivants : 
  - public/1. Documents Stratégiques/01. Présentation LeadGenAi.md
  - public/1. Documents Stratégiques/02. Présentation Structure LeadGenAi.md
  - public/1. Documents Stratégiques/03. Logique Organisations.md
  - public/1. Documents Stratégiques/04. Relations Business entre Tables.md
  - public/1. Documents Stratégiques/05. Relations Users Utilisateurs.md
  - public/1. Documents Stratégiques/06. Référence des Hooks Stratégiques.md
  - public/1. Documents Stratégiques/07.1. FormCreationReseau - Gestion Informations Partagées entre Réseau et Réseau Direction.md
  - public/1. Documents Stratégiques/07.2. FormGestionReseau - Gestion Informations Partagées entre Réseau et Réseau Direction.md
  - public/1. Documents Stratégiques/08. Gestion du Menu Gauche.md
  - public/1. Documents Stratégiques/09. Structure - Organisation | Client_id.md
  - public/1. Documents Stratégiques/10. Structure des Tables de Connexion & Règles Collaborateurs.md
    - Quand tu auras fini, je te donnerai d'autres ressources à lire,
    - Ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
    - (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 3/ lire, Analyser les fichiers et fonctions actuelles de l'application et dans Supabse**</mark>

- Avant toute chose je te demande d'analyser :
- 1/ Tous les fichiers de mon application
- 2/ Toutes les tables et fonctions de supabase
- Quand tu auras fini, je te donnerai d'autres informations sur notre mission du jour.
- (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 4/ Migration LocalStorage -> Supabase**

- Mission actuelle migrer d'un modèle MVP en LocalStorage vers un modèle structuré Supabase

### **Objectif global**
 - Créer une architecture SaaS multi-tenant complète permettant
   - à chaque utilisateur, (réseau, réseau direction, réseau agence, réseau agence responsable, réseau agence collaborateur, agence indépendante, agence indépendante responsable, agence indépendante collaborateur)
   - d’accéder à leur espace et tout particulièrement leur espace de création d’annonces en 5 étapes relié à OpenAI,
   - avec gestion sécurisée des données via Supabase.
   - Objectif clair : mettre en place la structre avec Supabse pour que lorsqu'un utilisateur se connecte (reseau, reseau direction, agence independante etc)
   - Il puisse travailler sur son espace
     - pour récupérer des informations via le process en 5 étapes (etape1/2/3/4/5/5animation)
     - pour envoyer les données vers open ai
     - qui restituera les annonces sous un format imposé pour être utilisées dans etape6communication
     - et permettre à l'utilisateur de choisir les fonctions qu'il souhaite utiliser (annonce site internet, outils seo, emailing, sms etc...)

### **Structure multi-tenant Supabase et Règles de visibilité hiérarchique**
- Chaque entité dispose d’un espace de travail isolé et sécurisé, basé sur son organisation_id ou client_id.
- La visibilité hiérarchique est contrôlée par admin_presenca.
- La visibilité hiérarchique et les accès utilisateurs sont gérés exclusivement via les RLS policies SQL, appliquées sur les tables principales. Les hooks front n’assurent que l’injection des identifiants organisationnels.

### **Flux utilisateur global**
- Connexion / Authentification
  - Authentification via Supabase (email / mot de passe)
- Accès à l’espace personnel
  - Redirection automatique selon le rôle :
    - RESEAU-ESPACE
    - CLIENT-ESPACE
    - COLLABORATEUR-ESPACE
    - Chaque espace ouvre un accès aux données propres accessibles à l'utilisateur et au module accueil-leadgenai pour lancer le générateur d'annonces et d'outils seo
    - Prochainement il permettra de récupérer les historiques des annonces en fonction de ses projets propres ou de son statut dans la structure multi tenant

- As tu compris ma démarche?
  - Si oui je te donnerai des documents à étudier dans le message suivant
  - Ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
  - (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 5/ Mission Phase 1**</mark>

- Pour ne commettre aucune erreur dans la préparation de la migration.
- Nous travaillons sur la rédaction de documnents préparatoires

### **1/ AUDIT DES FICHIERS/PROCESS/LOCALSTORAGE ACTUEL**
- **PARTIE 1 : Lis et Analyse les process de récolte des informations dans les étapes 1 à 5 et envoi des données structurées à Open AI**
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/01.Etape1.m
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/02.Etape2.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/03.Etape3.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/04.Etape4.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/05.Etape5.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/06.Etape5animation.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/07.BilanEtape1aEtape5.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/08.ProcessEnvoiInfosOpenAI.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/09.ProcessPassageEtapeSuivante.md
      - Quand tu auras fini, je te donnerai d'autres ressources à lire, ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
      - (ce n est pas la peine de me faire de synthèse)
---
- **PARTIE 2 : Lis et Analyse comment sont récupérées les données de OPen Ai et utilisée dans etape6communication**
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/00.ProcessRecuperationOpenAI.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/02.SiteInternetOutilsSeo.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/03.PortailsImmobiliers.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/04.CréerEmailingCampagneNewsletter.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/05.EnvoyerCampagneSMS.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/06.CréerLandingPage.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/07.DiffuserGoogleMB.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/08.DiffuserReseaux.md.
      - Quand tu auras fini, je te donnerai d'autres ressources à lire, ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
      - (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 6/ Infos Importantes sur notre Stratégie** </mark>

###- **INFO N1/** **Stratégie de migration en 2 phases**
- Nous utilisons une stratégie de migration en 2 phases non négociable
- **Phase 1** :
    - Migrer le process Localstorage vers -> Supabase
        - Pour les étapes 1 à 5
        - Jusqu'à l"envoi des prompts vers OpenAI
- **Phase 2** :
    - Migrer le process Localstorage vers -> Supabase
        - De Etape5animation avec process d'animation et de gestion du statut pendant la phase d'attente des données provenant de open ai
        - En passant par la récupération des données envoyée par Open ai : 7 générations OpenAI
        - Jusqu'à la récupération par etape6communication
        - Et l'utilisation par les 8 canaux
- **Nous allons travailler aujourd'hui exclusivement sur la phase 1**

###- **INFO N2/** **Conservation non négociable du nommage camelCase**
- Nous suivons une architecture avec CONSERVATION DU NOMMAGE camelCase non négociable
- Tous les hooks, fonctions, et interactions Supabase créés lors de la migration
    - **DOIVENT impérativement** :
      - Conserver la structure camelCase existante pour les champs métier (agencyName, propertyType, saleType, price, rentAmount, rentPeriodicity, keyElements, propertyDescription, financials, details, exclusivite, location, reference).
      - Utiliser snake_case uniquement pour les champs système Supabase (organisation_id, user_id, created_at, updated_at, project_id, etc.).
  - Cette directive s'apppliquera à chacune de tes creations de fichier
    - (ce n est pas la peine de me faire de synthèse)
    - **Règles concernant le nommage des camelCase**
      - **Règle SQL - Création de table**
        - Champs métier : `"camelCase"` (avec guillemets doubles)
        - Champs système : `snake_case` (sans guillemets)
    - **Règle TypeScript - Hooks & Services**
      - Utilisation directe du `camelCase` pour champs métier
      - Utilisation directe du `snake_case` pour champs système
      - **AUCUNE fonction de conversion n'est nécessaire**
    - **Règle Triggers**
      - Utiliser : `NEW."camelCase"` ou `NEW.snake_case`
      - Préférer les fonctions génériques réutilisables
    - Cette directive s'apppliquera à chacune de tes creations de fichier

### **INFO N3/** **Structure Multi tenant**
- Nous suivons une structure multi tenant avec une structure de visibilité imposée.

**Pour les structures** **Réseaux**
| Type utilisateur | Accès espace | Voit les projets de |
|------------------|--------------|---------------------|
| `reseau` | `/accueil-leadgenai` | reseau + reseau_direction (projets internes au réseau et à sa direction) (Par respect confidentialité : Ne voit pas les projets des agences du réseau) |
| `reseau_direction` | `/accueil-leadgenai` | reseau + reseau_direction (projets internes au réseau et à sa direction) (Par respect confidentialité : Ne voit pas les projets des agences du réseau)  |
| `reseau_agence` | `/accueil-leadgenai` | reseau_agence + reseau_agence_responsable + reseau_agence_collaborateur |
| `reseau_agence_responsable` | `/accueil-leadgenai` | reseau_agence + reseau_agence_responsable + reseau_agence_collaborateur |
| `reseau_agence_collaborateur` | `/accueil-leadgenai` | **Uniquement ses propres projets** |

**Pour les structures** **Agences Indépendantes**
| Type utilisateur | Accès espace | Voit les projets de |
|------------------|--------------|---------------------|
| `agence_independante` | `/accueil-leadgenai` | agence_independante + agence_independante_responsable + agence_independante_collaborateur |
| `agence_independante_responsable` | `/accueil-leadgenai` | agence_independante + agence_independante_responsable + agence_independante_collaborateur |
| `agence_independante_collaborateur` | `/accueil-leadgenai` | **Uniquement ses propres projets** |

- La visibilité hiérarchique et les accès utilisateurs sont gérés exclusivement via les RLS policies SQL, appliquées sur les tables principales. Les hooks front n’assurent que l’injection des identifiants organisationnels.
  - Est-ce clair, si oui je vais poursuivre dans le chat suivant
  - (ce n est pas la peine de me faire de synthèse)
---

<mark>## **Directive 7/ Lire, Analyser et Appliqur les Ressources Préparatoires*</mark>

- **1/ lire et appliquer Les bases de la stratégie de migration**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--0.StrategiePhase1.md
- **2/ lire et appliquer la table préparatoire pour la migration**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--0.Table_etapes1to5.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--1.GestionStrategieMultiTenant.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--2.FonctionTimer.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--3.ExplicationdesChamps.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--4.MenuGaucheNavLinks.md
- **3/ Lire et appliquer la bible recenssant toutes les fichiers, codes, hooks, localstorage utilisés actuellement**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--0.BibleRéférences.md
- **4/ Lire et appliquer la road map de la stratégie migration phase 1**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--0.DétailStratégiePhase1.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--1.TableauRecapElementsACréer.md
    - Avec une nomanclature stricte et non négociable
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--2.Nomenclature.md
- **5/ Lire et appliquer les directives préparatoires à la section 4 et la création de 2 nouvelles tables**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--0.Section4-Directives.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--1.Section4-TableOpenAiKeys.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--2.Section4-TableOpenAILogs.md
  - Merci de lire et analyser ces fichiers, j'ai encore d'autres ressources à te transmettre
  - (Ce n est pas la peine de résmer)
---
---
<mark>## **Directive 8/ Lire et comprendre le cahier des charges des documents à préparer pour le codage final**

- Avant de coder les fichiers définitifs de la migration, j'avais souhaité rédiger un cahier des charges précis pour chaque élément
- Lis ce premier document préparatoire, il rappelle les directives et définit le découpage en 5 sections de ce cahier des charges
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--0.DocsPréparatoireCodagePhase1.md
- Nous avons déjà validé 4 sections :
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--1.DocSection1Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--2.DocSection2Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--3.DocSection3Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--4.DocSection4Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--5.DocSection5Validée.md
  - Nous sommes actuellement dans le plan de codage des fichierx
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/06--1.PLAN_CODAGE_PHASE1.md

  - est-ce clair?
  - Je vais te donner des directives précises dans le chat suivant 
  - ce n est pas la peine de résumer
---
---
<mark>## **RAPPEL DES FICHIERS PREPARATOIRES**</mark>

    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--0.StrategiePhase1.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--0.Table_etapes1to5.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--1.GestionStrategieMultiTenant.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--2.FonctionTimer.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--3.ExplicationdesChamps.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--4.MenuGaucheNavLinks.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--0.BibleRéférences.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--0.DétailStratégiePhase1.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--1.TableauRecapElementsACréer.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--2.Nomenclature.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--0.Section4-Directives.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--1.Section4-TableOpenAiKeys.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--2.Section4-TableOpenAILogs.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--0.DocsPréparatoireCodagePhase1.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--1.DocSection1Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--2.DocSection2Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--3.DocSection3Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--4.DocSection4Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/05--5.DocSection5Validée.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/06--1.PLAN_CODAGE_PHASE1.md

---
---
<mark>## **RAPPEL DES FICHIERS DE CODES **</mark>

- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--1.CodesSection1.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--2.CodesSection2.md
- public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--3.CodesSection3.md
---
---
---
