<mark># ATTENTION </mark> 
<mark># TOUJOURS METTRE EN MODE CHAT LIGHT</mark> 
---
---
<mark>## **1/ Présentation**</mark>

Bonjour 
- Tu es un expert en Ia no code et intégration supabese.
- Tu maitrises parfaitement les environnement Saas, les meilleures logiciels
- Tu es un expert qui applique les directives avec rigueur, précision, tu es méticuleux
- Tu ne modifies pas ce qu on ne t a pas demandé
- Tu es un vrai expert professionnel
  - Je vais t'expliquer dans le chat suivant ce que nous allons faire ensemble.
  - DIRECTIVE ABSOLUE NON NEGOCIABLE 
  - Interdiction totale et absolue de commencer à lire les documents en ressources et de relire les messages précédents
  - Tu dois être concentrés sur la mission et les ressources que je vais te donner 
  - Attends mon message suivant
---
<mark>## **Directive 2/  Lire, Analyser, Appliquer les Docs Stratégiques**</mark>


J'aimerais que tu aies une vision complète de mon application commence par lire les documents suivants : 
  - public/1. Documents Stratégiques/01. Présentation LeadGenAi.md
  - public/1. Documents Stratégiques/02. Présentation Structure LeadGenAi.md
  - public/1. Documents Stratégiques/03. Logique Organisations.md
  - public/1. Documents Stratégiques/04. Relations Business entre Tables.md
  - public/1. Documents Stratégiques/05. Relations Users Utilisateurs.md
  - public/1. Documents Stratégiques/06. Référence des Hooks Stratégiques.md
  - public/1. Documents Stratégiques/07.1. FormCreationReseau - Gestion Informations Partagées entre Réseau et Réseau Direction.md
  - public/1. Documents Stratégiques/07.2. FormGestionReseau - Gestion Informations Partagées entre Réseau et Réseau Direction.md
  - public/1. Documents Stratégiques/08. Gestion du Menu Gauche.md
  - public/1. Documents Stratégiques/09. Structure - Organisation | Client_id.md
  - public/1. Documents Stratégiques/10. Structure des Tables de Connexion & Règles Collaborateurs.md
    - Quand tu auras fini, je te donnerai d'autres ressources à lire,
    - Ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
    - (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 3/ lire, Analyser les fichiers et fonctions actuelles de l'application et dans Supabse**</mark>

- Avant toute chose je te demande d'analyser :
- 1/ Tous les fichiers de mon application
- 2/ Toutes les tables et fonctions de supabase
- Quand tu auras fini, je te donnerai d'autres informations sur notre mission du jour.
- (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 4/ Migration LocalStorage -> Supabase**

- Mission actuelle migrer d'un modèle MVP en LocalStorage vers un modèle structuré Supabase

### **Objectif global**
 - Créer une architecture SaaS multi-tenant complète permettant
   - à chaque utilisateur, (réseau, réseau direction, réseau agence, réseau agence responsable, réseau agence collaborateur, agence indépendante, agence indépendante responsable, agence indépendante collaborateur)
   - d’accéder à leur espace et tout particulièrement leur espace de création d’annonces en 5 étapes relié à OpenAI,
   - avec gestion sécurisée des données via Supabase.
   - Objectif clair : mettre en place la structre avec Supabse pour que lorsqu'un utilisateur se connecte (reseau, reseau direction, agence independante etc)
   - Il puisse travailler sur son espace
     - pour récupérer des informations via le process en 5 étapes (etape1/2/3/4/5/5animation)
     - pour envoyer les données vers open ai
     - qui restituera les annonces sous un format imposé pour être utilisées dans etape6communication
     - et permettre à l'utilisateur de choisir les fonctions qu'il souhaite utiliser (annonce site internet, outils seo, emailing, sms etc...)
    
### **Impératif : MIGRER A L'IDENTIQUE**
- Aujourd'hui l'application fonctionne à merveille. Mais il n'est pas possible de commercialiser une application en localstorage
  - L'OBJECTIF : est simplement de Passer de localStorage à Supabase
    - SANS RIEN CHANGER D'AUTRE
      - Garder TOUS les champs (noms, types, structures)
      - Garder TOUS les processus (création, validation, gestion)
      - Garder TOUTES les validations (côté client identiques)
      - Garder TOUTE la logique métier (hooks, formulaires, flows)
      - Garder TOUTE l'UX/UI (même comportement utilisateur)
- **C'est une migration technique pure, pas une refonte.**


### **Structure multi-tenant Supabase et Règles de visibilité hiérarchique**
- Chaque entité dispose d’un espace de travail isolé et sécurisé, basé sur son organisation_id ou client_id.
- La visibilité hiérarchique est contrôlée par admin_presenca.
- La visibilité hiérarchique et les accès utilisateurs sont gérés exclusivement via les RLS policies SQL, appliquées sur les tables principales. Les hooks front n’assurent que l’injection des identifiants organisationnels.

### **Flux utilisateur global**
- Connexion / Authentification
  - Authentification via Supabase (email / mot de passe)
- Accès à l’espace personnel
  - Redirection automatique selon le rôle :
    - RESEAU-ESPACE
    - CLIENT-ESPACE
    - COLLABORATEUR-ESPACE
    - Chaque espace ouvre un accès aux données propres accessibles à l'utilisateur et au module accueil-leadgenai pour lancer le générateur d'annonces et d'outils seo
    - Prochainement il permettra de récupérer les historiques des annonces en fonction de ses projets propres ou de son statut dans la structure multi tenant

- As tu compris ma démarche?
  - Si oui je te donnerai des documents à étudier dans le message suivant
  - Ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
  - (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 5/ Mission Phase 1**</mark>

- Pour ne commettre aucune erreur dans la préparation de la migration.
- Nous travaillons sur la rédaction de documnents préparatoires

### **1/ AUDIT DES FICHIERS/PROCESS/LOCALSTORAGE ACTUEL**
- **PARTIE 1 : Lis et Analyse les process de récolte des informations dans les étapes 1 à 5 et envoi des données structurées à Open AI**
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/01.Etape1.m
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/02.Etape2.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/03.Etape3.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/04.Etape4.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/05.Etape5.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/06.Etape5animation.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/07.BilanEtape1aEtape5.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/08.ProcessEnvoiInfosOpenAI.md
    - public/4. ReadMe EtapesAnnonces/01.Etape1à5/09.ProcessPassageEtapeSuivante.md
      - Quand tu auras fini, je te donnerai d'autres ressources à lire, ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
      - (ce n est pas la peine de me faire de synthèse)
---
- **PARTIE 2 : Lis et Analyse comment sont récupérées les données de OPen Ai et utilisée dans etape6communication**
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/00.ProcessRecuperationOpenAI.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/02.SiteInternetOutilsSeo.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/03.PortailsImmobiliers.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/04.CréerEmailingCampagneNewsletter.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/05.EnvoyerCampagneSMS.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/06.CréerLandingPage.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/07.DiffuserGoogleMB.md
    - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/08.DiffuserReseaux.md.
      - Quand tu auras fini, je te donnerai d'autres ressources à lire, ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
      - (ce n est pas la peine de me faire de synthèse)
---
<mark>## **Directive 6/ Infos Importantes sur notre Stratégie** </mark>

###- **INFO N1/** **Stratégie de migration en 2 phases**
- Nous utilisons une stratégie de migration en 2 phases non négociable
- **Phase 1** :
    - Migrer le process de récupération des informations et d'envoi des données à Open Ai -> Actuellement Localstorage -> vers -> Supabase
        - Migrer à l identique tous le process de récupération des informations
        - Migrer le process d'envoi ver Open AI
        - Nous nous arrêtons là pour la phase 1, tout ce qui concerne la récupération et l'utilisation des datas sera fait en Phase 2 après tests de validation
- **Phase 2** :
    - Migrer le process de récupération des données de Open AI et d'utilisation par les différents canaux -> Actuellement Localstorage -> vers -> Supabase
        - Migrer à l'identique etape6animaion
        - Migrer à l'identique le process de récupération des datas provenant de Open ai
        - Migrer à l"identique le process d'utilisation des datas dans etape6communication
        - Migrer et optimiser le process d'utilisation dans les 8 canaux 
- **Nous allons travailler aujourd'hui exclusivement sur la phase 1**

###- **INFO N2/** **Conservation non négociable du nommage camelCase**
- Nous suivons une architecture avec CONSERVATION DU NOMMAGE camelCase non négociable
- Tous les hooks, fonctions, et interactions Supabase créés lors de la migration
    - **DOIVENT impérativement** :
      - Conserver la structure camelCase existante pour les champs métier (agencyName, propertyType, saleType, price, rentAmount, rentPeriodicity, keyElements, propertyDescription, financials, details, exclusivite, location, reference).
      - Utiliser snake_case uniquement pour les champs système Supabase (organisation_id, user_id, created_at, updated_at, project_id, etc.).
  - Cette directive s'apppliquera à chacune de tes creations de fichier
    - (ce n est pas la peine de me faire de synthèse)
    - **Règles concernant le nommage des camelCase**
      - **Règle SQL - Création de table**
        - Champs métier : `"camelCase"` (avec guillemets doubles)
        - Champs système : `snake_case` (sans guillemets)
    - **Règle TypeScript - Hooks & Services**
      - Utilisation directe du `camelCase` pour champs métier
      - Utilisation directe du `snake_case` pour champs système
      - **AUCUNE fonction de conversion n'est nécessaire**
    - **Règle Triggers**
      - Utiliser : `NEW."camelCase"` ou `NEW.snake_case`
      - Préférer les fonctions génériques réutilisables
    - Cette directive s'apppliquera à chacune de tes creations de fichier

### **INFO N3/** **Structure Multi tenant**
- Nous suivons une structure multi tenant avec une structure de visibilité imposée.

**Pour les structures** **Réseaux**
| Type utilisateur | Accès espace | Voit les projets de |
|------------------|--------------|---------------------|
| `reseau` | `/accueil-leadgenai` | reseau + reseau_direction (projets internes au réseau et à sa direction) (Par respect confidentialité : Ne voit pas les projets des agences du réseau) |
| `reseau_direction` | `/accueil-leadgenai` | reseau + reseau_direction (projets internes au réseau et à sa direction) (Par respect confidentialité : Ne voit pas les projets des agences du réseau)  |
| `reseau_agence` | `/accueil-leadgenai` | reseau_agence + reseau_agence_responsable + reseau_agence_collaborateur |
| `reseau_agence_responsable` | `/accueil-leadgenai` | reseau_agence + reseau_agence_responsable + reseau_agence_collaborateur |
| `reseau_agence_collaborateur` | `/accueil-leadgenai` | **Uniquement ses propres projets** |

**Pour les structures** **Agences Indépendantes**
| Type utilisateur | Accès espace | Voit les projets de |
|------------------|--------------|---------------------|
| `agence_independante` | `/accueil-leadgenai` | agence_independante + agence_independante_responsable + agence_independante_collaborateur |
| `agence_independante_responsable` | `/accueil-leadgenai` | agence_independante + agence_independante_responsable + agence_independante_collaborateur |
| `agence_independante_collaborateur` | `/accueil-leadgenai` | **Uniquement ses propres projets** |

- La visibilité hiérarchique et les accès utilisateurs sont gérés exclusivement via les RLS policies SQL, appliquées sur les tables principales. Les hooks front n’assurent que l’injection des identifiants organisationnels.
  - Est-ce clair, si oui je vais poursuivre dans le chat suivant
  - (ce n est pas la peine de me faire de synthèse)
---

<mark>## **Directive 7/ Lire, Analyser les Ressources Préparatoires*</mark>

- **1/ lire et appliquer Les bases de la stratégie de migration**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--0.StrategiePhase1.md
- **2/ lire et appliquer la table préparatoire pour la migration**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--0.Table_etapes1to5.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--1.GestionStrategieMultiTenant.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--2.FonctionTimer.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/01--3.ExplicationdesChamps.md
- **3/ Lire et appliquer la bible recenssant toutes les fichiers, codes, hooks, localstorage utilisés actuellement**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--0.BibleRéférences.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/02--1.MenuGaucheNavLinks.md
- **4/ Lire et appliquer la road map de la stratégie migration phase 1**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--0.DétailStratégiePhase1.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/03--1.TableauRecapElementsACréer.md
    - Avec une nomanclature stricte et non négociable
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/.00--2.Nomenclature.md
- **5/ Lire et appliquer les directives préparatoires à la section 4 et la création de 2 nouvelles tables**
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--0.Section4-Directives.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--1.Section4-TableOpenAiKeys.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--2.Section4-TableOpenAILogs.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/04--3.Section4-Précisions.md (précisions techniques apparus lors du codage)
  - Merci de lire et analyser ces fichiers, j'ai encore d'autres ressources à te transmettre
  - (Ce n est pas la peine de résmer)
---
<mark>## **Directive 8/ Lire, Analyser les Codes préparatoires**</mark>
- Je te rappelle que mon application n'est pas encore en ligne, n a pas de client et rien n'a ete fait
  - Avant de migrer, j'ai souhaité écrire noir sur blanc
  - Les codes de tous les éléments comme s'ils etaioent déjà en ligne pour bien décortiquer les composants et limiter au maximum les erreurs au moment de l'intégrattion
- **1/ Lis, analyse tous les codes préparatoires des 5 sections **
  - Ta mission consiste à partir des ressources disponibles à vérifier si les process sont bons, si le process localstorage qui fonctionne à merveille est maintenu et s'il n'y a pas eu d'erreur de namming ou d'oubli
- **2/ Analyse les fichiers suivants** :
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--1.CodesSection1.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--2.CodesSection2.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--3.CodesSection3.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--4.CodesSection4.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--5.CodesSection5.md
    - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/08--6.CodesSqlTables.md
- Nous allons maintenant lancer la migration
  - Nous faisons cette migration à 3 : moi, Claude et toi, suivant ce plan
  - public/4. ReadMe EtapesAnnonces/03.PreparationMigration/01.Etape1to5/09--PlandeMigration.md
- J'ai déjà effectué
  - Etape 1 : Création des tables
  - Etape 2 : edge functions
- Je suis en train de mettre en place l'étape 3
---
---
---
---
---



---
---
---
