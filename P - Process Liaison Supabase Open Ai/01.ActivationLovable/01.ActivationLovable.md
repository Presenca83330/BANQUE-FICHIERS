
----
## 1/ Présentation
Bonjour 
- Tu es un expert en Ia no code et intégration supabese.
- Tu maitrises parfaitement les environnement Saas, les meilleures logiciels et ia
- Tu es un expert qui applique les directives avec rigueur, précision, tu es méticuleux
- Tu ne modifies pas ce qu on ne t a pas demandé
- Tu es un vrai expert professionnel
Je vais t'expliquer dans le chat suivant ce que nous allons faire ensemble.
---
## 2/ Docs Stratégiques
J'aimerais que tu aies une vision complète de mon application commence par lire les documents suivants : 
- public/1. Documents Stratégiques/01. Présentation LeadGenAi.md
- public/1. Documents Stratégiques/02. Présentation Structure LeadGenAi.md
- public/1. Documents Stratégiques/03. Logique Organisations.md
- public/1. Documents Stratégiques/04. Relations Business entre Tables.md
- public/1. Documents Stratégiques/05. Relations Users Utilisateurs.md
- public/1. Documents Stratégiques/06. Référence des Hooks Stratégiques.md
- public/1. Documents Stratégiques/07.1. Stratégie - Gestion des informations partagées entre Réseau et Réseau Direction.md
- public/1. Documents Stratégiques/08. Gestion du Menu Gauche.md
- public/1. Documents Stratégiques/09. Structure - Organisation | Client_id.md
- public/1. Documents Stratégiques/10. Structure des Tables de Connexion & Règles Collaborateurs.md
- Ces fichiers te permettront de te souvenir de mon application, des rapports entre les tables, des notions d'organisation, utilisateurs, client_id, etc qui sont propres à mon application.
- Quand tu auras fini, je te donnerai d'autres ressources à lire, ne fais pas autre chose avant ma commande suivante il faut analyser les fichiers dans l'ordre
  (ce n est pas la peine de me faire de synthèse)
---
## 3/ Présentation du Formulaire de création/modification tables
- Parfait, nous avons longtemps travaillé sur les process d'authentification
- qui sont dans src/components/HOOKS-STRATEGIQUE
  - src/components/HOOKS-STRATEGIQUE/1.HOOK-useAuth
  - src/components/HOOKS-STRATEGIQUE/2.HOOK-useCurrentUser
  - src/components/HOOKS-STRATEGIQUE/3.HOOK-useMultiTenant
  - src/components/HOOKS-STRATEGIQUE/4.HOOK-useSupabaseOperations
  - et les fichiers d'intégration de supabase
    - src/integrations/supabase
- Nous avons également travaillé sur le process de création/modification de table pour admin_presenca
  - Regarde comment sont créees les tables lorsque je les crée en tant que admin_presenca
  - public/3. ReadMe FormPresenca/00.BibleGenerationFormTables -> 02.TemplateFormCreation.md -> public/3. ReadMe FormPresenca/00.BibleGenerationFormTables/03.TemplateFormGestion.md
  - src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau
  - src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/6.AgenceIndependante
- Analyse également la structure des tables stratégiques/clients/connexion dans supabase
  - Quand tu auras fini, je te donnerai d'autres informations sur notre mission du jour.
  (ce n est pas la peine de me faire de synthèse)
---
## 4/ Nouvel objectif ensemble
- Maintenant que les process d'authentification et de création de tables sont en place
- Je souhaite reprendre le travail sur mon application
  - Lors du travail préparatoire, j'ai travaillé en localstorage pour paramétrer mes api avec Open ai
  - Maintenant je veux travailler sur mes applications, la génération d'annonces par open ai et les fonctions qui en déroulent
  - Je te rappelle :
    - public/1. Documents Stratégiques/01. Présentation LeadGenAi.md
    - public/1. Documents Stratégiques/02. Présentation Structure LeadGenAi.md
  - Analyse maintenant l'intégralité de mon application et ensuite lis ce qui suit.

### Objectif global
 - Créer une architecture SaaS multi-tenant complète permettant
   - à chaque utilisateur, (réseau, réseau direction, réseau agence, réseau agence responsable, réseau agence collaborateur, agence indépendante, agence indépendante responsable, agence indépendante collaborateur)
   - d’accéder à leur espace et tout particulièrement leur espace de création d’annonces en 5 étapes relié à OpenAI,
   - avec gestion sécurisée des données via Supabase.
   - Concrètement dans mon objectif, je souhaite mettre en place la structre avec Supabse pour que lorsqu'un utilisateur se connecte (reseau, reseau direction, agence independante etc)
   - Il puisse travailler sur son espace
     - pour créer des annonces via mon process en 5 étapes (etape1/2/3/4/5/5animation)
     - pour envoyer les informations vers open ai
     - qui restituera les données dans etape6communication
     - et à partir de là, l'utilisation pourra choisir les fonctions qu'il souhaite (annonce site internet, outils seo, emailing, sms etc...)

### Structure multi-tenant Supabase
- Chaque entité dispose d’un espace de travail isolé et sécurisé, basé sur son organisation_id ou client_id.
- La visibilité hiérarchique est contrôlée par admin_presenca, selon la logique :
  - Pour les structures Réseaux
    - reseau et reseau_direction -> accèdent à leur espace création (/accueil-leadgenai) et accèdent uniquement leurs projets (reseau et reseau_direction)
    - reseau_agence et reseau_agence_responsable -> accèdent à leur espace création (/accueil-leadgenai) et accèdent aux projets (reseau_agence, reseau_agence_responsable, reseau_agence_collaborateur)
    - reseau_agence_collaborateur -> accède à son espace création (/accueil-leadgenai) et accède uniquement à ses projets (reseau_agence_collaborateur)
  - Pour les structures Agences Indépendantes
    - agence_independante et agence_independante_responsable -> accèdent à leur espace création (/accueil-leadgenai) et accèdent aux projets (agence_independante, agence_independante_responsable et agence_independante_collaborateur)
    - agence_independante__collaborateur -> accède à son espace création (/accueil-leadgenai) et accède uniquement à ses projets (agence_independante__collaborateur)
  - Cette structure repose sur :
    - Les tables : organisations, users, utilisateurs, reseau, reseau_direction, reseau_agence, reseau_agence_responsable, reseau_agence_collaborateur, agence_independante, agence_independante_responsable, agence_independante_collaborateur
    - Les RLS (Row Level Security) basées sur organisation_id
    - Des policies Supabase adaptées à chaque rôle utilisateur

### Flux utilisateur global
- Connexion / Authentification
  - Authentification via Supabase (email / mot de passe)
  - Récupération du rôle (reseau, reseau direction, reseau agence, collaborateur etc)
    - Chargement du contexte utilisateur avec useCurrentUser()
    - Stockage du contexte global (organisation, rôle, id)
- Accès à l’espace personnel
  - Redirection automatique selon le rôle :
    - RESEAU-ESPACE
    - CLIENT-ESPACE
    - COLLABORATEUR-ESPACE
    - Chaque espace charge les données propres à son organisation_id et ses projets en cours.

- POur nous permettre de faire des migrations parfaites localstorage vers supabase
  - Nous avons besoin de préparer le terrain et d'analyser absolument tous les process actuels
    - Je ne veux pas de codes préparatoires, je veux juste un état des lieux total et exhaustif
    - Je souhaite avoir le process actuel complet (les noms des champs, des fonctions, des contraintes, des attentes, des boutons modifier, des retours en arriere, des liens OpenAI... etc tout )
    - Je veux tous les codes localstorage, les fonctions, les composantes, les actions, les retours attendus tout
    - Et je veux au final sous forme de tableau syntétiques les actions à envisager pour permettre la migration local storage vers supabase, si possible sous forme de tableau
- Analyse les documents
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/01.Etape1.md
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/02.Etape2.md
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/03.Etape3.md
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/04.Etape4.md
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/05.Etape5.md
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/06.Etape5animation.md
  -  public/4. ReadMe EtapesAnnonces/01.Etape1à5/07.BilanEtape1aEtape5.md

  - Il te permettra d'avoir une vue d'ensemble des premières étapes
  - Tu verras qu'il suit une organisation précise et tout l'existant est détaillé de manière précise et détaillée
  - Lis ces documents et je te dirai notre mission dans le chat suivant
      - (ce n est pas la peine de me faire de synthèse)
  - As-tu compris ce que j'attends de toi ?
---
---
## 7/ Audit exhaustif après récupération données open ai
- Nous allons travailler sur le process de etape6communication après la récupération des données récupérées de open ai
  - Nous avons rédigés ce documnent gobal
  - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/00.ProcessRecuperationOpenAI.md
- Nous avons également décrit ce canal
  - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md
- Maintenant, je souhaite travailler sur le canal
  - qsdf
- Tu devras faire exactement la meme chose que tu as fait
- pour : public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md
- ->Plan d'action pour l'audit de l'onglet
  - 1/ Utilise la structure, contenu et forme de
  - public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md
    - RAPPELS :
  - Phase 1 de Audit Technique Exhaustif 
    - Analyse du code du canal
    - Analyse l'application
    - Identifie impérativement tous les fichiers concernés (pages, composants, hooks, utils, local storage, boutons modifier, noms des champs, des fonctions, clés, utilisation open ai, tout )
    - Identifie toutes les fonctions localstorage utilisée
  - Lis chaque fichier en détail
    - Trace le flux de données complet
    - Fais toujours un état complet et exhaustif de tout ce qui est utilisé dans le canal :
    - Fais un tableau du nom des champs, process de remplissage à partir du retour open ai,
    - fonction bouton modifier
  - Phase 2
    - Génére une Explication détaillée des options de copie des outils seo
    - pour -> Copier / Intéger sur mon Site Internet
    - Format Texte
    - Copier les Outils SEO
    - Génération des apercus
- Phase 3
    - -> Applique le plan ci-dessous
    - utilisé pour public/4. ReadMe EtapesAnnonces/02.Etape6Communication/01.SiteInternetAnnonces.md et adapté au canal
      - I MISSION DU DOCUMENT
      - II SOMMAIRE CLIQUABLE avec liens hyer texte
      - III ARCHITECTURE GLOBALE - CANAL
        - 3.1. Vue d'ensemble du canal
        - 3.2. Position dans Étape 6 Communication
        - 3.3. Schéma Mermaid complet (flux de données)
      - IV LISTE EXHAUSTIVE DES FICHIERS UTILISÉS
        - 4.1. Fichiers de composition
        - 4.2. Hooks de récupération
        - 4.3. Hooks d'aperçu
        - 4.4. Hooks de copie
        - 4.5. Composants graphiques
        - 4.6. Arborescence complète avec descriptions
      - V SYSTÈME D'ONGLETS
        - 5.1. MenuOnglet
        - 5.2. Onglet 1 :
        - 5.3. Onglet 2 :
        - 5.4. Onglet 3 :
        - 5.5. Logique de navigation et état
      - VI PROCESSUS DE RÉCUPÉRATION DES DONNÉES OPENAI
        - 6.1. Sources de données (clés localStorage)
        - 6.2. Logique de priorité (modifs > originales)
        - 6.3. Hooks de récupération détaillés
        - 6.4. Mapping des champs OpenAI → Interface
      - VII  STRUCTURE DES DONNÉES localStorage
        - 7.1. Clés LUES
        - 7.2. Clés ÉCRITES
        - 7.3. Interfaces TypeScript complètes
        - 7.4. Tableaux récapitulatifs
      - VIII PROCESSUS COMPLET ÉTAPE PAR ÉTAPE
        - 8.1. Chargement initial
        - 8.2. Affichage en mode lecture seule
        - 8.3. Activation du mode édition
        - 8.4. Modification des champs
        - 8.5. Sauvegarde automatique
        - 8.6. Copie au format Texte/HTML
      - IX SYSTÈME D'ÉDITION - BOUTON "MODIFIER"
        - 9.1. Localisation
        - 9.2. Comportement toggle (Modifier ↔ Sauvegarder)
        - 9.3. Propagation de l'état
        - 9.4. Affichage conditionnel
        - 9.5. Nettoyage HTML
        - 9.6. Éditeur WYSIWYG (EditeurWYSIWYG.tsx)
    - X OPTIONS DE COPIE
        - 10.1. FORMAT TEXTE
        - A.
        - B.
        - C.
        - 10.2. FORMAT HTML
        - A.
        - B.
        - C.
        - 10.3. Logique de formatage détaillée
  - XI SYSTÈME D'APERÇU
        - 11.1. Hook Aperçu
        - 11.2. Hook Aperçu
        - 11.3. Fonctions  détaillées
  - XII CONTRAINTES ET VALIDATION
        - 12.1. Validation des champs (nettoyage HTML)
        - 12.2. Gestion des erreurs (loading, error)
        - 12.3. Toasts de notification
        - 12.4. Sécurité
  - XIII COMPOSANTS GRAPHIQUES RÉUTILISABLES
        - 13.1.
        - 13.2.
        - 13.3.
        - 13.4.
        - 13.5.
  - XIV TABLEAUX RÉCAPITULATIFS
        - 14.1. Tableau des champs
        - 14.2. Tableau des champs
        - 14.3. Tableau des hooks
        - 14.4. Tableau des fonctions de copie (
        - 14.5. Matrice Onglets × Actions × Fichiers
  - XV DONNÉES À PRENDRE EN CONSIDÉRATION
      - 15.1. Points d'attention techniques
      - 15.2. Dépendances critiques
      - 15.3. Fonctions clés à préserver
      - 15.4. Mapping OpenAI → Interface (cta vs appelAction)
---
----
-
-
-
-
-
---
---









---
---
-
-
--
---
---
-
-
-




----
## 6/ Directives
- Tu vas travailler sur Etape :
- Tu devrais faire exactement la meme chose que public/4. ReadMe EtapesAnnonces/01.Etape1à5/02.Etape2.md
### Plan d'action pour Etape
- Utilise la structure, contenu et forme de
- public/4. ReadMe EtapesAnnonces/01.Etape1à5/01.Etape1.md
  - MISSION DU DOCUMENT
  - SOMMAIRE CLIQUABLE
  - I. ARCHITECTURE GLOBALE - ÉTAPE
    - Vue d'ensemble
    - Flux de données simplifiées
    - Schéma complet mermaid
    - Détail du flux
  - II. FICHIERS UTILISÉS (Liste exhaustive)
  - III. STRUCTURE DES DONNÉES DANS localStorage
  - IV. LOGIQUE DE VALIDATION DES CHAMPS
  - V. CONTRAINTES ET RÈGLES MÉTIER
  - VI. NAVIGATION ET RETOUR EN ARRIÈRE
  - VII. UTILISATION DES DONNÉES PAR OPENAI
  - VIII. PROCESSUS COMPLET ÉTAPE PAR ÉTAPE
  - IX. ÉLÉMENTS CACHÉS / CONDITIONNELS
  - X. TIMER DE SESSION (DÉSACTIVÉ MAIS PRÉSENT)
  - XI. RÉCAPITULATIF DES CLÉS localStorage
  - XII. DONNEES DE L'ETAPE  À PRENDRE EN CONSIDÉRATION
    - Champs localStorage
    - Clés localStorage
    - Fonctions
    - Rappel des dépendances entre les tables

#### Phase 1 : 
- Analyse du code de l'étape
- Analyse l'application
- Identifie impérativement tous les fichiers concernés (pages, composants, hooks, utils, local storage, boutons modifier, noms des champs, des fonctions, clés, utilisation open ai, tout )
- Identifie toutes les fonctions localstorage utilisée
- Lis chaque fichier en détail
- Trace le flux de données complet

#### Phase 2 : Documentation exhaustive
- Crée un fichier .md avec la structure en 12 sections
- Documente de manière complete tous les champs, fonctions, validations, clés localStorage
- Identifie les intégrations OpenAI/Brevo/autres APIs

#### Phase 3 : Tableau de synthèse
- Remplis la section XII. DONNEES DE L'ETAPE .. À PRENDRE EN CONSIDÉRATION
- Crée un tableau récapitulatif des champs, clés, fonctions localStorage
- Note les dépendances entre étapes
---
---
  

- 


- Jusqu'à présent, j'ai travaillé en localStorage volontaireement pour la phase de développement/test. Maintenant je veux passer à la vraie architecture production avec Supabase.
- 
