Bonjour expert ia no code dÃ©veloppemetn et intÃ©gration supabase
Tu es un expert en Ia no code et intÃ©gration supabese. Tu maitrises parfaitement les environnement Saas, les meilleures logiciels et ia Tu m 'accompagnes dans la mise Ã  jour de mon formulaire de gestion de mise jour de compte.
Je vais t expliquer dans le chat suivant
------------------
Nous avons travaillÃ© ensemble sur ce fichier 
-> src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6-Fichiers PrÃ©parÃ©s pour IntÃ©gration.md

Ce fichier comprend tous les fichiers que nous avions conÃ§u en vue de la prÃ©paration du paramÃ©trage de notre formulaire

Tout est codÃ© parfaitement

Nous n avions pas voulu les mettre en place dans l application avant d avoir tous les codes complets
Tous ces codes prÃ©paratoires etaient ou seront Ã  copier et Ã  appliquer selon les directives et les emplacemets prÃ©vus

Je vais t expliquer dans le chat suivant
-------------------

Nous allons ensemble passer Ã  l implentation de ces fichiers dans mon applicaton et des actions dans supabase
Nous avons finalisÃ© 5 Ã©tapes 

Lis le fichier : 
- src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6-Etapes d'IntÃ©gration.md
- il dÃ©crit les etapes Ã  suivre pour intÃ©grer les codes prÃ©paratoires dÃ©taillÃ©s dans
- src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6-Fichiers PrÃ©parÃ©s pour IntÃ©gration.md

RAPPEL DES EMPLACEMENTS
- Hook Principal : src/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/1.Reseau/hooks/useReseauFormData.ts
- Hook IntÃ©grations : src/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/1.Reseau/hooks/useReseauIntegrations.ts
- Types	types.ts : src/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/1.Reseau/hooks/types.ts
- Page Principale	: src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/3.FormReseauGestion.tsx
- Composant Selector : src/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/1.Reseau/components/ReseauSelector.tsx
- Edge Function Update : supabase/functions/update-reseau/index.ts
- Edge Function Upload : supabase/functions/upload-reseau-files/index.ts
- Migration Storage	migration-storage-buckets.sql	
 
Comme je te l'ai dit 
Nous avons finalisÃ© l'Ã©tape 5 
et j ai remarquÃ© un pbl
Je vais t expliquer dans le chat suivant
-------------------

Analyse le fichier
src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/3.FormReseauGestion.tsx

Je me sius rendu compte qu il n"Ã©tait pas dans sa conception
en phase avec nos hooks composent fonction  de 
src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6-Fichiers PrÃ©parÃ©s pour IntÃ©gration.md

Nous avons identifiÃ© ces pbls :

âŒ Hook IntÃ©grations manquant : useReseauIntegrations non utilisÃ©
âŒ Onglet IntÃ©grations non fonctionnel : Connecter au hook intÃ©grations
âŒ Edge Functions non utilisÃ©es : Utiliser update-reseau au lieu de sauvegarde directe
âŒ Upload Fichiers manquant : IntÃ©grer upload-reseau-files


Nous allons donc travailler ce matin Ã  corriger ce fichier
Mais on va travailler tranquillement et Ã©viter de faire des bugs 
pour nous permettre de travailler sereinement j ai fait un clone de ce fichier
ici
src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6=FormGestion.tsx

c est le meme code mais nous pourrons travaillons sans risque en cas d erreur
c est sur lui que nous allons travailler et tester les codes de correction
C est le meme code que src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/3.FormReseauGestion.tsx
il manque juste la fonction retour car nous ne sommes pas reliÃ© Ã  Accueil
Mais nous le ferons quand nous aurons trouvÃ© le code parfait et que nous pourrons corriger
de maniÃ¨re sure 3.FormReseauGestion.tsx

Est ce clair ?
Es tu prÃªt Ã  reprendre notre travail ?
Je vais t expliquer dans le chat suivant
-------------------


Directive pour correction du fichier clone : src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6=FormGestion.tsx

IMPORTANT :

Ne pas modifier le graphisme, les placeholders, ni le contenu rÃ©dactionnel des onglets et sections.



On part strictement de src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau/0.V6=FormGestion.tsx

âœ… Correctifs fonctionnels demandÃ©s
Ajouter et utiliser le hook intÃ©grations
Importer et appeler :
import { useReseauIntegrations } from '@/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/1.Reseau/hooks/useReseauIntegrations';
RÃ©cupÃ©rer les connexions disponibles et la mÃ©thode de sauvegarde :
const {
  brevoConnections,
  zohoConnections,
  openaiConnections,
  loadAllConnections,
  saveIntegrations,
} = useReseauIntegrations();

Charger les connexions dans le useEffect :
useEffect(() => {
  loadReseaux();
  loadAllConnections();
}, [loadReseaux, loadAllConnections]);

Brancher lâ€™onglet IntÃ©grations au hook
Remplacer la logique actuelle en dur par lâ€™appel rÃ©el au hook :
<Select
  value={formData.reseau_brevo_connexion_id || ''}
  onValueChange={(value) => updateFormField('reseau_brevo_connexion_id', value)}
  disabled={!isEditingIntegrations}
>
  <SelectTrigger>
    <SelectValue placeholder="SÃ©lectionner une connexion Brevo" />
  </SelectTrigger>
  <SelectContent>
    <SelectItem value="">Aucune connexion</SelectItem>
    {brevoConnections.map((connection) => (
      <SelectItem key={connection.id} value={connection.id}>
        {connection.nom} ({connection.email})
      </SelectItem>
    ))}
  </SelectContent>
</Select>

MÃªme logique pour Zoho et OpenAI, reliÃ©es Ã  leurs listes (zohoConnections, openaiConnections).
Sauvegarde via :
await saveIntegrations(selectedReseauId, {
  brevo: formData.reseau_brevo_connexion_id,
  zoho: formData.reseau_zoho_connexion_id,
  openai: formData.reseau_openai_connexion_id,
});

Utiliser lâ€™Edge Function pour sauvegarde des donnÃ©es gÃ©nÃ©rales
Dans handleSaveGeneral, remplacer lâ€™appel direct Ã  saveReseau par :
const payload = {
  reseauId: selectedReseauId,
  generalData: {
    reseau_nom: formData.reseau_nom,
    reseau_identite_commerciale: formData.reseau_identite_commerciale,
    reseau_adresse: formData.reseau_adresse,
    reseau_code_postal: formData.reseau_code_postal,
    reseau_ville: formData.reseau_ville,
    reseau_siret: formData.reseau_siret,
  }
};
const { data, error } = await supabase.functions.invoke('update-reseau', {
  body: JSON.stringify(payload)
});

Upload fichiers via Edge Function upload-reseau-files
ImplÃ©menter handleFileUpload :
const handleFileUpload = async (file: File, type: 'logo' | 'document') => {
  if (!selectedReseauId) return;

  try {
    const payload = {
      reseauId: selectedReseauId,
      type,
      filename: file.name,
    };

    const { data, error } = await supabase.functions.invoke('upload-reseau-files', {
      body: JSON.stringify(payload),
    });

    if (error) throw error;

    const { fileUrl } = data;

    if (type === 'logo') {
      updateFormField('reseau_logo', fileUrl);
    } else {
      const currentDocs = formData.reseau_documents || [];
      updateFormField('reseau_documents', [...currentDocs, fileUrl]);
    }

    toast({
      title: "SuccÃ¨s",
      description: `${type === 'logo' ? 'Logo' : 'Document'} tÃ©lÃ©chargÃ© avec succÃ¨s`,
    });
  } catch (error: any) {
    console.error('Erreur upload:', error);
    toast({
      title: "Erreur",
      description: "Impossible de tÃ©lÃ©charger le fichier",
      variant: "destructive",
    });
  }
};

ðŸ“Œ RÃ©sumÃ© Ã  Lovable

ðŸ‘‰ Ne touche pas au design, ni aux placeholders, ni aux textes.
ðŸ‘‰ Nous travaillons sur ce fichier comme s'il etait fonctionnel prÃªt Ã  Ãªtre utilisÃ© 
ðŸ‘‰ Applique uniquement ces 4 corrections techniques pour connecter le formulaire aux hooks et Edge Functions.
JE TE RAPPELLE INTERDIT DE MODIFIER TOUT ELEMENT DU GRAPHISME - TEXTE PREHOLDER CHAMPS ETC
INTERDICTON DE MODIFIER UN AUTRE FICHIER DE L APPLICATION SANS MON ACCORD
