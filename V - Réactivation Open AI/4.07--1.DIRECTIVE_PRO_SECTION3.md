# DIRECTIVES : Codage SECTION 2
---

# DIRECTIVE 1 : Contenu de la Mission
- Générer l'intégralitgé des codes des utilitaires prévus dans
- Codage.08.Plan_de_Codage_Phase1_par_Section.tx
  - en TypeScript strict,
  - en respectant à 100 % des process actuels en localstorage, noms, fonctions, actions,
  - en respectant la nomenclature imposées et les emplacements exacts.

---
# DIRECTIVE 2 : Fichiers à générer (Section 2)
- Tous les fichiers seront situés dans :
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/
- Fichiers attendus :
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape1.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape2.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape3.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape4.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/mapSupabaseToPrompt.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/mapPromptOutput.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/formatCurrency.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/sanitizeText.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/formatAddress.ts
  - src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/convertLocalToSupabase.ts

---
# DIRECTIVE 3 : Respecter impérativement le nomming et le maping de l application définis dans 
- /mnt/data/Codage.01.Connaissances_Impératives_Application_LocalStorage.zip
- /mnt/data/Codage.02.Audits.zip
  - Il est strictement interdit d'apporter des modifications, correctifs, changements aux process qui fonctionnent actuellement dans tous les process des étapes 1 à 5 qui fonctionnent parfaitement
  - La mission consiste exclusivement à adapter les codes, fonctions actuels en localstorge pour une migration parfaite en Supabase
  - Toute modifications des noms de champs, des fonctions, des graphismes est absolument interdite.
  - Il est impératif des respecter les noms actuels ex/ conservation des noms 'à vendre' ou 'à louer'
  - Toute modification est interdite

---
# DIRECTIVE 4 : Respecter impérativement les process définis dans les documents préparatoires
- Il est impératif et non négociable de lire, analyser et ensuite d'appliquer les directives prévues dans
  - /mnt/data/Codage.03.Stratégie.zip
  - /mnt/data/Codage.04.Table_Préparatoire.zip
  - /mnt/data/Codage.05.Bibles_de_Référence.zip
  - /mnt/data/Codage.06.Détails_Stratégie.zip
  - /mnt/data/Codage.07.Sections_Préparatoires_Codage.zip
  - Il est impératif de respecter les directives camelCase

---
# DIRECTIVE 5 : Conservation non négociable du nommage camelCase
- Tous les hooks, fonctions, et interactions Supabase créés lors de la migration
- DOIVENT impérativement :
  - Conserver la structure camelCase existante pour les champs métier (agencyName, propertyType, saleType, price, rentAmount, rentPeriodicity, keyElements, propertyDescription, financials, details, exclusivite, location, reference).
  - Utiliser snake_case uniquement pour les champs système Supabase (organisation_id, user_id,  etc.).
  - Cette directive s'apppliquera à chacune des creations de fichier
- Règles concernant le nommage des camelCase
  - Règle SQL - Création de table
    - Champs métier : "camelCase" (avec guillemets doubles)
    - Champs système : snake_case (sans guillemets)
  - Règle TypeScript - Hooks & Services
    - Utilisation directe du camelCase pour champs métier
    - Utilisation directe du snake_case pour champs système
    - AUCUNE fonction de conversion n'est nécessaire
  - Règle Triggers
    - Utiliser : NEW."camelCase" ou NEW.snake_case
    - Préférer les fonctions génériques réutilisables
    - Cette directive s'apppliquera à chacune des creations de fichier

---
# DIRECTIVE 6 : Structure multi tenant
- Nous suivons une structure multi tenant avec une structure de visibilité imposée.
  - **Pour les structures Réseaux**	
    - reseau : Accès espace ->	/accueil-leadgenai	reseau + reseau_direction (projets internes au réseau et à sa direction) | Voit les projets de -> (Par respect confidentialité : Ne voit pas les projets des agences du réseau)
    - reseau_direction : Accès espace ->	/accueil-leadgenai	reseau + reseau_direction (projets internes au réseau et à sa direction) | Voit les projets de -> (Par respect confidentialité : Ne voit pas les projets des agences du réseau)
    - reseau_agence : Accès espace ->		/accueil-leadgenai	| Voit les projets de -> reseau_agence + reseau_agence_responsable + reseau_agence_collaborateur
    - reseau_agence_responsable : Accès espace ->		/accueil-leadgenai	| Voit les projets de -> reseau_agence + reseau_agence_responsable + reseau_agence_collaborateur
    - reseau_agence_collaborateur : Accès espace ->		/accueil-leadgenai	| Voit les projets de -> Uniquement ses propres projets reseau_agence_collaborateur 
  - **Pour les structures Agences Indépendantes**
    - agence_independante : Accès espace ->		/accueil-leadgenai	| Voit les projets de -> agence_independante + agence_independante_responsable + agence_independante_collaborateur
    - agence_independante_responsable : Accès espace ->		/accueil-leadgenai	| Voit les projets de -> agence_independante + agence_independante_responsable + agence_independante_collaborateur
    - agence_independante_collaborateur : Accès espace ->		/accueil-leadgenai	| Voit les projets de -> Uniquement ses propres projets agence_independante_collaborateur
  - La visibilité hiérarchique et les accès utilisateurs sont gérés exclusivement via les RLS policies SQL, appliquées sur les tables principales. Les hooks front n’assurent que l’injection des identifiants organisationnels..

---
# 7. DIRECTIVE 7 : Structure de validation des étapes
- Pour rédiger les codes définitifs il est impératif et non négociable d'analyser et de réproduire à l"identique les process de validation définis dans
  - /mnt/data/Codage.01.Connaissances_Impératives_Application_LocalStorage.zip
    - 0--1.FICHIERS-SOURCES-APPLICATION-LEADGENAI.zip
  - /mnt/data/Codage.02.Audits.zip
    - 01.Etape1à5.zip
- Pour rédiger les codes définitifs il est impératif et non négociable d'appliquer les directives préparatoires
  - /mnt/data/Codage.03.Stratégie.zip
    - 00--0.StrategiePhase1
    - 00--2.Nomenclature
  - /mnt/data/Codage.04.Table_Préparatoire.zip
    - 01--0.Table_etapes1to5.md
    - 01--1.GestionStrategieMultiTenant.md
    - 01--2.FonctionTimer.md
    - 01--3.ExplicationdesChamps.md
  - /mnt/data/Codage.05.Bibles_de_Référence.zip
    - 02--0.BibleRéférences.md
    - 02--1.MenuGaucheNavLinks.md
  - /mnt/data/Codage.06.Détails_Stratégie.zip
    - 03--0.DétailStratégiePhase1.md
    - 03--1.TableauRecapElementsACréer.md
    - 04--0.Section4-Directives.md
    - 04--1.Section4-TableOpenAiKeys.md
    - 04--2.Section4-TableOpenAiLogs.md
  - /mnt/data/Codage.07.Sections_Préparatoires_Codage.zip
  - 05--0.DocPréparatoireCodagePhase1.md
  - 05--1.DocSection1Validée.md
  - 05--2.DocSection2Validée.md
  - 05--3.DocSection3Validée.md
  - 05--4.DocSection4Validée.md
  - 05--5.DocSection5Validée.md

---
# DIRECTIVE 8 :  Livrable attendu
- Un fichier Markdown unique nommé -> 08--2.CodesSection2.md
- Ce fichier contient tout les codes complets de la section 1 présentés dans cet ordre :
  - validateEtape1.ts
  - validateEtape2.ts
  - validateEtape3.ts
  - validateEtape4.ts
  - mapSupabaseToPrompt.ts
  - mapPromptOutput.ts
  - formatCurrency.ts
  - sanitizeText.ts
  - formatAddress.ts
  - convertLocalToSupabase.ts
- Chaque élément est présenté de la manière suivante
    - # N1 : Fonction (Utilitaire, Hook, Composant) - Nom de l'utilitaire
    - ## lien de l'Emplacement prévu
    - le code complet encapsulé
- Exemple
    - # N1 : Utilitaire : validateEtape1.ts
    - ## src/components/HOOKS-ANNONCES/01.HOOKS-ETAPE1TO5/03.Utilitaires/validateEtape1.ts
    - ```ts
      // code ici
---

