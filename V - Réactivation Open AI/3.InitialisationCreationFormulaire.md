
Bonjour 
Tu es un expert en Ia no code, intÃ©gration et dÃ©veloppement Lovable et Supabse.
Tu maitrises parfaitement les environnement Saas, les meilleures logiciels et ia 
Tu es un expert attentif, rigoureux, mÃ©ticuleux

- Ne pose pas de questions, pour l'instant sur ce que nous allons faire ensemble afin de ne pas t'Ã©garer
- En fin de message, prends l'habitude de ne pas reposer de nouvelle question, agis comme un expert rigoureux 
- Je veux d abord que tu lises les ressources que je vais de donner dans les prochains chats
- Il va y avoir plusieurs messages successifs
- Je souhaite que tu lises et analyses les fichiers dans l'ordre que je te donnerai pour ne pas mÃ©langer les informations
- ton travail sera de les lire attentivement.
- Attention. Les fichiers sont dans des zip, tu as mon accord pour les dÃ©compresser, les lire et les analyser
- Je n'ai pas besoin que tu fasses des synthÃ¨ses de ces docs, je les connais
- Je veux simplement que tu t'imprÃ©gnes de leur contenus
- C est pour ton apprentissage de connaissances
- Je veux compter sur toi comme un vrai expert Ã  mes cÃ´tÃ©s et j'ai besoin que tu maÃ®trises sur le bout des doigts mon environnement.
Es-tu pret Ã  lire et analyser la premiere source de documents ?
----

Parfait
- En 1er, je te demande de bien comprendre mon application et sa stratÃ©gie
  - Lis Tous les fichiers ZIP du dossier en ressources
  - /mnt/data/Documents-StratÃ©giques-LeadGenAI.AdBuilder.zip
  - Tu as mon accord pour dÃ©compresser le zip et commence immÃ©diatement la lecture et l'analyse des documents contenus
- Il y  dedans des ressources essentielles Ã  connaÃ®tre
  - ->01. PrÃ©sentation LeadGenAi.md
  - ->02. PrÃ©sentation Structure LeadGenAi.md
  - ->03. Logique Organisations.md
  - ->04. Relations Business entre Tables.md
  - ->05. Relations Users Utilisateurs.md
  - ->06. RÃ©fÃ©rence des Hooks StratÃ©giques.md
  - ->07.1. FormCreationReseau - Gestion Informations PartagÃ©es entre RÃ©seau et RÃ©seau Direction.md
  - ->07.2. FormGestionReseau - Gestion Informations PartagÃ©es entre RÃ©seau et RÃ©seau Direction.md
  - ->08. Gestion du Menu Gauche.md
  - ->09. Structure - Organisation | Client_id.md
  - ->10. Structure des Tables de Connexion & RÃ¨gles Collaborateurs.md
- Quand tu auras fini de lire je te donnerai une liste d autres ressources Ã  lire
---
Ensuite, je te demande dÃ©compresser ces zip et de lire et analyser les tables de mon application et de lire tous les fichiers : 
- /mnt/data/1.Tables.StratÃ©giques.zip
- /mnt/data/2.Tables.Clients.zip
- /mnt/data/3.Tables.Connexion.zip
- /mnt/data/4.Tables.Historique.zip
Quand tu auras fini de lire et d'analyser je te donnerai une liste d autres ressources Ã  lire
---
Maintenant, je te demande dÃ©compresser ces zip, lis et analyse tous nos HOOKS
- /mnt/data/v1.HOOK-useAuth.zip
- /mnt/data/2.HOOK-useCurrentUser.zip
- /mnt/data/3.HOOK-useMultiTenant.zip
- /mnt/data/v4.HOOK-useSupabaseOperations.zip

Ensuite, je te demande dÃ©compresser ces zip, lis le dossier :
- /mnt/data/2.INTEGRATION SUPABASE.zip
- Quand tu auras fini de lire et analyser , je te donnerai une liste d'autres ressources Ã  lire
---
Parfait 
- On a travaillÃ© sur un espace qui va me permettre en tant qu'administrateur admin_presenca de crÃ©er des tables et de les mettre Ã  jour
- Nous avons commencÃ© par un formulaire pour la table reseau
  - Ces formulaires se trouvent dans mon application dans le dossier : src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs
  - Les composants de ce formulaire reseau se trouvent dans ce dossier : src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/1.Reseau

## Ã‰tape 1 â€” Analyse prÃ©alable
- DÃ©compresse et analyse toutes les informations stratÃ©giques utilisÃ©es pour concevoir le formulaire reseau, avec ses 3 pages :
  - Accueil
  - CrÃ©ation
  - Gestion (avec ses onglets GÃ©nÃ©ral, IntÃ©grations, Fichiers)
  - 001.FormCreateurReseau.DossierCrucial.zip
  - 002.FormGestionReseau.DossierCrucial.zip
  - 003.FormCreateurGestion.DossierCrucial.zip
- Tu dois les maÃ®triser parfaitement car nous allons travailler sur la conception du formulaire de la table agence_independante
- Selon le mÃªme modÃ¨le structurel, logique et graphique
- Je te donnerai d'autres informations dans le chat suivant quand tu auras bien compris cette structure
---
## ğŸ§± Ã‰tape 2 â€” Conception du formulaire Agence IndÃ©pendante
### 1. Formulaire de **crÃ©ation**
- CrÃ©ation simultanÃ©e des tables :  
  `users`, `utilisateur`, `organisation`, `agence_independante`.
- Application du **mÃªme modÃ¨le que pour `reseau`** :
  - **Propagation automatique** vers `agence_independante_responsable` pour les champs `email` et `telephone`.
  - **Service Role Key** pour bypass RLS (mÃªme logique `verify_jwt=false` dans `config.toml`).
  - Gestion du mot de passe via composant `SuccessAccountInfo.tsx` (affichage du lien dâ€™accÃ¨s / magic link).
- Respect du **cascade process** :
  1. Organisation â†’  
  2. Agence â†’  
  3. User/Auth â†’  
  4. Utilisateur â†’  
  5. Responsable agence.
- Structure des EF :  
  `supabase/functions/create-agence-independante-admin/index.ts`

### 2. Formulaire de **gestion**
#### Structure gÃ©nÃ©rale
MÃªme architecture que `reseau`, mais avec **4 onglets** :
1. **GÃ©nÃ©ral**
2. **Abonnement**
3. **IntÃ©grations** (Brevo, Zoho, OpenAI, LinkedIn, Facebook, Instagram)
4. **Fichiers**
#### ğŸ”¹ Onglet GÃ©nÃ©ral
- Mise Ã  jour de la table `agence_independante`.
- Propagation automatique vers `agence_independante_responsable` pour `email` et `telephone`.
- Respect du pattern `{ success, data, message }`.
#### ğŸ”¹ Onglet Abonnement *(nouveautÃ© par rapport Ã  la table rÃ©seau)*
- Pour lâ€™instant, ne comporte que **2 champs en lecture seule** :
  - `Plan dâ€™abonnement` (affiche `abonnement_stripe_plan` ou â€œAucunâ€ si null),
  - `Date de dÃ©but dâ€™abonnement` (affiche `abonnement_stripe_debut` ou vide).
- Ces champs lisent la table `abonnement_stripe`.
- Aucun lien Stripe actif pour le moment.
- PrÃ©voir un **cadre extensible** permettant plus tard :
  - la sÃ©lection dâ€™un plan,
  - la crÃ©ation / mise Ã  jour dâ€™un abonnement via EF Stripe,
  - la synchronisation automatique des donnÃ©es (`last_synchro`, `statut`, `paiement`).
- Fichiers et hooks Ã  prÃ©voir :
  - `useAbonnementStripeView.ts` (lecture seule),
  - Dossier futur `/4.OngletAbonnement/` (structure prÃªte Ã  accueillir les EF Stripe).
#### ğŸ”¹ Onglet IntÃ©grations
- 6 intÃ©grations prÃ©vues : Brevo, Zoho, OpenAI, LinkedIn, Facebook, Instagram.
- MÃªmes EF et hooks que pour `reseau`, en adaptant les noms et tables.
- Gestion via `agence-independante-admin-update`.
#### ğŸ”¹ Onglet Fichiers
- TÃ©lÃ©versement / suppression via EF :
  `agence-independante-admin-fichiers`.
- Respect du **mapping normÃ©** :
  - `bucket-table-agence-independante/agence-{uuid}/1-logos/...`
  - `bucket-table-agence-independante/agence-{uuid}/2-documents-institutionnels/...`
- MAJ DB :
  - `_logo` â†’ chemin unique vers le logo principal,
  - `_ressources` â†’ tableau des chemins vers les documents.
#### âš™ï¸ Hooks et EF
- Hooks :  
  `useAgenceIndependanteFormData.ts`,  
  `useAgenceIndependanteIntegrations.ts`.
- EF :  
  - `gestion-agence-independante-admin/index.ts`  
  - `gestion-agence-independante-admin-donnees/index.ts`  
  - `gestion-agence-independante-admin-update/index.ts`  
  - `gestion-agence-independante-admin-fichiers/index.ts`
### 3. Respect de la structure graphique
- Il faudra impÃ©rativement conserver le graphisme existant
- Sauf nÃ©cesstiÃ© absolue, interdiction de modifier les noms des titres, champs preholder
### 4. Respect du nomming et du maping des tables
- Il faudra impÃ©rativement veiller Ã  respecter le nom des champs des tables
- Ils sont prÃ©sents tu n as pas Ã  crÃ©er de nouveaux champs pour toutes les tables : users, utilisateur, organisation ,agence independante et agence indepedante responsable et les tables de connexion
- Tu retrouvers toutes les tables dans les fichiers prÃ©paratoires
- .TablesReferenceAgenceIndependante.ts
- et dans le fichier ZIP qu'il faudra dÃ©compresser : Agence_Independante_UseTables.zip

## ğŸ—‚ï¸ Ã‰tape 3 â€” Emplacements des fichiers
### ğŸ“ Frontend
**CrÃ©ation :**  
`src/components/ADMIN-PRESENCA/9-CreationComptesUtilisateurs/1-Formulaires/6.AgenceIndependante/`  
Contient :
```
1.FormAgenceIndependanteAccueil.tsx
2.FormAgenceIndependanteCreation.tsx
3.FormAgenceIndependanteGestion.tsx
SuccessAccountInfo.tsx
```
**Hooks CrÃ©ation :**  
`src/components/HOOKS-STRATEGIQUE/5.HOOKS-CreationCompteAdminPresenca/6.AgenceIndependante`
**Hooks Gestion :**  
`src/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/6.AgenceIndependante/hooks`
**Composants Gestion :**  
`src/components/HOOKS-STRATEGIQUE/6.HOOKS-GestionCompteAdminPresenca/6.AgenceIndependante/components`

### ğŸ“ Backend (Edge Functions)
`supabase/functions/`  
- `create-agence-independante-admin/`  
- `gestion-agence-independante-admin/`  
- `gestion-agence-independante-admin-donnees/`  
- `gestion-agence-independante-admin-update/`  
- `gestion-agence-independante-admin-fichiers/`
Respecter le naming exact et la structure EF du modÃ¨le `reseau`.

## ğŸ§© Ã‰tape 4 â€” Bonnes pratiques gÃ©nÃ©rales
- **Service Role Key obligatoire** pour toutes les EF (jamais exposÃ©e cÃ´tÃ© front).  
- **Frontend** : clÃ© **ANON** uniquement.  
- **Contrats de retour uniformisÃ©s** `{ success, data, message }`.  
- **Logs structurÃ©s** (`requestId`, `duration_ms`, `event`).  
- **Charte graphique** : interdiction de modifier la mise en page (labels, placeholders, styles).  
- **AtomicitÃ©** : toutes les EF doivent rollback en cas dâ€™erreur partielle.  
- **RÃ©plication** `agence_independante` â†’ `agence_independante_responsable` obligatoire pour `email` et `telephone`.
---








